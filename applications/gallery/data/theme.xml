<?xml version="1.0" encoding="UTF-8"?>
<theme name="Default" author_name="Invision Power Services, Inc" author_url="https://www.invisioncommunity.com">
 <template template_group="browse" template_name="album" template_data="$album, $table, $commentsAndReviews" template_location="front" template_app="gallery"><![CDATA[
{{if $club = $album->category()->club()}}
	{{if settings.clubs and settings.clubs_header == 'full'}}
		{template="header" app="core" group="clubs" params="$club, $album->category()"}
	{{endif}}
	<div id='elClubContainer'>
{{endif}}

<div class="ipsPageHeader ipsClearfix ipsSpacer_bottom">
	<h1 class="ipsType_pageTitle ipsContained_container">
		{{if $album->asItem()->hidden() === 1}}
			<span><span class="ipsBadge ipsBadge_icon ipsBadge_warning" data-ipsTooltip title='{lang="pending_approval"}'><i class='fa fa-warning'></i></span></span>
		{{elseif $album->asItem()->hidden() === -1}}
			<span><span class="ipsBadge ipsBadge_icon ipsBadge_warning" data-ipsTooltip title='{$album->asItem()->hiddenBlurb()}'><i class='fa fa-eye-slash'></i></span></span>
		{{elseif $album->asItem()->hidden() === -2}}
			<span><span class="ipsBadge ipsBadge_icon ipsBadge_warning" data-ipsTooltip title='{$album->asItem()->deletedBlurb()}'><i class='fa fa-trash'></i></span></span>
		{{endif}}
		{{if $album->asItem()->mapped('featured')}}
			<span><span class="ipsBadge ipsBadge_icon ipsBadge_positive" data-ipsTooltip title='{lang="featured"}'><i class='fa fa-star'></i></span></span>
		{{endif}}
		{{if $album->asItem()->canEdit()}}
			<span class='ipsContained ipsType_break' data-controller="core.front.core.moderation">{{if $album->asItem()->locked()}}<i class='fa fa-lock'></i> {{endif}}
				<span data-role="editableTitle" title='{lang="click_hold_edit"}'>{$album->_title}</span>
			</span>
		{{else}}
			<span class='ipsContained ipsType_break'>{{if $album->asItem()->locked()}}<i class='fa fa-lock'></i> {{endif}}{$album->_title}</span>
		{{endif}}
	</h1>
	<div class='ipsPos_right ipsResponsive_noFloat ipsResponsive_hidePhone'>
		{{$followerCount = \IPS\gallery\Image::containerFollowerCount( $album );}}
		{template="follow" app="core" group="global" params="'gallery', 'album', $album->_id, $followerCount"}
	</div>
	<div class='ipsPos_right ipsResponsive_noFloat ipsResponsive_hidePhone'>
		{template="promote" app="core" group="global" params="$album"}
	</div>
</div>
<hr class='ipsHr ipsResponsive_hidePhone'>

<div class='ipsColumns ipsColumns_collapsePhone'>
	<div class='ipsColumn ipsColumn_wide'>
		<div class='ipsBox ipsPad'>
			{{if $album->coverPhoto('medium')}}
				<div class='ipsSpacer_bottom'>
					<img src='{$album->coverPhoto('medium')}' class='ipsImage' alt=''>
				</div>
			{{endif}}

			{{if $album->type === 2}}
				<span class="ipsBadge ipsBadge_warning">{lang="album_private_badge"}</span>
			{{elseif $album->type === 3}}
				<span class="ipsBadge ipsBadge_warning">{lang="album_friend_only_badge"}</span>
			{{endif}}

			<div class='ipsPhotoPanel ipsPhotoPanel_tiny ipsClearfix ipsSpacer_both'>
				{template="userPhoto" group="global" app="core" params="\IPS\Member::load( $album->owner_id ), 'tiny'"}
				<div>
					<strong class='ipsType_minorHeading'>{lang="album_created_by"}</strong><br>
					{expression="\IPS\Member::load( $album->owner_id )->name"}
				</div>
			</div>

			{{if $album->description}}
				<div class='ipsType_medium ipsType_richText ipsSpacer_top'>
					{$album->description|raw}
				</div>
			{{endif}}

			<ul class='ipsList_inline ipsType_medium ipsClear ipsSpacer_top'>
				<li><i class='fa fa-camera'></i> {lang="num_images" pluralize="$album->count_imgs"}</li>
				{{if $album->use_comments}}
					<li><i class='fa fa-comment'></i> {lang="num_comments" pluralize="$album->comments"}</li>
				{{endif}}
				{{if $album->allow_comments}}
					<li><i class='fa fa-comment'></i> {lang="gallery_image_comments_s" pluralize="$album->count_comments"}</li>
				{{endif}}
			</ul>

			{{if \IPS\IPS::classUsesTrait( $album->asItem(), 'IPS\Content\Reactable' ) and settings.reputation_enabled}}
				{template="reputation" app="core" group="global" params="$album->asItem()"}
			{{endif}}
			
			{{if $album->canDelete() || $album->asItem()->canEdit() || $album->asItem()->canOnMessage( 'add' ) || $album->asItem()->canFeature() || $album->asItem()->canUnfeature() || $album->asItem()->canHide() || $album->asItem()->canUnhide() || $album->asItem()->canMove() || $album->asItem()->canLock() || $album->asItem()->canUnlock() || $album->asItem()->canReport()}}
				<hr class='ipsHr'>
				{{if $album->canDelete() || $album->asItem()->canEdit() || $album->asItem()->canOnMessage( 'add' ) || $album->asItem()->canFeature() || $album->asItem()->canUnfeature() || $album->asItem()->canHide() || $album->asItem()->canUnhide() || $album->asItem()->canMove() || $album->asItem()->canLock() || $album->asItem()->canUnlock()}}
					<a href='#elAlbumActions_menu' id='elAlbumActions' class='ipsButton ipsButton_light ipsButton_verySmall ipsButton_fullWidth' data-ipsMenu>{lang="manage_album"} <i class='fa fa-caret-down'></i></a>
					<ul id='elAlbumActions_menu' class='ipsMenu ipsMenu_auto ipsHide'>
						{{if $album->asItem()->canEdit() }}
							<li class='ipsMenu_item'><a href='{$album->url()->setQueryString( array( 'do' => 'editAlbum', 'csrfKey' => \IPS\Session::i()->csrfKey ) )}' title="{lang="edit_album"}" data-ipsDialog data-ipsDialog-title="{lang="edit_album"}">{lang="edit_album"}</a></li>
						{{endif}}

						{{if $album->asItem()->canFeature()}}
							<li class='ipsMenu_item'><a href='{$album->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'feature' ) )}' title="{lang="feature_title_album"}">{lang="feature"}</a></li>
						{{endif}}
						{{if $album->asItem()->canUnfeature()}}				
							<li class='ipsMenu_item'><a href='{$album->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unfeature' ) )}' title="{lang="unfeature_title_album"}">{lang="unfeature"}</a></li>
						{{endif}}
						{{if $album->asItem()->canHide()}}				
							<li class='ipsMenu_item'><a href='{$album->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'hide' ) )}' title="{lang="hide_title_album"}" data-ipsDialog data-ipsDialog-title="{lang="hide"}">{lang="hide"}</a></li>
						{{endif}}
						{{if $album->asItem()->canUnhide()}}				
							<li class='ipsMenu_item'><a href='{$album->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unhide' ) )}' title="{{if $album->asItem()->hidden() === 1}}{lang="approve_title_album"}{{else}}{lang="unhide_title_album"}{{endif}}">{{if $album->asItem()->hidden() === 1}}{lang="approve"}{{else}}{lang="unhide"}{{endif}}</a></li>
						{{endif}}
						{{if $album->asItem()->canLock()}}				
							<li class='ipsMenu_item'><a href='{$album->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'lock' ) )}' title="{lang="lock_title_album"}">{lang="lock"}</a></li>
						{{endif}}
						{{if $album->asItem()->canUnlock()}}				
							<li class='ipsMenu_item'><a href='{$album->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unlock' ) )}' title="{lang="unlock_title_album"}">{lang="unlock"}</a></li>
						{{endif}}
						{{if $album->asItem()->canMove()}}				
							<li class='ipsMenu_item'><a href='{$album->url()->setQueryString( array( 'do' => 'move' ) )}' data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title="{lang="move"}"  title="{lang="galleryalbum_move_title"}">{lang="move"}</a></li>
						{{endif}}

						{{if $album->canDelete() }}
							<li class='ipsMenu_item'><a href='{$album->url()->setQueryString( array( 'do' => 'deleteAlbum', 'csrfKey' => \IPS\Session::i()->csrfKey ) )}' data-ipsDialog data-ipsDialog-title="{lang="delete_album"}" title="{lang="delete_album"}">{lang="delete_album"}</a></li>
						{{endif}}

						{{if $album->asItem()->canOnMessage( 'add' )}}
							<li class='ipsMenu_item'><a href='{$album->url()->csrf()->setQueryString( array( 'do' => 'messageForm' ) )}' data-ipsDialog data-ipsDialog-title='{lang="add_message"}'>{lang="add_message"}</a></li>
						{{endif}}
					</ul>
				{{endif}}

				{{if $album->asItem()->canReport()}}
					&nbsp;&nbsp;<a href='{$album->url()->setQueryString('do', 'report')}' data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title="{lang="report_album"}" data-ipsDialog-remoteSubmit data-ipsDialog-flashMessage="{lang="report_submit_success"}" title="{lang="report_album"}">{lang="report_album"}</a>
				{{endif}}
			{{endif}}

			{{if count( $album->_event )}}
				<hr class='ipsHr'>
				<div class='ipsSpacer_top cGalleryEvents'>
					<h2 class='ipsType_sectionHead'>{lang="events_in_album" pluralize="count( $album->_event )"}</h2>
					{template="eventBlocks" group="view" app="calendar" params="$album->_event"}
				</div>
			{{endif}}
		</div>
	</div>
	<div class='ipsColumn ipsColumn_fluid'>
		{template="contentItemMessages" group="global" app="core" params="$album->asItem()->getMessages(), $album->asItem()"}
		{{if $album->can('add')}}
			<ul class="ipsToolList ipsToolList_horizontal ipsClearfix ipsSpacer_bottom ipsResponsive_hidePhone">
				{template="categoryButtons" group="browse" params="$album->can('add'), $album->category(), $album"}
			</ul>
		{{endif}}
		<div class='ipsBox'>
			{$table|raw}
		</div>
		
		{{if $album->asItem()->shareLinks()}}
			<div class="ipsSpacer_top ipsSpacer_bottom">
				{template="sharelinks" app="core" group="global" params="$album->asItem()"}
			</div>
		{{endif}}

		{{if $commentsAndReviews}}
			{{if ( $album->asItem()->use_reviews && $album->asItem()->container()->allow_reviews ) && ( $album->asItem()->use_comments && $album->asItem()->container()->allow_comments ) }}
				<a id="replies"></a>
				<h2 class='ipsHide'>{lang="user_feedback"}</h2>
			{{endif}}
			{$commentsAndReviews|raw}
		{{endif}}
	</div>
	{{if $album->can('add')}}
		<ul class="ipsToolList ipsToolList_horizontal ipsClearfix ipsResponsive_showPhone ipsResponsive_block">
			{template="categoryButtons" group="browse" params="$album->can('add'), $album->category(), $album"}
		</ul>
	{{endif}}
	<div class='ipsResponsive_showPhone ipsResponsive_block ipsSpacer_top'>
		{template="follow" app="core" group="global" params="'gallery', 'album', $album->_id, $followerCount"}
	</div>
	<div class='ipsResponsive_showPhone ipsResponsive_block ipsSpacer_top'>
		{template="promote" app="core" group="global" params="$album"}
	</div>
</div>

{{if $album->category()->club()}}
	</div>
{{endif}}
]]></template>
 <template template_group="browse" template_name="albumComments" template_data="$album" template_location="front" template_app="gallery"><![CDATA[<div class='ipsBox ipsSpacer_top'>
	<div class='' data-controller='core.front.core.commentFeed, core.front.core.ignoredComments' {{if settings.auto_polling_enabled}}data-autoPoll{{endif}} data-baseURL='{$album->url()}' {{if $album->isLastPage()}}data-lastPage{{endif}} data-feedID='image-{$album->id}' id='comments'>
		<div class='ipsPad'>
			<h2 class='ipsType_sectionHead ipsSpacer_bottom' data-role="comment_count">{lang="num_comments_uc" pluralize="$album->comments"}</h2>
			{{if $album->commentPageCount() > 1}}
				{$album->commentPagination( array('tab') )|raw}
				<br><br>
			{{endif}}

			<div data-role='commentFeed' data-controller='core.front.core.moderation'>
				{{if count( $album->comments( NULL, NULL, 'date', 'asc', NULL, NULL, NULL, NULL, FALSE, isset( \IPS\Request::i()->showDeleted ) ) )}}
					<form action="{$album->url()->csrf()->setQueryString( 'do', 'multimodComment' )}" method="post" data-ipsPageAction data-role='moderationTools'>
						{{$commentCount=0; $timeLastRead = $album->timeLastRead(); $lined = FALSE;}}
						{{foreach $album->comments( NULL, NULL, 'date', 'asc', NULL, NULL, NULL, NULL, FALSE, isset( \IPS\Request::i()->showDeleted ) ) as $comment}}
							{{if !$lined and $timeLastRead and $timeLastRead->getTimestamp() < $comment->mapped('date')}}
								{{if $lined = TRUE and $commentCount}}
									<hr class="ipsCommentUnreadSeperator">
								{{endif}}
							{{endif}}
							{{$commentCount++;}}
							{$comment->html()|raw}
						{{endforeach}}
						{template="commentMultimod" app="core" group="global" params="$album"}
					</form>
				{{else}}
					<p class='ipsType_normal ipsType_light ipsType_reset' data-role='noComments'>{lang="no_comments"}</p>
				{{endif}}
			</div>			
			{{if $album->commentPageCount() > 1}}
				<hr class='ipsHr'>
				{$album->commentPagination( array('tab') )|raw}
			{{endif}}

			{{if $album->commentForm() || $album->locked() || \IPS\Member::loggedIn()->restrict_post || \IPS\Member::loggedIn()->members_bitoptions['unacknowledged_warnings']}}
			<a id='replyForm'></a>
			<div data-role='replyArea' class='ipsAreaBackground ipsPad {{if !$album->canComment()}}cTopicPostArea_noSize{{endif}} ipsSpacer_top'>
				{{if $album->commentForm()}}
					{{if $album->locked()}}
						<p class='ipsType_reset ipsType_warning ipsComposeArea_warning ipsSpacer_bottom ipsSpacer_half'><i class='fa fa-info-circle'></i> {lang="album_locked_can_comment"}</p>
					{{endif}}
						{$album->commentForm()|raw}
				{{else}}
					{{if $album->locked()}}
						{template="commentUnavailable" group="forms" location="front" app="core" params="'album_locked_cannot_comment'"}
					{{elseif \IPS\Member::loggedIn()->restrict_post}}
						{template="commentUnavailable" group="forms" location="front" app="core" params="'restricted_cannot_comment', \IPS\Member::loggedIn()->warnings(5,NULL,'rpa'), \IPS\Member::loggedIn()->restrict_post"}
					{{elseif \IPS\Member::loggedIn()->members_bitoptions['unacknowledged_warnings']}}
						{template="commentUnavailable" group="forms" location="front" app="core" params="'unacknowledged_warning_cannot_post', \IPS\Member::loggedIn()->warnings( 1, FALSE )"}
					{{endif}}
				{{endif}}
			</div>
			{{endif}}
		</div>
	</div>
</div>
]]></template>
 <template template_group="browse" template_name="albumReviews" template_data="$album" template_location="front" template_app="gallery"><![CDATA[<div data-controller='core.front.core.commentFeed' {{if settings.auto_polling_enabled}}data-autoPoll{{endif}} data-commentsType='reviews' data-baseURL='{$album->url()}' {{if $album->isLastPage('reviews')}}data-lastPage{{endif}} data-feedID='image-{$album->id}-reviews' id='reviews'>
	{{if $album->reviewForm()}}
		<div id='elImageReviewForm'>
			{$album->reviewForm()|raw}
		</div>
	{{else}}
		{{if $album->hasReviewed()}}
			<!-- Already reviewed -->
		{{elseif \IPS\Member::loggedin()->restrict_post}}
			{{if \IPS\Member::loggedIn()->restrict_post == -1}}
				{template="reviewUnavailable" group="forms" location="front" app="core" params="'restricted_cannot_comment'"}
			{{else}}
				{template="reviewUnavailable" group="forms" location="front" app="core" params="'restricted_cannot_comment', \IPS\Member::loggedIn()->warnings(5,NULL,'rpa'), \IPS\Member::loggedIn()->restrict_post"}
			{{endif}}
		{{elseif \IPS\Member::loggedIn()->members_bitoptions['unacknowledged_warnings']}}
			{template="reviewUnavailable" group="forms" location="front" app="core" params="'unacknowledged_warning_cannot_post', \IPS\Member::loggedIn()->warnings( 1, FALSE )"}
		{{endif}}
	{{endif}}
	{{if count( $album->reviews( NULL, NULL, NULL, 'desc', NULL, NULL, NULL, NULL, isset( \IPS\Request::i()->showDeleted ) ) )}}
		{{if !$album->hasReviewed()}}<hr class='ipsHr'>{{endif}}
		<div class="ipsClearfix ipsSpacer_bottom">
			{{if $album->reviewPageCount() > 1}}
				<div class="ipsPos_left ipsResponsive_noFloat">
					{$album->reviewPagination( array( 'tab', 'sort' ) )|raw}
				</div>
			{{endif}}
			<div class="ipsClearfix ipsPos_right ipsResponsive_hidePhone">
				<ul class="ipsButtonRow ipsClearfix">
					<li data-action="tableFilter">
						<a href="{$album->url()->setQueryString( array( 'tab' => 'reviews', 'page' => 1, 'sort' => 'helpful' ) )}" class="{{if !isset( request.sort ) or request.sort != 'newest'}}ipsButtonRow_active{{endif}}" data-action="filterClick">{lang="most_helpful"}</a>
					</li>
					<li data-action="tableFilter">
						<a href="{$album->url()->setQueryString( array( 'tab' => 'reviews', 'page' => 1, 'sort' => 'newest' ) )}" class="{{if isset( request.sort ) and request.sort == 'newest'}}ipsButtonRow_active{{endif}}" data-action="filterClick">{lang="newest"}</a>
					</li>
				</ul>
			</div>
		</div>

		<div data-role='commentFeed' data-controller='core.front.core.moderation'>
			<form action="{$album->url()->csrf()->setQueryString( 'do', 'multimodReview' )}" method="post" data-ipsPageAction data-role='moderationTools'>
				{{$reviewCount=0; $timeLastRead = $album->timeLastRead(); $lined = FALSE;}}
				{{foreach $album->reviews( NULL, NULL, NULL, 'desc', NULL, NULL, NULL, NULL, isset( \IPS\Request::i()->showDeleted ) ) as $review}}
					{{if !$lined and $timeLastRead and $timeLastRead->getTimestamp() < $review->mapped('date')}}
						{{if $lined = TRUE and $reviewCount}}
							<hr class="ipsCommentUnreadSeperator">
						{{endif}}
					{{endif}}
					{{$reviewCount++;}}
					{$review->html()|raw}
				{{endforeach}}
				{template="commentMultimod" app="core" group="global" params="$album, 'review'"}
			</form>
		</div>
		{{if $album->reviewPageCount() > 1}}
			<div>
				{$album->reviewPagination( array( 'tab', 'sort' ) )|raw}
			</div>
		{{endif}}
	{{elseif !$album->canReview()}}
		<p class="ipsType_normal ipsType_light ipsType_reset" data-role="noReviews">{lang="no_reviews"}</p>
	{{endif}}
</div>]]></template>
 <template template_group="browse" template_name="albums" template_data="$table, $headers, $albums" template_location="front" template_app="gallery"><![CDATA[{{foreach $albums as $album}}
	{{if $album instanceof \IPS\Content\Item}}
		{{$album = $album->asNode();}}
	{{endif}}
	<li class='ipsDataItem ipsAreaBackground_reset{{if $album->asItem()->hidden()}} ipsModerated{{endif}}'>
		<div class='ipsColumns ipsColumns_collapsePhone'>
			<div class='ipsColumn ipsColumn_wide'>
				<div class='ipsPad'>
					<h3 class='ipsType_sectionHead ipsContained_container'>
						{{if \IPS\gallery\Image::containerUnread( $album )}}
							<span><span class="ipsItemStatus" data-ipsTooltip title="{lang="album_new_content"}"><i class="fa fa-circle"></i></span></span>
						{{endif}}
						{{if $album->asItem()->mapped('featured')}}
							<span><span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive" data-ipsTooltip title='{lang="featured"}'><i class='fa fa-star'></i></span></span>
						{{endif}}
						{{if \IPS\gallery\Image::containerUnread( $album )}}<strong>{{endif}}
							<span class='ipsContained ipsType_break'><a href='{$album->url()}' title='{lang="view_this_album" sprintf="$album->_title"}'>{$album->_title}</a></span>
						{{if \IPS\gallery\Image::containerUnread( $album )}}</strong>{{endif}}
					</h3>
					{{if $album->last_img_date}}<p class='ipsType_light ipsType_medium ipsType_reset'>{lang="updated"} {datetime="$album->last_img_date"}</p>{{endif}}

					{{if $album->type === 2}}
						<div class='ipsSpacer_top ipsSpacer_bottom ipsSpacer_half'><span class="ipsBadge ipsBadge_warning">{lang="album_private_badge"}</span></div>
					{{elseif $album->type === 3}}
						<div class='ipsSpacer_top ipsSpacer_bottom ipsSpacer_half'><span class="ipsBadge ipsBadge_warning">{lang="album_friend_only_badge"}</span></div>
					{{endif}}

					<ul class='ipsList_inline ipsType_small'>
						<li><i class='fa fa-camera'></i> {lang="num_images" pluralize="$album->count_imgs"}</li>
						{{if $album->use_comments}}
							<li><i class='fa fa-comment'></i> {lang="num_comments" pluralize="$album->comments"}</li>
						{{endif}}
						{{if $album->allow_comments}}
							<li><i class='fa fa-comment'></i> {lang="gallery_image_comments_s" pluralize="$album->count_comments"}</li>
						{{endif}}
					</ul>
					<div class='ipsType_medium ipsType_richText ipsSpacer_both ipsContained' data-ipsTruncate data-ipsTruncate-size='3 lines' data-ipsTruncate-type='remove'>
						{$album->truncated()|raw}
					</div>
					{{if !isset( \IPS\Request::i()->tab ) || \IPS\Request::i()->tab !== 'node_gallery_gallery'}}
						<div class='ipsPhotoPanel ipsPhotoPanel_tiny'>
							{template="userPhoto" group="global" app="core" params="$album->owner(), 'tiny'"}
							<div>
								<span class='ipsType_minorHeading'>{lang="album_created_by"}</span><br>
								<span class='ipsType_normal'>{$album->owner()->link()|raw}</span>
							</div>
						</div>
					{{endif}}
				</div>
			</div>
			<div class='ipsColumn ipsColumn_fluid'>
				{{if $table->canModerate()}}
					<div class='ipsPos_right ipsPad'>
						<input type='checkbox' data-role='moderation' name="moderate[{$album->_id}]" data-actions="{expression="implode( ' ', $table->multimodActions( $album ) )"}" data-state=''>
					</div>
				{{endif}}
				<div class='ipsPad cGalleryAlbums_recent'>
					<ul class='ipsList_reset'>
						<li {{if $album->coverPhoto( 'medium' )}}style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), $album->coverPhoto( 'medium' ) )"}" );'{{endif}} class='cGalleryTrimmedImage'>
							<a href='{$album->url()}' title='{lang="view_this_album" sprintf="$album->_title"}'>
								{{if $album->coverPhoto( 'medium' )}}
									<img src='{$album->coverPhoto( 'small' )}' alt='{$album->_title}'>
								{{endif}}
							</a>
						</li>
						{{foreach $album->_latestImages as $image }}
							<li style='background-image: url( "{file="$image->thumb_file_name" extension="gallery_Images"}" );' class='cGalleryTrimmedImage'>
								<a href='{$image->url()}'>
									<img src='{file="$image->thumb_file_name" extension="gallery_Images"}' alt="{$image->caption}">
									{{if ( $image->directContainer()->allow_comments && $image->container()->allow_comments )}}
										<span class='cGalleryAlbums_comments'><i class='fa fa-comment'></i> {expression="count( $image->comments() )"}</span>
									{{endif}}
								</a>
							</li>
						{{endforeach}}
					</ul>	
				</div>			
			</div>
		</div>
	</li>
{{endforeach}}]]></template>
 <template template_group="browse" template_name="categories" template_data="" template_location="front" template_app="gallery"><![CDATA[{{if !\IPS\Request::i()->isAjax()}}
	<div class="ipsPageHeader ipsPad_half ipsClearfix ipsSpacer_bottom" data-ipsSticky data-ipsSticky-disableIn='phone'>
		<h1 class="ipsType_pageTitle">{lang="gallery_title"}</h1>
	</div>
{{endif}}
<ol class="ipsDataList">
	{template="categoryRow" group="browse" params="NULL, NULL, \IPS\gallery\Category::roots()"}
</ol>]]></template>
 <template template_group="browse" template_name="categoriesSidebar" template_data="$currentCategory=NULL" template_location="front" template_app="gallery"><![CDATA[{{$categories = $currentCategory ? $currentCategory->children() : \IPS\gallery\Category::roots();}}
{{if count($categories)}}
<div id='elGalleryCategories' class='ipsSpacer_top'>
	<h3 class='ipsType_reset ipsType_sectionTitle'>{{if $currentCategory}}{lang="subcategories"}{{else}}{lang="categories"}{{endif}}</h3>
	<div class='ipsSideMenu ipsPad_half'>
		<ul class='ipsSideMenu_list'>
			{{foreach $categories as $category}}
				<li>
					<a href="{$category->url()}" class='ipsSideMenu_item ipsTruncate ipsTruncate_line'><span class='ipsBadge ipsBadge_style1 ipsPos_right cGalleryCategoryCount'>{expression="\IPS\gallery\Image::contentCount( $category )"}</span><strong class='ipsType_normal'>{$category->_title}</strong></a>
					{{if $category->hasChildren()}}
						<ul class="ipsSideMenu_list">
							{{foreach $category->children() as $idx => $subcategory}}
								<li>
									{{if $idx >= 5}}
										<a href='{$category->url()}' class='ipsSideMenu_item'><span class='ipsType_light ipsType_small'>{lang="and_x_more" pluralize="count( $category->children() ) - 5"}</span></a>
										{{break;}}
									{{else}}
										<a href="{$subcategory->url()}" class='ipsSideMenu_item ipsTruncate ipsTruncate_line'><strong class='ipsPos_right ipsType_small cGalleryCategoryCount'>{expression="\IPS\gallery\Image::contentCount( $subcategory )"}</strong>{$subcategory->_title}</a>
									{{endif}}
								</li>
							{{endforeach}}
						</ul>
					{{endif}}
				</li>
			{{endforeach}}
		</ul>
		<a href='{url="app=gallery&module=gallery&controller=browse&do=categories" seoTemplate="gallery_categories"}' class='ipsButton ipsButton_fullWidth ipsButton_small ipsButton_light'>{lang="browse_categories"} &nbsp;<i class='fa fa-caret-right'></i></a>
	</div>
</div>
{{endif}}]]></template>
 <template template_group="browse" template_name="category" template_data="$category, $albums, $table" template_location="front" template_app="gallery"><![CDATA[
{{if $club = $category->club()}}
	{{if settings.clubs and settings.clubs_header == 'full'}}
		{template="header" app="core" group="clubs" params="$club, $category"}
	{{endif}}
	<div id='elClubContainer'>
{{endif}}

<div class="ipsPageHeader ipsClearfix ipsSpacer_bottom">
	<h1 class="ipsType_pageTitle">{$category->_title}</h1>
	<div class='ipsPos_right ipsResponsive_noFloat ipsResponsive_hidePhone'>
		{{$followerCount = \IPS\gallery\Image::containerFollowerCount( $category );}}
		{template="follow" app="core" group="global" params="'gallery', 'category', $category->_id, $followerCount"}
	</div>
</div>

{{if $category->show_rules == 1}}
	<hr class='ipsHr'>
	<a href="{$category->rules_link}" class='ipsJS_show ipsType_normal' data-ipsDialog data-ipsDialog-title="{lang="gallery_category_{$category->id}_rulestitle"}" data-ipsDialog-content="#elCategoryRules">{lang="category_rules"}</a>
	<div id='elCategoryRules' class='ipsHide ipsPad ipsType_richText ipsType_medium ipsSpacer_both'>{lang="gallery_category_{$category->id}_rules"}</div>
{{elseif $category->show_rules == 2}}
	<hr class='ipsHr'>
	<strong class='ipsType_normal'>{lang="gallery_category_{$category->id}_rulestitle"}</strong>
	<div class='ipsType_richText ipsType_medium ipsSpacer_both'>{lang="gallery_category_{$category->id}_rules"}</div>
{{endif}}
{{if $category->description}}
	<div class='ipsType_richText ipsType_medium ipsSpacer_both'>
		{$category->description|raw}
	</div>
{{endif}}

{{if $category->can('add')}}
	<ul class="ipsToolList ipsToolList_horizontal ipsClearfix ipsSpacer_bottom ipsResponsive_hidePhone">
		{template="categoryButtons" group="browse" params="$category->can('add'), $category, NULL"}
	</ul>
{{endif}}


{{if $category->children()}}
	<div class="ipsAreaBackground_light ipsPad ipsSpacer_bottom">
		{template="categoryGrid" group="browse" app="gallery" params="$category->children()"}
	</div>
{{endif}}

{{if $albums}}
	<div class='ipsBox ipsSpacer_bottom'>
		{$albums|raw}
	</div>
{{endif}}

{{if $table}}
	<div class='ipsBox'>
		{$table|raw}
	</div>
{{endif}}

{{if \IPS\gallery\Category::canOnAny('add')}}
	<ul class="ipsToolList ipsToolList_horizontal ipsResponsive_hideDesktop ipsResponsive_block ipsClearfix ipsSpacer_top">
		{template="categoryButtons" group="browse" params="\IPS\gallery\Category::canOnAny('add'), $category"}
	</ul>
{{endif}}

<div class='ipsResponsive_showPhone ipsResponsive_block'>
	{template="follow" app="core" group="global" params="'gallery', 'category', $category->_id, $followerCount"}
</div>

{{if $category->club()}}
	</div>
{{endif}}]]></template>
 <template template_group="browse" template_name="categoryButtons" template_data="$canSubmitImages, $currentCategory=NULL, $currentAlbum=NULL" template_location="front" template_app="gallery"><![CDATA[<li class='ipsToolList_primaryAction'>
	<a class="ipsButton ipsButton_medium ipsButton_important ipsButton_fullWidth" data-ipsDialog data-ipsDialog-fixed data-ipsDialog-size='fullscreen' data-ipsDialog-remoteSubmit='true' {{if $currentAlbum}}href="{url="app=gallery&module=gallery&controller=submit&category={$currentCategory->id}&album={$currentAlbum->id}&_new=1" seoTemplate="gallery_submit"}" {{elseif $currentCategory}} href="{url="app=gallery&module=gallery&controller=submit&category={$currentCategory->id}&_new=1" seoTemplate="gallery_submit"}" {{else}} href="{url="app=gallery&module=gallery&controller=submit&_new=1" seoTemplate="gallery_submit"}" {{endif}}>{lang="add_gallery_image"}</a>
</li>]]></template>
 <template template_group="browse" template_name="categoryGrid" template_data="$categories" template_location="front" template_app="gallery"><![CDATA[
{{if count( $categories )}}
	<div class='cGalleryCats ipsClear ipsClearfix'>
		<ul class='ipsGrid' data-ipsGrid data-ipsGrid-minItemSize='250' data-ipsGrid-maxItemSize='500'>
		{{foreach $categories as $category}}
			<li class='ipsGrid_span4 cGalleryCat'>
				<a href='{$category->url()}' style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), $category->coverPhoto('medium') )"}" );' class='cGalleryTrimmedImage' data-grid-ratio='40'>
					<h2 class='ipsType_sectionHead ipsTruncate ipsTruncate_line'>{$category->_title}</h2>
					<img src='{$category->coverPhoto('medium')}' alt='{$category->_title}'>
					<ul class='ipsList_inline ipsType_left cGalleryCat_info'>
						<li>{{if $category->lastImage() !== NULL}}<i class='fa fa-clock-o'></i> {datetime="$category->lastImage()->date"}{{endif}}</li>
						{{if $category->allow_comments}}
							<li class='ipsPos_right' data-ipsTooltip title='{lang="cat_comment_count" pluralize="$category->_comments"}'><i class='fa fa-comment'></i> {$category->_comments}</li>
						{{endif}}
						{{if $category->allow_albums}}
							<li class='ipsPos_right' data-ipsTooltip title='{lang="cat_album_count" pluralize="$category->public_albums"}'><i class='fa fa-th-large'></i> {$category->public_albums}</li>
						{{endif}}
						<li class='ipsPos_right' data-ipsTooltip title='{lang="cat_img_count" pluralize="\IPS\gallery\Image::contentCount( $category )"}'><i class='fa fa-camera'></i> {expression="\IPS\gallery\Image::contentCount( $category )"}</li>
					</ul>
				</a>
			</li>
		{{endforeach}}
		</ul>
	</div>
{{endif}}]]></template>
 <template template_group="browse" template_name="categoryRow" template_data="$table, $headers, $categories" template_location="front" template_app="gallery"><![CDATA[{{foreach $categories as $category}}
	{{if $category->can('view')}}
	<li class="ipsDataItem ipsDataItem_responsivePhoto ipsClearfix">
		<div class='ipsDataItem_generic ipsDataItem_size3'>
			{template="thumbImage" group="global" app="core" params="$category->coverPhoto( 'small' ), $category->_title, 'medium', '', 'view_this', $category->url(), 'gallery_Images'"}
		</div>
		<div class="ipsDataItem_main">
			<h4 class="ipsDataItem_title">
				<!-- @todo: change unread indicator to stand out more and to be more consistent...maybe adjusting the category icon? -->
				{{if \IPS\gallery\Image::containerUnread( $category )}}UNREAD{{endif}}
				<a href="{$category->url()}">{$category->_title}</a>
			</h4>
			<p class="ipsDataItem_meta">{$category->description|raw}</p>
			{{if $category->hasChildren()}}
				<ul class="ipsDataItem_subList ipsList_inline">
					{{foreach $category->children() as $subcategory}}
						<li class="{{if \IPS\gallery\Image::containerUnread( $subcategory )}}ipsDataItem_unread{{endif}}">
							<a href="{$subcategory->url()}">{$subcategory->_title}</a>
						</li>
					{{endforeach}}
				</ul>
			{{endif}}
		</div>
		<dl class="ipsDataItem_stats ipsDataItem_statsLarge">
			{{$count = \IPS\gallery\Image::contentCount( $category );}}
			<dt class="ipsDataItem_stats_number">{number="$count"}</dt>
			<dd class="ipsDataItem_stats_type ipsType_light">{lang="images_no_number" pluralize="$count"}</dd>
		</dl>
		<ul class="ipsDataItem_lastPoster ipsDataItem_withPhoto">
			{{if $lastPost = $category->lastImage()}}
				<li>{template="userPhoto" app="core" group="global" params="$lastPost->author(), 'tiny'"}</li>
				<li><a href="{$lastPost->url()}" class='ipsType_break ipsContained'>{$lastPost->caption}</a></li>
				<li>{lang="byline_nodate" htmlsprintf="$lastPost->author()->link()"}</li>
				<li data-short="1 dy" class="ipsType_light">{datetime="$lastPost->date"}</li>
			{{endif}}
		</ul>
		{{if $table AND $table->canModerate()}}
			<div class='ipsDataItem_modCheck'>
				<span class='ipsCustomInput'>
					<input type='checkbox' data-role='moderation' name="moderate[{$category->_id}]" data-actions="{expression="implode( ' ', $table->multimodActions( $category ) )"}" data-state=''>
					<span></span>
				</span>
			</div>
		{{endif}}
	</li>
	{{endif}}
{{endforeach}}]]></template>
 <template template_group="browse" template_name="imageTable" template_data="$table, $headers, $rows, $quickSearch" template_location="front" template_app="gallery"><![CDATA[<div data-baseurl='{$table->baseUrl}' data-resort='{$table->resortKey}' data-controller='core.global.core.table{{if $table->canModerate()}},core.front.core.moderation{{endif}}'>
	{{if \IPS\Request::i()->app == 'gallery'}}<h2 class='ipsType_sectionTitle ipsType_reset ipsClear ipsType_medium ipsHide'>{lang="num_images" pluralize="$table->count"}</h2>{{endif}}
	{{if $table->canModerate() OR ( $table->showAdvancedSearch AND ( (isset( $table->sortOptions ) and !empty( $table->sortOptions )) OR $table->advancedSearch ) ) OR !empty( $table->filters ) OR $table->pages > 1}}
		<div class="ipsButtonBar ipsPad_half ipsClearfix ipsClear">
			{{if $table->canModerate()}}
				<ul class="ipsButtonRow ipsPos_right ipsClearfix">
					<li>
						<a class="ipsJS_show" href="#elCheck_menu" id="elCheck_{$table->uniqueId}" title='{lang="{$table->langPrefix}select_rows_tooltip"}' data-ipsTooltip data-ipsAutoCheck data-ipsAutoCheck-context="#elTable_{$table->uniqueId}" data-ipsMenu data-ipsMenu-activeClass="ipsButtonRow_active">
							<span class="cAutoCheckIcon ipsType_medium"><i class="fa fa-square-o"></i></span> <i class="fa fa-caret-down"></i>
							<span class='ipsNotificationCount' data-role='autoCheckCount'>0</span>
						</a>
						<ul class="ipsMenu ipsMenu_auto ipsMenu_withStem ipsHide" id="elCheck_{$table->uniqueId}_menu">
							<li class="ipsMenu_title">{lang="{$table->langPrefix}select_rows"}</li>
							<li class="ipsMenu_item" data-ipsMenuValue="all"><a href="#">{lang="all"}</a></li>
							<li class="ipsMenu_item" data-ipsMenuValue="none"><a href="#">{lang="none"}</a></li>
							{{if count($table->getFilters())}}
								<li class="ipsMenu_sep"><hr></li>
								{{foreach $table->getFilters() as $filter}}
									<li class="ipsMenu_item" data-ipsMenuValue="{$filter}"><a href="#">{lang="$filter"}</a></li>
								{{endforeach}}
							{{endif}}
						</ul>
					</li>
				</ul>
			{{endif}}

			<ul class="ipsButtonRow ipsPos_right ipsClearfix">
				{{if $table->showAdvancedSearch AND ( ( isset( $table->sortOptions ) and !empty( $table->sortOptions ) ) OR $table->advancedSearch )}}
					<li>
						<a href="#elSortByMenu_menu" id="elSortByMenu_{$table->uniqueId}" data-role='sortButton' data-ipsMenu data-ipsMenu-activeClass="ipsButtonRow_active" data-ipsMenu-selectable="radio">{lang="sort_by"} <i class="fa fa-caret-down"></i></a>
						<ul class="ipsMenu ipsMenu_auto ipsMenu_withStem ipsMenu_selectable ipsHide" id="elSortByMenu_{$table->uniqueId}_menu">
							{{$custom = TRUE;}}
							{{foreach $table->sortOptions as $k => $col}}
								<li class="ipsMenu_item {{if $col === $table->sortBy}}{{$custom = FALSE;}}ipsMenu_itemChecked{{endif}}" data-ipsMenuValue="{$col}" data-sortDirection='{$table->getSortDirection( $col )}'><a href="{$table->baseUrl->setQueryString( array( 'filter' => $table->filter, 'sortby' => $col, 'sortdirection' => $table->getSortDirection( $col ), 'page' => '1' ) )}">{lang="{$table->langPrefix}sort_{$k}"}</a></li>
							{{endforeach}}
							{{if $table->advancedSearch}}
								<li class="ipsMenu_item {{if $custom}}ipsMenu_itemChecked{{endif}}" data-noSelect="true">
									<a href='{$table->baseUrl->setQueryString( array( 'advancedSearchForm' => '1', 'filter' => $table->filter, 'sortby' => $table->sortBy, 'sortdirection' => $table->sortDirection ) )}' data-ipsDialog data-ipsDialog-title='{lang="custom_sort"}'>{lang="custom"}</a>
								</li>
							{{endif}}
						</ul>
					</li>
				{{endif}}
				{{if !empty( $table->filters )}}
					<li>
						<a href="#elFilterByMenu_menu" data-role="tableFilterMenu" id="elFilterByMenu_{$table->uniqueId}" data-ipsMenu data-ipsMenu-activeClass="ipsButtonRow_active" data-ipsMenu-selectable="radio">{lang="filter_by"} <i class="fa fa-caret-down"></i></a>
						<ul class='ipsMenu ipsMenu_auto ipsMenu_withStem ipsMenu_selectable ipsHide' id='elFilterByMenu_{$table->uniqueId}_menu'>
							<li data-action="tableFilter" data-ipsMenuValue='' class='ipsMenu_item {{if !$table->filter}}ipsMenu_itemChecked{{endif}}'>
								<a href='{$table->baseUrl->setQueryString( array( 'filter' => '', 'sortby' => $table->sortBy, 'sortdirection' => $table->sortDirection, 'page' => '1' ) )}'>{lang="{$table->langPrefix}all"}</a>
							</li>
							{{foreach $table->filters as $k => $q}}
								<li data-action="tableFilter" data-ipsMenuValue='{$k}' class='ipsMenu_item {{if $k === $table->filter}}ipsMenu_itemChecked{{endif}}'>
									<a href='{$table->baseUrl->setQueryString( array( 'filter' => $k, 'sortby' => $table->sortBy, 'sortdirection' => $table->sortDirection, 'page' => '1' ) )}'>{lang="{$table->langPrefix}{$k}"}</a>
								</li>
							{{endforeach}}
						</ul>
					</li>
				{{endif}}
			</ul>

			<form action='{$table->baseUrl}' method='post'>
				<input type='hidden' name='csrfKey' value='{expression="\IPS\Session::i()->csrfKey"}'>
				<ul class='ipsButtonRow ipsPos_right ipsClearfix'>
					<li>
						<button type='submit' name='thumbnailSize' value='thumb' data-ipsTooltip title='{lang="view_as_thumbnails"}' class='ipsCursor_pointer{{if !isset( \IPS\Request::i()->cookie['thumbnailSize'] ) OR \IPS\Request::i()->cookie['thumbnailSize'] == 'thumb' }} ipsButtonRow_active{{endif}}'><i class='fa fa-th-large'></i></button>
					</li>
					<li>
						<button type='submit' name='thumbnailSize' value='large' data-ipsTooltip title='{lang="view_as_large"}' class='ipsCursor_pointer{{if isset( \IPS\Request::i()->cookie['thumbnailSize'] ) AND \IPS\Request::i()->cookie['thumbnailSize'] == 'large' }} ipsButtonRow_active{{endif}}'><i class='fa fa-square'></i></button>
					</li>
					<li>
						<button type='submit' name='thumbnailSize' value='rows' data-ipsTooltip title='{lang="view_as_list"}' class='ipsCursor_pointer{{if isset( \IPS\Request::i()->cookie['thumbnailSize'] ) AND \IPS\Request::i()->cookie['thumbnailSize'] == 'rows' }} ipsButtonRow_active{{endif}}'><i class='fa fa-th-list'></i></button>
					</li>
				</ul>
			</form>

			{{if $table->pages > 1}}
				<div data-role="tablePagination">
					{template="pagination" group="global" app="core" location="global" params="$table->baseUrl, $table->pages, $table->page, $table->limit"}
				</div>
			{{endif}}
		</div>
	{{endif}}

	{{if $table->canModerate()}}
		<form action="{$table->baseUrl->csrf()}" method="post" data-role='moderationTools' data-ipsPageAction class='ipsClear'>
	{{endif}}
	{{if !empty( $rows ) }}
		{{if isset( \IPS\Request::i()->cookie['thumbnailSize'] ) AND \IPS\Request::i()->cookie['thumbnailSize'] == 'large' AND \IPS\Request::i()->controller != 'search' }}
			<ol class='ipsList_reset ipsClear ipsType_center cGalleryLargeList ipsAreaBackground_light ipsPad' id='elTable_{$table->uniqueId}' data-controller='gallery.front.browse.list' data-role='tableRows'>
				{template="tableRowsLarge" group="browse" app="gallery" params="$table, $headers, $rows"}
			</ol>
		{{elseif isset( \IPS\Request::i()->cookie['thumbnailSize'] ) AND \IPS\Request::i()->cookie['thumbnailSize'] == 'rows' AND \IPS\Request::i()->controller != 'search' }}
			<ol class='ipsDataList ipsList_reset ipsClear cGalleryRowsList' id='elTable_{$table->uniqueId}' data-role='tableRows'>
				{template="tableRowsRows" group="browse" app="gallery" params="$table, $headers, $rows"}
			</ol>
		{{else}}
			<ol class='ipsPad ipsList_reset ipsClear ipsGrid ipsGrid_collapsePhone ipsType_center cGalleryPatchwork_list' data-controller='gallery.front.browse.list' data-ipsPhotoLayout data-ipsPhotoLayout-itemTemplate='core.patchwork.imageList' data-ipsPhotoLayout-minHeight='300' id='elTable_{$table->uniqueId}' data-role='tableRows'>
				{template="tableRowsThumbs" group="browse" app="gallery" params="$table, $headers, $rows"}
			</ol>
		{{endif}}
	{{else}}
		<div class='ipsType_center ipsPad'>
			<p class='ipsType_large ipsType_light'>{lang="no_rows_in_table"}</p>
		</div>
	{{endif}}
	{{if $table->canModerate()}}
			<div class="ipsAreaBackground ipsPad ipsClearfix ipsJS_hide" data-role="pageActionOptions">
				<div class="ipsPos_right">
					<select name="modaction" data-role="moderationAction">
						{{if $table->canModerate('unhide')}}
							<option value='approve' data-icon='check-circle'>{lang="approve"}</option>
						{{endif}}
						{{if $table->canModerate('feature') or $table->canModerate('unfeature')}}
							<optgroup label="{lang="feature"}" data-icon='star' data-action='feature'>
								{{if $table->canModerate('feature')}}
									<option value='feature'>{lang="feature"}</option>
								{{endif}}
								{{if $table->canModerate('unhide')}}
									<option value='unfeature'>{lang="unfeature"}</option>
								{{endif}}
							</optgroup>
						{{endif}}
						{{if $table->canModerate('pin') or $table->canModerate('unpin')}}
							<optgroup label="{lang="pin"}" data-icon='thumb-tack' data-action='pin'>
								{{if $table->canModerate('pin')}}
									<option value='pin'>{lang="pin"}</option>
								{{endif}}
								{{if $table->canModerate('unpin')}}
									<option value='unpin'>{lang="unpin"}</option>
								{{endif}}
							</optgroup>
						{{endif}}
						{{if $table->canModerate('hide') or $table->canModerate('unhide')}}
							<optgroup label="{lang="hide"}" data-icon='eye' data-action='hide'>
								{{if $table->canModerate('hide')}}
									<option value='hide'>{lang="hide"}</option>
								{{endif}}
								{{if $table->canModerate('unhide')}}
									<option value='unhide'>{lang="unhide"}</option>
								{{endif}}
							</optgroup>
						{{endif}}
						{{if $table->canModerate('lock') or $table->canModerate('unlock')}}
							<optgroup label="{lang="lock"}" data-icon='lock' data-action='lock'>
								{{if $table->canModerate('lock')}}
									<option value='lock'>{lang="lock"}</option>
								{{endif}}
								{{if $table->canModerate('unlock')}}
									<option value='unlock'>{lang="unlock"}</option>
								{{endif}}
							</optgroup>
						{{endif}}
						{{if $table->canModerate('move')}}
							<option value='move' data-icon='arrow-right'>{lang="move"}</option>
						{{endif}}
						{{if $table->canModerate('split_merge')}}
							<option value='merge' data-icon='level-up'>{lang="merge"}</option>
						{{endif}}
						{{if $table->canModerate('delete')}}
							<option value='delete' data-icon='trash'>{lang="delete"}</option>
						{{endif}}
						{{if $table->savedActions}}
							<optgroup label="{lang="saved_actions"}" data-icon='tasks' data-action='saved_actions'>
								{{foreach $table->savedActions as $k => $v}}
									<option value='savedAction-{$k}'>{$v}</option>
								{{endforeach}}
							</optgroup>
						{{endif}}
					</select>
					<button type="submit" class="ipsButton ipsButton_alternate ipsButton_verySmall">{lang="submit"}</button>
				</div>
			</div>
		</form>
	{{endif}}

	{{if $table->pages > 1}}
		<div class="ipsButtonBar ipsPad_half ipsClearfix ipsClear">
			<div data-role="tablePagination">
				{template="pagination" group="global" app="core" location="global" params="$table->baseUrl, $table->pages, $table->page, $table->limit"}
			</div>
		</div>
	{{endif}}
</div>]]></template>
 <template template_group="browse" template_name="index" template_data="$featured, $new" template_location="front" template_app="gallery"><![CDATA[<div class="ipsPageHeader ipsClearfix ipsSpacer_bottom">
	<h1 class="ipsType_pageTitle">{lang="gallery_title"}</h1>
</div>

{{if \IPS\gallery\Category::canOnAny('add')}}
	<ul class="ipsToolList ipsToolList_horizontal ipsClearfix ipsResponsive_hidePhone ipsSpacer_bottom">
		{template="categoryButtons" group="browse" params="\IPS\gallery\Category::canOnAny('add'), NULL, NULL"}
	</ul>
{{endif}}

{{if count( \IPS\gallery\Category::roots() )}}
	<div class="ipsSpacer_bottom">
		{template="categoryGrid" group="browse" app="gallery" params="\IPS\gallery\Category::roots()"}
	</div>
{{endif}}

{{if !empty( $featured )}}
<div class='ipsBox ipsSpacer_bottom'>
	<h2 class='ipsType_sectionTitle ipsType_reset'>{lang="featured_images"}</h2>
	<div data-ipsPhotoLayout data-ipsPhotoLayout-itemTemplate='gallery.patchwork.indexItem' data-ipsPhotoLayout-maxRows='3' class='ipsPad_half ipsClearfix cGalleryPatchwork_index'>
		<ul class='ipsList_inline'>
			{{foreach $featured as $image}}
				<li data-role='patchworkImage' data-json='{$image->json()|raw}'>
					<a href='{$image->url()}'><img src='{file="$image->small_file_name" extension="gallery_Images"}' alt='' class='ipsJS_hide'></a>
				</li>
			{{endforeach}}
		</ul>
	</div>
</div>
{{endif}}

{{if !empty( $new )}}
<div class='ipsBox'>
	<h2 class='ipsType_sectionTitle ipsType_reset'>{lang="new_images"}</h2>
	<div data-ipsPhotoLayout data-ipsPhotoLayout-itemTemplate='gallery.patchwork.indexItem' data-ipsPhotoLayout-maxRows='3' class='ipsPad ipsClearfix cGalleryPatchwork_index'>
		<ul class='ipsList_inline'>
			{{foreach $new as $image}}
				<li data-role='patchworkImage' data-json='{$image->json()|raw}'>
					<a href='{$image->url()}'><img src='{file="$image->small_file_name" extension="gallery_Images"}' alt='' class='ipsJS_hide'></a>
				</li>
			{{endforeach}}
		</ul>
	</div>
</div>
{{endif}}

{{if \IPS\gallery\Category::canOnAny('add')}}
	<ul class="ipsToolList ipsToolList_horizontal ipsResponsive_showPhone ipsResponsive_block ipsClearfix ipsSpacer_top">
		{template="categoryButtons" group="browse" params="\IPS\gallery\Category::canOnAny('add')"}
	</ul>
{{endif}}]]></template>
 <template template_group="browse" template_name="indexSidebar" template_data="$canSubmitImages, $currentCategory=NULL, $currentAlbum=NULL" template_location="front" template_app="gallery"></template>
 <template template_group="browse" template_name="miniAlbum" template_data="$album" template_location="front" template_app="gallery"><![CDATA[
<ol class='ipsGrid ipsList_reset cGalleryMiniAlbum ipsClearfix' data-ipsGrid data-ipsGrid-minItemSize='60' data-ipsGrid-maxItemSize='100'>
	{{foreach $album->_latestImages as $image}}
		{{if $image->medium_file_name}}
			<li style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), \IPS\File::get( 'gallery_Images', $image->small_file_name )->url )"}" );' class='ipsGrid_span3 cGalleryTrimmedImage' data-grid-ratio='100' data-imageID='{$image->id}'>
				<a href='{$image->url()->setQueryString( 'browse', 1 )}' title='{$image->caption}'>
					<img src='{file="$image->small_file_name" extension="gallery_Images"}' alt='{$image->caption}'>
				</a>
			</li>
		{{else}}
			<li class='ipsGrid_span3 ipsNoThumb ipsNoThumb_video'>&nbsp;</li>
		{{endif}}
	{{endforeach}}
</ol>
<a href='{$album->url()}' class='ipsType_small'>{lang="view_entire_album" sprintf="$album->name"}</a>]]></template>
 <template template_group="browse" template_name="noImages" template_data="$container" template_location="front" template_app="gallery"><![CDATA[
<div class='ipsType_center ipsPad'>
	<p class='ipsType_large'>{{if $container instanceof \IPS\gallery\Album}}{lang="no_images_in_album"}{{else}}{lang="no_images_in_cat"}{{endif}}</p>
	{{if $container->can('add')}}
		<a href='{url="app=gallery&module=gallery&controller=submit&_new=1" seoTemplate="gallery_submit"}{{if $container instanceof \IPS\gallery\Album}}&category={$container->category_id}&album={$container->id}{{else}}&category={$container->id}{{endif}}' class='ipsButton ipsButton_primary ipsButton_medium' data-ipsDialog data-ipsDialog-size='fullscreen' data-ipsDialog-remoteSubmit='true'>{lang="submit_first_image"}</a>
	{{endif}}
</div>]]></template>
 <template template_group="browse" template_name="tableRowsLarge" template_data="$table, $headers, $images" template_location="front" template_app="gallery"><![CDATA[
{{foreach $images as $image}}
	<li class='{{if $image->hidden()}}ipsModerated{{else}}ipsAreaBackground_reset{{endif}} ipsBox ipsPad ipsType_center cGalleryImageItem'>
		<a href='{$image->url()}' title='{lang="view_this_image" sprintf="$image->caption"}'>
			<img src='{file="$image->medium_file_name" extension="gallery_Images"}' alt='' class='ipsImage'>
		</a>
		<h2 class='ipsType_sectionHead ipsType_normal ipsTruncate ipsTruncate_line'>
			{{if $image->unread()}}<span class='ipsItemStatus ipsItemStatus_small'><i class="fa fa-circle"></i></span>{{endif}}
			{{if $image->prefix()}}
				{template="prefix" group="global" app="core" params="$image->prefix( TRUE ), $image->prefix()"}
			{{endif}}
			<a href='{$image->url()}' title='{lang="view_this_image" sprintf="$image->caption"}'>
				{{if $image->unread()}}<strong>{$image->caption}</strong>{{else}}{$image->caption}{{endif}}
			</a>
			{{if $table->canModerate()}}
				<input type='checkbox' data-role='moderation' name="moderate[{$image->id}]" data-actions="{{if $image->mapped('featured')}}unfeature{{else}}feature{{endif}} {{if $image->mapped('pinned')}}unpin{{else}}pin{{endif}} {{if $image->hidden() === -1}}unhide{{elseif $image->hidden() === 1}}approve{{else}}hide{{endif}} {{if $image->mapped('locked')}}unlock{{else}}lock{{endif}} move delete" data-state='{{if $image->tableStates()}}{$image->tableStates()}{{endif}}'>
			{{endif}}
		</h2>
		<ul class='ipsList_inline'>
			{{if $image->directContainer()->allow_comments}}
				<li class='{{if $image->comments == 0}}ipsFaded{{endif}}' data-ipsTooltip title='{lang="num_comments" pluralize="$image->comments"}'><i class='fa fa-comment'></i> {$image->comments}</li>
			{{endif}}
			<li class='{{if $image->views == 0}}ipsFaded{{endif}}' data-ipsTooltip title='{lang="num_views_with_number" pluralize="$image->views"}'><i class='fa fa-eye'></i> {$image->views}</li>
		</ul>
		{{if $image->mapped('pinned') || $image->mapped('featured') || $image->hidden() === -1 || $image->hidden() === 1}}
			<br>
			<ul class='ipsList_inline'>
				<li>
					{{if $image->hidden() === -1}}
						<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning" data-ipsTooltip title='{$image->hiddenBlurb()}'><i class='fa fa-eye-slash'></i></span>
					{{elseif $image->hidden() === 1}}
						<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning" data-ipsTooltip title='{lang="pending_approval"}'><i class='fa fa-warning'></i></span>
					{{endif}}							
					{{if $image->mapped('pinned')}}
						<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive" data-ipsTooltip title='{lang="pinned"}'><i class='fa fa-thumb-tack'></i></span>
					{{endif}}
					{{if $image->mapped('featured')}}
						<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive" data-ipsTooltip title='{lang="featured"}'><i class='fa fa-star'></i></span>
					{{endif}}
				</li>
			</ul>
		{{endif}}
	</li>
{{endforeach}}
]]></template>
 <template template_group="browse" template_name="tableRowsRows" template_data="$table, $headers, $images" template_location="front" template_app="gallery"><![CDATA[{{if count( $images )}}
	{{foreach $images as $image}}
		<li class='ipsDataItem {{if $image->unread()}}ipsDataItem_unread{{endif}} {{if method_exists( $image, 'tableClass' ) && $image->tableClass()}}ipsDataItem_{$image->tableClass()}{{endif}} {{if $image->hidden()}}ipsModerated{{endif}}'>
			{{if isset( \IPS\Request::i()->cookie['thumbnailSize'] ) AND \IPS\Request::i()->cookie['thumbnailSize'] == 'large' }}
				<div class='ipsDataItem_main'>
					<div class='ipsType_center'>
						{{if $image->medium_file_name}}
							<a href='{$image->url()}' title='{lang="view_this_image" sprintf="$image->caption"}'>
								<img src='{file="$image->medium_file_name" extension="gallery_Images"}' alt='{$image->caption}' class='ipsImage'>
							</a>
						{{else}}
							{template="thumbImage" group="global" app="core" params="'', $image->caption, 'medium', 'ipsPos_center', 'view_this', $image->url(), 'gallery_Images'"}
						{{endif}}
						<br>
						<h4 class='ipsDataItem_title ipsType_large ipsContained_container'>
							{{if $image->unread() === -1}}
								<span><span class='ipsBadge ipsBadge_new'>{lang="new"}</span></span>
							{{elseif $image->unread() === 1}}
								<span><span class='ipsBadge ipsBadge_new'>{lang="updated"}</span></span>
							{{endif}}

							{{if $image->hidden() === -1}}
								<span><span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning" data-ipsTooltip title='{$image->hiddenBlurb()}'><i class='fa fa-eye-slash'></i></span></span>
							{{elseif $image->hidden() === 1}}
								<span><span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning" data-ipsTooltip title='{lang="pending_approval"}'><i class='fa fa-warning'></i></span></span>
							{{endif}}
							{{if $image->mapped('pinned')}}
								<span><span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive" data-ipsTooltip title='{lang="pinned"}'><i class='fa fa-thumb-tack'></i></span></span>
							{{endif}}
							{{if $image->mapped('featured')}}
								<span><span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive" data-ipsTooltip title='{lang="featured"}'><i class='fa fa-star'></i></span></span>
							{{endif}}

							{{if $image->prefix()}}
								{template="prefix" group="global" app="core" params="$image->prefix( TRUE ), $image->prefix()"}
							{{endif}}
							
							<span class='ipsContained ipsType_break'>
								<a href='{$image->url()}' title='{lang="view_this_image" sprintf="$image->caption"} {{if $image->canEdit()}}{lang="click_hold_edit"}{{endif}}' class='ipsTruncate ipsTruncate_line' {{if $image->canEdit()}}data-role="editableTitle"{{endif}}>
									{$image->caption}
								</a>
							</span>
						</h4>
						<p class='ipsType_reset ipsType_light ipsType_blendLinks'>
							{lang="byline_nodate" htmlsprintf="$image->author()->link()"}
							{{if \IPS\Request::i()->controller != 'gallery'}}
								{lang="in"} <a href="{$image->container()->url()}">{$image->container()->_title}</a>
							{{endif}}
						</p>	
						{{if count( $image->tags() )}}
							<br>
							<ul class='ipsList_inline'>
								<li>{template="tags" group="global" app="core" params="$image->tags()"}</li>
							</ul>
						{{endif}}
						<p class='ipsType_normal'>
							{{if $image->directContainer()->allow_comments}}
								{{if $image->comments}}
									<a href='{$image->url()->setFragment('comments')}'>
								{{endif}}
								{lang="num_comments" pluralize="$image->comments"}
								{{if $image->comments}}
									</a>
								{{endif}}
								&middot;
							{{endif}}
							<strong>{{if $image->updated == $image->date}}{lang="uploaded"}{{else}}{lang="updated"}{{endif}} {datetime="$image->updated"}</strong>
						</p>
					</div>
				</div>
				{{if $table->canModerate()}}
					<div class='ipsDataItem_modCheck'>
						<span class='ipsCustomInput'>
							<input type='checkbox' data-role='moderation' name="moderate[{$image->id}]" data-actions="{expression="implode( ' ', $table->multimodActions( $image ) )"}" data-state='{{if $image->tableStates()}}{$image->tableStates()}{{endif}}'>
							<span></span>
						</span>
					</div>
				{{endif}}
			{{else}}
				<div class='ipsDataItem_generic ipsDataItem_size3'>
					{template="thumbImage" group="global" app="core" params="$image->small_file_name, $image->caption, 'medium', '', 'view_this', $image->url(), 'gallery_Images'"}
				</div>
				<div class='ipsDataItem_main'>
					<h4 class='ipsDataItem_title ipsType_large ipsContained_container'>
						{{if $image->unread()}}
							<span>
								<span class='ipsItemStatus' data-ipsTooltip title='{{if $image->unread() === -1}}{lang="new"}{{else}}{lang="updated"}{{endif}}'>
									<i class="fa fa-circle"></i>
								</span>
							</span>
						{{endif}}

						{{if $image->hidden() === -1}}
							<span><span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning" data-ipsTooltip title='{$image->hiddenBlurb()}'><i class='fa fa-eye-slash'></i></span></span>
						{{elseif $image->hidden() === 1}}
							<span><span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning" data-ipsTooltip title='{lang="pending_approval"}'><i class='fa fa-warning'></i></span></span>
						{{endif}}
						{{if $image->mapped('pinned')}}
							<span><span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive" data-ipsTooltip title='{lang="pinned"}'><i class='fa fa-thumb-tack'></i></span></span>
						{{endif}}
						{{if $image->mapped('featured')}}
							<span><span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive" data-ipsTooltip title='{lang="featured"}'><i class='fa fa-star'></i></span></span>
						{{endif}}

						{{if $image->prefix()}}
							{template="prefix" group="global" app="core" params="$image->prefix( TRUE ), $image->prefix()"}
						{{endif}}

						<span class='ipsContained ipsType_break'>
							<a href='{$image->url()}' title='{lang="view_this_image" sprintf="$image->caption"} {{if $image->canEdit()}}{lang="click_hold_edit"}{{endif}}' {{if $image->canEdit()}}data-role="editableTitle"{{endif}}>
								{$image->caption}
							</a>
						</span>
					</h4>
					<p class='ipsType_reset ipsType_light ipsType_blendLinks'>{lang="byline_nodate" htmlsprintf="$image->author()->link()"}</p>			
					<div class='ipsType_medium ipsType_richText ipsType_break' data-ipsTruncate data-ipsTruncate-type="remove" data-ipsTruncate-size="2 lines">
						{$image->truncated()|raw}
					</div>

					{{if count( $image->tags() )}}
						<ul class='ipsList_inline'>
							<li>{template="tags" group="global" app="core" params="$image->tags()"}</li>
						</ul>
					{{endif}}
				</div>
				<div class='ipsDataItem_generic ipsDataItem_size8'>
					{{if $image->directContainer()->allow_comments}}
						<p class='ipsType_normal ipsType_reset'>
							{{if $image->comments}}
								<a href='{$image->url()->setFragment('replies')}'>
							{{endif}}
							{lang="num_comments" pluralize="$image->comments"}
							{{if $image->comments}}
								</a>
							{{endif}}
						</p>
					{{endif}}
					<p class='ipsType_medium ipsType_reset'><strong>{{if $image->updated == $image->date}}{lang="uploaded"}{{else}}{lang="updated"}{{endif}} {datetime="$image->updated"}</strong></p>
				</div>
				{{if $table->canModerate()}}
					<div class='ipsDataItem_modCheck'>
						<span class='ipsCustomInput'>
							<input type='checkbox' data-role='moderation' name="moderate[{$image->id}]" data-actions="{expression="implode( ' ', $table->multimodActions( $image ) )"}" data-state='{{if $image->unread() === -1 or $image->unread() === 1}}unread{{else}}read{{endif}} {{if $image->hidden() === -1}}hidden{{elseif $image->hidden === 1}}unapproved{{endif}} {{if $image->mapped('pinned')}}pinned{{endif}} {{if $image->mapped('featured')}}featured{{endif}} {{if $image->mapped('locked')}}locked{{endif}}'>
							<span></span>
						</span>
					</div>
				{{endif}}
			{{endif}}
		</li>
	{{endforeach}}
{{endif}}]]></template>
 <template template_group="browse" template_name="tableRowsThumbs" template_data="$table, $headers, $images" template_location="front" template_app="gallery"><![CDATA[{{foreach $images as $image}}
	<li class='ipsGrid_span4 {{if $image->hidden()}}ipsModerated{{else}}ipsAreaBackground_light{{endif}} cGalleryImageItem' data-role='patchworkImage' data-json='{$image->json()|raw}'>
		<div data-grid-ratio='65'>
			<a href='{$image->url()}' title='{lang="view_this_image" sprintf="$image->caption"}' style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), \IPS\File::get( 'gallery_Images', $image->small_file_name )->url )"}" )' class='cGalleryImageItem_image cGalleryTrimmedImage'>
				<img src='{file="$image->small_file_name" extension="gallery_Images"}' alt='' class='cGalleryThumb'>&nbsp;
			</a>
			{{if $table->canModerate()}}
				<input type='checkbox' data-role='moderation' name="moderate[{$image->id}]" data-actions="{{if $image->mapped('featured')}}unfeature{{else}}feature{{endif}} {{if $image->mapped('pinned')}}unpin{{else}}pin{{endif}} {{if $image->hidden() === -1}}unhide{{elseif $image->hidden() === 1}}approve{{else}}hide{{endif}} {{if $image->mapped('locked')}}unlock{{else}}lock{{endif}} move delete" data-state='{{if $image->tableStates()}}{$image->tableStates()}{{endif}}'>
			{{endif}}
		</div>
		<ul class='ipsList_inline ipsType_medium ipsClearfix'>
			{{if $image->unread()}}
				<li class='ipsPos_left'>
					<span class='ipsItemStatus ipsItemStatus_small' data-ipsTooltip title='{{if $image->unread() === -1}}{lang="new"}{{else}}{lang="updated"}{{endif}}'><i class="fa fa-circle"></i></span>
				</li>
			{{endif}}
			{{if $image->mapped('pinned') || $image->mapped('featured') || $image->hidden() === -1 || $image->hidden() === 1}}
				<li class='ipsPos_left'>
					{{if $image->hidden() === -1}}
						<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning" data-ipsTooltip title='{$image->hiddenBlurb()}'><i class='fa fa-eye-slash'></i></span>
					{{elseif $image->hidden() === 1}}
						<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning" data-ipsTooltip title='{lang="pending_approval"}'><i class='fa fa-warning'></i></span>
					{{endif}}							
					{{if $image->mapped('pinned')}}
						<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive" data-ipsTooltip title='{lang="pinned"}'><i class='fa fa-thumb-tack'></i></span>
					{{endif}}
					{{if $image->mapped('featured')}}
						<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive" data-ipsTooltip title='{lang="featured"}'><i class='fa fa-star'></i></span>
					{{endif}}
				</li>
			{{endif}}
			
			{{if $image->directContainer()->allow_comments}}
				<li class='ipsPos_right {{if $image->comments == 0}}ipsFaded{{endif}}' data-ipsTooltip title='{lang="num_comments" pluralize="$image->comments"}'><i class='fa fa-comment'></i> {$image->comments}</li>
			{{endif}}
		</ul>
	</li>
{{endforeach}}]]></template>
 <template template_group="dashboard" template_name="overview" template_data="$data" template_location="admin" template_app="gallery"><![CDATA[<ul class="ipsDataList">
	{{foreach $data as $k => $v}}
		<li class="ipsDataItem">
			<span class="ipsDataItem_generic ipsDataItem_size6">
				<strong>{lang="$k"}</strong>
			</span>
			<span class="ipsDataItem_generic">
				{{if $k === 'total_disk_spaceg'}}
					{filesize="$v"}
				{{elseif $k === 'largest_image'}}
					<a href='{$v->url()}' target='_blank'>{$v->caption}</a> <span class="ipsType_light">({filesize="$v->file_size"})</span>
				{{elseif $k === 'most_viewed_image'}}
					<a href='{$v->url()}' target='_blank'>{$v->caption}</a> <span class="ipsType_light">({lang="num_views_with_number" pluralize="$v->views"})</span>
				{{else}}
					{$v}
				{{endif}}
			</span>
		</li>
	{{endforeach}}
</ul>]]></template>
 <template template_group="global" template_name="approvalQueueItem" template_data="$item, $ref, $container, $title" template_location="front" template_app="gallery"><![CDATA[<div id="elApprovePanel" class='ipsBox'>
	<article class="ipsClearfix ipsClear">
		<div class='ipsPad'>
			<p class="ipsPos_right ipsPad_half">
				<a href='{$item->url()}' class='ipsType_normal ipsType_light'>
					<i class='fa fa-{$item::$icon}'></i> {lang="$item::$title"}
				</a>
			</p>
			<div class="ipsPhotoPanel ipsPhotoPanel_small ipsClearfix"> 
				{template="userPhoto" group="global" params="$item->author()"}
				<div>
					<a href="#user{$item->author()->member_id}_menu" id="user{$item->author()->member_id}" class="ipsType_sectionHead" data-ipsmenu="">{$item->author()->name} &nbsp;<i class="fa fa-caret-down"></i></a>
					<ul class="ipsMenu ipsMenu_auto ipsMenu_withStem ipsHide" id="user{$item->author()->member_id}_menu">
						{{if \IPS\Member::loggedIn()->modPermission('mod_can_warn')}}
							<li class='ipsMenu_item'><a href='{url="app=core&module=system&controller=warnings&do=warn&id={$item->author()->member_id}&ref={$ref}" seoTemplate="warn_add" seoTitle="$item->author()->members_seo_name"}' data-ipsDialog data-ipsDialog-title="{lang="warn_member" sprintf="$item->author()->name"}" data-ipsDialog-remoteSubmit data-ipsDialog-flashMessage="{lang="warning_issued"}" data-role="warnUserDialog">{lang="warn_user"}</a></li>
						{{endif}}
						{{if $item->author()->member_id != \IPS\Member::loggedIn()->member_id}}
							{{if $item->author()->members_bitoptions['bw_is_spammer']}}
								<li class='ipsMenu_item' data-ipsMenuValue='spamFlagButton'><a href='{url="app=core&module=system&controller=moderation&do=flagAsSpammer&id={$item->author()->member_id}&s=0" seoTemplate="flag_as_spammer" seoTitle="$item->author()->members_seo_name" csrf="true"}' data-confirm data-confirmSubMessage="{lang="spam_unflag_confirm"}">{lang="spam_unflag"}</a></li>
							{{else}}
								<li class='ipsMenu_item' data-ipsMenuValue='spamFlagButton'><a href='{url="app=core&module=system&controller=moderation&do=flagAsSpammer&id={$item->author()->member_id}&s=1" seoTemplate="flag_as_spammer" seoTitle="$item->author()->members_seo_name" csrf="true"}' data-confirm>{lang="spam_flag"}</a></li>
							{{endif}}
						{{endif}}
						<li class="ipsMenu_item"><a href='{url="app=core&module=messaging&controller=messenger&do=compose&to={$item->author()->member_id}" seoTemplate="messenger_compose"}' data-ipsDialog data-ipsDialog-title='{lang="compose_new"}' data-ipsDialog-remoteSubmit data-ipsDialog-flashMessage="{lang="message_sent"}">{lang="message_send"}</a></li>
					</ul>
					{{if $container}}
						<p class='ipsType_reset'>{lang="posted_in_container"} <a href="{$container->url()}">{$container->_title}</a></p>
					{{endif}}
					<p class="ipsType_light ipsType_reset">{lang="date_replied" htmlsprintf="\IPS\DateTime::ts( $item->mapped('date') )->html(FALSE)"}</p>
				</p></div>
			</div>
		</div>
		<div class='ipsAreaBackground_light ipsPad'>
			<div class='ipsBox'>
				<h2 class="ipsType_sectionTitle ipsType_blendLinks"><a href="{$item->url()}">{$title}</a></h2>
				<div class="ipsType_richText ipsPost ipsType_normal ipsPad">
					{{if $item->medium_file_name}}
						<a href='{$item->url()}'>
							<img src='{file="$item->medium_file_name" extension="gallery_Images"}' alt=''>
						</a>
					{{else}}
						<a href='{$item->url()}'>
							<div class='ipsNoThumb ipsNoThumb_video cSearchActivity_image'></div>
						</a>
					{{endif}}
				</div>
			</div>
		</div>
	</article>
</div>
]]></template>
 <template template_group="global" template_name="commentTableHeader" template_data="$comment, $image" template_location="front" template_app="gallery"><![CDATA[
<div class='ipsDataList ipsAreaBackground_light ipsClearfix'>
	<div class='ipsDataItem'>
		<div class='ipsDataItem_generic ipsDataItem_size2'>
			{template="thumbImage" group="global" app="core" params="$image->thumb_file_name, $image->caption, 'small', '', 'view_this', $image->url(), 'gallery_Images'"}
		</div>
		<div class='ipsDataItem_main ipsType_break'>
			<h3 class='ipsType_sectionHead'><a href='{$image->url()}' title='{lang="view_this_image" sprintf="$image->caption"}'>{$image->caption}</a></h3>
			<p class='ipsType_normal ipsType_light ipsType_blendLinks ipsType_reset'>{lang="in"} <a href='{$image->container()->url()}'>{$image->container()->_title}</a></p>
			{{if $image->container()->allow_rating}}
				{template="rating" group="global" location="front" app="core" params="'large', $image->rating"} &nbsp;&nbsp;
			{{endif}}

			<span class='ipsType_medium ipsType_reset'>{{if $image->container()->allow_comments}}&nbsp;&nbsp;{{if !$image->comments}}<span class='ipsType_light'>{{endif}}<i class='fa fa-comment'></i> {$image->comments}{{endif}}{{if !$image->comments}}</span>{{endif}}</span>
		</div>
	</div>
</div>]]></template>
 <template template_group="global" template_name="embedAlbumComment" template_data="$comment, $item, $url" template_location="front" template_app="gallery"><![CDATA[
<div data-embedInfo-maxSize='500' class='ipsRichEmbed'>
	{template="embedHeader" group="embed" app="core" params="$comment, \IPS\Member::loggedIn()->language()->addToStack( 'x_commented_album', FALSE, array( 'sprintf' => array( $comment->author()->name ) ) ), $comment->mapped('date'), $url"}
	<div class='ipsPad'>
		<div class='ipsRichEmbed_originalItem ipsAreaBackground_reset ipsSpacer_bottom ipsType_blendLinks'>
			<div>
				{{$images = \IPS\Gallery\Image::getItemsWithPermission( array( array( 'image_album_id=?', $item->asNode()->id ) ), ( $item->asNode()->sort_options == 'title' ) ? 'image_caption ASC' : \IPS\gallery\Image::$databasePrefix . \IPS\gallery\Image::$databaseColumnMap[ $item->asNode()->sort_options ] . ' DESC', 19 );}}

				{{if count( $images )}}
					<ul class='ipsList_reset cGalleryEmbed_albumStrip cGalleryEmbed_albumStrip_mini ipsAreaBackground_reset ipsClearfix'>
						{{foreach $images as $albumImage}}
							<li>
								<a href='{$albumImage->url()}' style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), \IPS\File::get( 'gallery_Images', $albumImage->thumb_file_name )->url )"}") '>
									<img src='{file="$albumImage->thumb_file_name" extension="gallery_Images"}' class='ipsHide'>
								</a>
							</li>
						{{endforeach}}

						{{if $item->asNode()->count_imgs > 19}}
							<li class='cGalleryEmbed_albumStrip_last ipsAreaBackground'>
								<a href='{$item->asNode()->url()}'><span>+{expression="$item->asNode()->count_imgs - 19"}</span></a>
							</li>
						{{endif}}
					</ul>
				{{endif}}
				<div class='ipsPad'>
					{template="embedOriginalItem" group="embed" app="core" params="$item"}
				</div>
			</div>
		</div>

		<div class='ipsType_richText ipsType_medium' data-truncate='3'>
			{$comment->truncated(TRUE)|raw}
		</div>

		{{if \IPS\IPS::classUsesTrait( $comment, 'IPS\Content\Reactable' ) and count( $comment->reactions() ) and settings.reputation_enabled}}
			<ul class='ipsList_inline ipsSpacer_top ipsSpacer_half'>
				<li>
					{template="reactionOverview" app="core" group="global" params="$comment, TRUE, 'small'"}
				</li>
			</ul>
		{{endif}}
	</div>
</div>]]></template>
 <template template_group="global" template_name="embedAlbumReview" template_data="$comment, $item, $url" template_location="front" template_app="gallery"><![CDATA[
<div data-embedInfo-maxSize='500' class='ipsRichEmbed'>
	{template="embedHeader" group="embed" app="core" params="$comment, \IPS\Member::loggedIn()->language()->addToStack( 'x_reviewed_album', FALSE, array( 'sprintf' => array( $comment->author()->name ) ) ), $comment->mapped('date'), $url"}
	<div class='ipsPad'>
		<div class='ipsRichEmbed_originalItem ipsAreaBackground_reset ipsSpacer_bottom ipsType_blendLinks'>
			<div>
				{{$images = \IPS\Gallery\Image::getItemsWithPermission( array( array( 'image_album_id=?', $item->asNode()->id ) ), ( $item->asNode()->sort_options == 'title' ) ? 'image_caption ASC' : \IPS\gallery\Image::$databasePrefix . \IPS\gallery\Image::$databaseColumnMap[ $item->asNode()->sort_options ] . ' DESC', 19 );}}

				{{if count( $images )}}
					<ul class='ipsList_reset cGalleryEmbed_albumStrip cGalleryEmbed_albumStrip_mini ipsAreaBackground_reset ipsClearfix'>
						{{foreach $images as $albumImage}}
							<li>
								<a href='{$albumImage->url()}' style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), \IPS\File::get( 'gallery_Images', $albumImage->thumb_file_name )->url )"}") '>
									<img src='{file="$albumImage->thumb_file_name" extension="gallery_Images"}' class='ipsHide'>
								</a>
							</li>
						{{endforeach}}

						{{if $item->asNode()->count_imgs > 19}}
							<li class='cGalleryEmbed_albumStrip_last ipsAreaBackground'>
								<a href='{$item->asNode()->url()}'><span>+{expression="$item->asNode()->count_imgs - 19"}</span></a>
							</li>
						{{endif}}
					</ul>
				{{endif}}
				<div class='ipsPad'>
					{template="embedOriginalItem" group="embed" app="core" params="$item"}
				</div>
			</div>
		</div>

		{template="rating" app="core" params="'veryLarge', $comment->mapped('rating')" group="global"} 
		{{if $comment->mapped('votes_total')}}
			<p class='ipsType_reset ipsType_medium'>{$comment->helpfulLine()|raw}</p>
		{{endif}}
		<hr class='ipsHr'>
		<div class='ipsType_richText ipsType_medium ipsSpacer_top ipsSpacer_half' data-truncate='3'>
			{$comment->truncated(TRUE)|raw}
		</div>

		{{if \IPS\IPS::classUsesTrait( $comment, 'IPS\Content\Reactable' ) and count( $comment->reactions() ) and settings.reputation_enabled}}
			<ul class='ipsList_inline ipsSpacer_top ipsSpacer_half'>
				<li>
					{template="reactionOverview" app="core" group="global" params="$comment, TRUE, 'small'"}
				</li>
			</ul>
		{{endif}}
	</div>
</div>]]></template>
 <template template_group="global" template_name="embedAlbums" template_data="$albumItem, $albumNode, $url" template_location="front" template_app="gallery"><![CDATA[
<div data-embedInfo-maxSize='500' class='ipsRichEmbed'>
	{template="embedHeader" group="embed" app="core" params="$albumItem, \IPS\Member::loggedIn()->language()->addToStack( 'x_added_album_in', FALSE, array( 'sprintf' => array( $albumItem->author()->name, $albumNode->category()->_title ) ) ), $albumItem->mapped('date'), $url"}
	{{if $albumNode->coverPhoto('medium')}}
		<div class='ipsRichEmbed_masthead ipsRichEmbed_mastheadBg cGalleryEmbed ipsType_center'>
			<a href='{$albumNode->url()}' style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), $albumNode->coverPhoto('medium') )"}" )'>
				<img src='{$albumNode->coverPhoto('medium')}' class='ipsHide' alt=''>
			</a>
		</div>
	{{endif}}

	{{$images = \IPS\Gallery\Image::getItemsWithPermission( array( array( 'image_album_id=?', $albumNode->id ) ), ( $albumNode->sort_options == 'title' ) ? 'image_caption ASC' : \IPS\gallery\Image::$databasePrefix . \IPS\gallery\Image::$databaseColumnMap[ $albumNode->sort_options ] . ' DESC', 9 );}}

	{{if count( $images )}}
		<ul class='ipsList_reset cGalleryEmbed_albumStrip ipsAreaBackground_reset ipsClearfix'>
			{{foreach $images as $albumImage}}
				<li>
					<a href='{$albumImage->url()}' style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), \IPS\File::get( 'gallery_Images', $albumImage->thumb_file_name )->url )"}") '>
						<img src='{file="$albumImage->thumb_file_name" extension="gallery_Images"}' class='ipsHide'>
					</a>
				</li>
			{{endforeach}}

			{{if $albumNode->count_imgs > 9}}
				<li class='cGalleryEmbed_albumStrip_last ipsAreaBackground'>
					<a href='{$albumNode->url()}'><span>+{expression="$albumNode->count_imgs - 9"}</span></a>
				</li>
			{{endif}}
		</ul>
	{{endif}}

	<div class='ipsPad ipsClearfix'>
		<h3 class='ipsRichEmbed_itemTitle ipsTruncate ipsTruncate_line ipsType_blendLinks'>
			<a href='{$url}' title="{$albumItem->mapped('title')}">{$albumItem->mapped('title')}</a>
		</h3>
		{{if $desc = $albumItem->truncated(TRUE)}}
			<div class='ipsType_richText ipsType_medium ipsSpacer_top ipsSpacer_half' data-truncate='3'>
				{$desc|raw}
			</div>
		{{endif}}
		{template="embedItemStats" group="embed" app="core" params="$albumItem, $albumNode->use_comments"}
	</div>
</div>]]></template>
 <template template_group="global" template_name="embedImage" template_data="$item, $url, $image=NULL" template_location="front" template_app="gallery"><![CDATA[
<div data-embedInfo-maxSize='500' class='ipsRichEmbed'>
	{template="embedHeader" group="embed" app="core" params="$item, \IPS\Member::loggedIn()->language()->addToStack( 'x_added_image_in', FALSE, array( 'sprintf' => array( $item->author()->name, $item->directContainer()->_title ) ) ), $item->mapped('date'), $url"}
	{{if !$item->media OR ( $item->media AND $item->masked_file_name)}}
		<div class='ipsRichEmbed_masthead cGalleryEmbed ipsType_center' data-imageID='{$item->id}'>
			<a href='{$url->setQueryString( 'browse', 1 )}' title='{$item->caption}'>
			   <img src='{file="$item->media ? $item->masked_file_name : $item->original_file_name" extension="gallery_Images"}' alt='{$item->caption}' class='ipsImage'>
			</a>
		</div>
	{{else}}
		<div class='cGalleryEmbed ipsNoThumb ipsNoThumb_video'>&nbsp;</div>
	{{endif}}
	<div class='ipsPad ipsClearfix'>
		<p class='ipsRichEmbed_itemTitle ipsType_reset ipsTruncate ipsTruncate_line ipsType_blendLinks'>
			<a href='{$url}'>{$item->caption}</a>
		</p>
		{{if $desc = $item->truncated(TRUE)}}
			<div class='ipsType_richText ipsType_medium ipsSpacer_top ipsSpacer_half' data-truncate='3'>
				{$desc|raw}
			</div>
		{{endif}}
		{{if $item->copyright}}
			<p class='ipsType_reset ipsType_light ipsType_medium ipsSpacer_top ipsSpacer_half'>
				&copy; {$item->copyright}
			</p>
		{{endif}}
		{template="embedItemStats" group="embed" app="core" params="$item"}
	</div>

	{{if $item->directContainer() instanceof \IPS\gallery\Album}}
		<div class='ipsAreaBackground_light ipsPad ipsClearfix ipsRichEmbed_moreInfo'>
			<h3 class='ipsType_minorHeading ipsTruncate ipsTruncate_line ipsType_blendLinks'>{lang="from_the_album"} "<a href='{$item->directContainer()->url()}'>{$item->directContainer()->_title}</a>"</h3>
			{{$images = \IPS\Gallery\Image::getItemsWithPermission( array( array( 'image_album_id=?', $item->album_id ) ), ( $item->directContainer()->sort_options == 'title' ) ? 'image_caption ASC' : $item::$databasePrefix . $item::$databaseColumnMap[ $item->directContainer()->sort_options ] . ' DESC', 9 );}}

			{{if count( $images )}}
				<ul class='ipsList_reset cGalleryEmbed_albumStrip cGalleryEmbed_albumStrip_mini ipsSpacer_top ipsSpacer_half'>
					{{foreach $images as $albumImage}}
						<li>
							<a href='{$albumImage->url()}' style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), \IPS\File::get( 'gallery_Images', $albumImage->thumb_file_name )->url )"}") '>
								<img src='{file="$albumImage->thumb_file_name" extension="gallery_Images"}' class='ipsHide'>
							</a>
						</li>
					{{endforeach}}

					{{if $item->directContainer()->count_imgs > 9}}
						<li class='cGalleryEmbed_albumStrip_last ipsAreaBackground'>
							<a href='{$item->directContainer()->url()}'><span>+{expression="$item->directContainer()->count_imgs - 9"}</span></a>
						</li>
					{{endif}}
				</ul>
			{{endif}}
		</div>
	{{endif}}
</div>]]></template>
 <template template_group="global" template_name="embedImageComment" template_data="$comment, $item, $url" template_location="front" template_app="gallery"><![CDATA[
<div data-embedInfo-maxSize='500' class='ipsRichEmbed'>
	{template="embedHeader" group="embed" app="core" params="$comment, \IPS\Member::loggedIn()->language()->addToStack( 'x_commented_photo', FALSE, array( 'sprintf' => array( $comment->author()->name ) ) ), $comment->mapped('date'), $url"}
	<div class='ipsPad'>
		<div class='ipsRichEmbed_originalItem ipsAreaBackground_reset ipsSpacer_bottom ipsType_blendLinks'>
			<div>
				{{if $item->medium_file_name}}
					<div class='ipsRichEmbed_masthead ipsRichEmbed_mastheadBg cGalleryEmbed_imageComment ipsType_center'>
						<a href='{$url}' title='{$item->caption}' style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), \IPS\File::get( 'gallery_Images', $item->medium_file_name )->url )"}" )'>
							<img src='{file="$item->medium_file_name" extension="gallery_Images"}' alt='{$item->caption}' class='ipsHide'>
						</a>
					</div>
				{{else}}
					<div class='cGalleryEmbed ipsNoThumb ipsNoThumb_video'>&nbsp;</div>
				{{endif}}
				<div class='ipsPad'>
					{template="embedOriginalItem" group="embed" app="core" params="$item"}
				</div>
			</div>
		</div>

		<div class='ipsType_richText ipsType_medium' data-truncate='3'>
			{$comment->truncated(TRUE)|raw}
		</div>

		{{if \IPS\IPS::classUsesTrait( $comment, 'IPS\Content\Reactable' ) and count( $comment->reactions() ) and settings.reputation_enabled}}
			<ul class='ipsList_inline ipsSpacer_top ipsSpacer_half'>
				<li>
					{template="reactionOverview" app="core" group="global" params="$comment, TRUE, 'small'"}
				</li>
			</ul>
		{{endif}}
	</div>
</div>]]></template>
 <template template_group="global" template_name="embedImageReview" template_data="$comment, $item, $url" template_location="front" template_app="gallery"><![CDATA[
<div data-embedInfo-maxSize='500' class='ipsRichEmbed'>
	{template="embedHeader" group="embed" app="core" params="$comment, \IPS\Member::loggedIn()->language()->addToStack( 'x_reviewed_photo', FALSE, array( 'sprintf' => array( $comment->author()->name ) ) ), $comment->mapped('date'), $url"}
	<div class='ipsPad'>
		<div class='ipsRichEmbed_originalItem ipsAreaBackground_reset ipsSpacer_bottom ipsType_blendLinks'>
			<div>
				{{if $item->medium_file_name}}
					<div class='ipsRichEmbed_masthead ipsRichEmbed_mastheadBg cGalleryEmbed_imageComment ipsType_center'>
						<a href='{$url}' title='{$item->caption}' style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), \IPS\File::get( 'gallery_Images', $item->medium_file_name )->url )"}" )'>
							<img src='{file="$item->medium_file_name" extension="gallery_Images"}' alt='{$item->caption}' class='ipsHide'>
						</a>
					</div>
				{{else}}
					<div class='cGalleryEmbed ipsNoThumb ipsNoThumb_video'>&nbsp;</div>
				{{endif}}
				<div class='ipsPad'>
					{template="embedOriginalItem" group="embed" app="core" params="$item"}
				</div>
			</div>
		</div>

		{template="rating" app="core" params="'veryLarge', $comment->mapped('rating')" group="global"} 
		{{if $comment->mapped('votes_total')}}
			<p class='ipsType_reset ipsType_medium'>{$comment->helpfulLine()|raw}</p>
		{{endif}}
		<hr class='ipsHr'>
		<div class='ipsType_richText ipsType_medium ipsSpacer_top ipsSpacer_half' data-truncate='3'>
			{$comment->truncated(TRUE)|raw}
		</div>

		{{if \IPS\IPS::classUsesTrait( $comment, 'IPS\Content\Reactable' ) and count( $comment->reactions() ) and settings.reputation_enabled}}
			<ul class='ipsList_inline ipsSpacer_top ipsSpacer_half'>
				<li>
					{template="reactionOverview" app="core" group="global" params="$comment, TRUE, 'small'"}
				</li>
			</ul>
		{{endif}}
	</div>
</div>]]></template>
 <template template_group="global" template_name="link" template_data="$image" template_location="global" template_app="gallery"><![CDATA[<div class='ipsContained ipsType_break'><a href="{$image->url()}" class="ipsType_blendLinks" target="_blank">{$image->caption}</a></div>]]></template>
 <template template_group="global" template_name="manageFollowNodeRow" template_data="$table, $headers, $rows" template_location="front" template_app="gallery"><![CDATA[{{foreach $rows as $row}}
	{{$contentItemClass = $row::$contentItemClass;}}
	<li class="ipsDataItem {{if $contentItemClass::containerUnread( $row )}}ipsDataItem_unread{{endif}} {{if method_exists( $row, 'tableClass' ) && $row->tableClass()}}ipsDataItem_{$row->tableClass()}{{endif}}" data-controller='core.front.system.manageFollowed' data-followID='{$row->_followData['follow_area']}-{$row->_followData['follow_rel_id']}'>
		<div class='ipsDataItem_generic ipsDataItem_size3'>
			{{if $coverImage = $row->coverPhoto('small') }}
				<span class='ipsThumb_bg ipsThumb_small ipsPos_left' style='background-image: url("{$coverImage}")'>
					<img src='{$coverImage}' alt='' class="">
				</span>
			{{else}}
				<span class='ipsNoThumb ipsThumb_small ipsPos_left'></span>
			{{endif}}
		</div>
		<div class='ipsDataItem_main'>
			<h4 class='ipsType_sectionHead'>
				{{if $row->_locked}}
					<i class="fa fa-lock"></i>
				{{endif}}
				
				<a href='{$row->url()}'>
					{$row->_title}
				</a>
			</h4>
			<div class='ipsDataItem_meta ipsType_light' data-ipsTruncate data-ipsTruncate-size='2 lines' data-ipsTruncate-type='remove'>
				{$row->_description}
			</div>
			<ul class='ipsList_inline ipsType_light'>
				{{if $row->_items}}
					<li>{lang="node_content_items" pluralize="$row->_items"}</li>
				{{endif}}
				{{if $row->_comments}}
					<li>{lang="node_content_comments" pluralize="$row->_comments"}</li>
				{{endif}}
				{{if $row->_reviews}}
					<li>{lang="node_content_reviews" pluralize="$row->_reviews"}</li>
				{{endif}}
			</ul>

			{{if count( $row->_latestImages )}}
				<ul class='ipsList_inline cGalleryManagedAlbumThumbs'>
					{{foreach array_slice( iterator_to_array( $row->_latestImages ), 0, 10, true ) as $image }}
						<li>
							<a href='{$image->url()}'>
								<span class='ipsThumb_bg ipsThumb_small ipsPos_left' style='background-image: url("{file="$image->medium_file_name" extension="gallery_Images"}")'>
									<img src='{file="$image->medium_file_name" extension="gallery_Images"}' alt='' class="">
								</span>
							</a>
						</li>
					{{endforeach}}
				</ul>
			{{endif}}
		</div>
		
		<div class='ipsDataItem_generic ipsDataItem_size1 ipsType_center ipsType_large'>
			<span class='ipsBadge ipsBadge_icon ipsBadge_new {{if !$row->_followData['follow_is_anon']}}ipsHide{{endif}}' data-role='followAnonymous' data-ipsTooltip title='{lang="follow_is_anon"}'><i class='fa fa-eye-slash'></i></span>
		</div>

		<div class='ipsDataItem_generic ipsDataItem_size6'>
			<ul class='ipsList_reset'>
				<li title='{lang="follow_when"}' data-role='followDate'><i class='fa fa-clock-o'></i> {datetime="$row->_followData['follow_added']"}</li>
				<li title='{lang="follow_how"}' data-role='followFrequency'>
					{{if $row->_followData['follow_notify_freq'] == 'none'}}
						<i class='fa fa-bell-slash-o'></i>
					{{else}}
						<i class='fa fa-bell'></i>
					{{endif}} {lang="follow_freq_{$row->_followData['follow_notify_freq']}"}
				</li>
			</ul>
		</div>

		<div class='ipsDataItem_generic ipsDataItem_size6 ipsType_center'>
			{template="manageFollow" group="system" app="core" params="$row->_followData['follow_app'], $row->_followData['follow_area'], $row->_followData['follow_rel_id']"}
		</div>

		{{if $table->canModerate()}}
			<div class='ipsDataItem_modCheck'>
				<span class='ipsCustomInput'>
					<input type='checkbox' data-role='moderation' name="moderate[{$row->_id}]" data-actions="{expression="implode( ' ', $table->multimodActions( $row ) )"}" data-state=''>
					<span></span>
				</span>
			</div>
		{{endif}}
	</li>
{{endforeach}}]]></template>
 <template template_group="global" template_name="manageFollowRow" template_data="$table, $headers, $rows, $includeFirstCommentInCommentCount=TRUE" template_location="front" template_app="gallery"><![CDATA[{{if count( $rows )}}
	{{foreach $rows as $row}}
	{{$idField = $row::$databaseColumnId;}}
		<li class="ipsDataItem ipsDataItem_responsivePhoto {{if $row->unread()}}ipsDataItem_unread{{endif}} {{if method_exists( $row, 'tableClass' ) && $row->tableClass()}}ipsDataItem_{$row->tableClass()}{{endif}} {{if $row->hidden()}}ipsModerated{{endif}}" data-controller='core.front.system.manageFollowed' data-followID='{$row->_followData['follow_area']}-{$row->_followData['follow_rel_id']}'>
			<div class='ipsDataItem_generic ipsDataItem_size2 ipsDataItem_imageColumn'>
				<div class='ipsThumb ipsThumb_bg ipsThumb_small' style='background-image: url( {expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), \IPS\File::get( 'gallery_Images', $row->medium_file_name )->url )"} )'></div>
			</div>
			<div class='ipsDataItem_main ipsPos_middle'>
				<h4 class='ipsDataItem_title ipsContained_container'>
					{{if $row->mapped('locked')}}
						<span><i class="fa fa-lock"></i></span>
					{{endif}}

					{{if $row->mapped('pinned') || $row->mapped('featured') || $row->hidden() === -1 || $row->hidden() === 1}}
						<span>
							{{if $row->hidden() === -1}}
								<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning" data-ipsTooltip title='{$row->hiddenBlurb()}'><i class='fa fa-eye-slash'></i></span>
							{{elseif $row->hidden() === 1}}
								<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning" data-ipsTooltip title='{lang="pending_approval"}'><i class='fa fa-warning'></i></span>
							{{endif}}							
							{{if $row->mapped('pinned')}}
								<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive" data-ipsTooltip title='{lang="pinned"}'><i class='fa fa-thumb-tack'></i></span>
							{{endif}}
							{{if $row->mapped('featured')}}
								<span class="ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive" data-ipsTooltip title='{lang="featured"}'><i class='fa fa-star'></i></span>
							{{endif}}
						</span>
					{{endif}}
					
					{{if $row->prefix()}}
						<span>{template="prefix" group="global" app="core" params="$row->prefix( TRUE ), $row->prefix()"}</span>
					{{endif}}
					
					<span class='ipsContained ipsType_break'>
						<a href='{$row->url()}'>
							{{if $row->mapped('title')}}{$row->mapped('title')}{{else}}<em class="ipsType_light">{lang="content_deleted"}</em>{{endif}}
						</a>
					</span>
				</h4>
				<div class='ipsDataItem_meta ipsType_light ipsType_blendLinks' data-ipsTruncate data-ipsTruncate-size='2 lines' data-ipsTruncate-type='remove'>
					{{if method_exists( $row, 'tableDescription' )}}
						{$row->tableDescription()|raw}
					{{else}}
                        {lang="byline" htmlsprintf="$row->author()->link( $row->warningRef() )"}{datetime="$row->__get( $row::$databaseColumnMap['date'] )"}
						{lang="in"} <a href="{$row->container()->url()}">{$row->container()->_title}</a>
					{{endif}}
				</div>				
			</div>

			<div class='ipsDataItem_generic ipsDataItem_size1 ipsType_center ipsType_large cFollowedContent_anon'>
				<span class='ipsBadge ipsBadge_icon ipsBadge_new {{if !$row->_followData['follow_is_anon']}}ipsHide{{endif}}' data-role='followAnonymous' data-ipsTooltip title='{lang="follow_is_anon"}'><i class='fa fa-eye-slash'></i></span>
			</div>

			<div class='ipsDataItem_generic ipsDataItem_size6 cFollowedContent_info'>
				<ul class='ipsList_reset'>
					<li title='{lang="follow_when"}' data-role='followDate'><i class='fa fa-clock-o'></i> {datetime="$row->_followData['follow_added']"}</li>
					<li title='{lang="follow_how"}' data-role='followFrequency'>
						{{if $row->_followData['follow_notify_freq'] == 'none'}}
							<i class='fa fa-bell-slash-o'></i>
						{{else}}
							<i class='fa fa-bell'></i>
						{{endif}} {lang="follow_freq_{$row->_followData['follow_notify_freq']}"}
					</li>
				</ul>
			</div>

			<div class='ipsDataItem_generic ipsDataItem_size6 ipsType_center cFollowedContent_manage'>
				{template="manageFollow" group="system" app="core" params="$row->_followData['follow_app'], $row->_followData['follow_area'], $row->_followData['follow_rel_id']"}
			</div>

			{{if $table->canModerate()}}
				<div class='ipsDataItem_modCheck'>
					<span class='ipsCustomInput'>
						<input type='checkbox' data-role='moderation' name="moderate[{$row->$idField}]" data-actions="{expression="implode( ' ', $table->multimodActions( $row ) )"}" data-state='{{if $row->tableStates()}}{$row->tableStates()}{{endif}}'>
						<span></span>
					</span>
				</div>
			{{endif}}

		</li>
	{{endforeach}}
{{endif}}
]]></template>
 <template template_group="global" template_name="profileAlbumTable" template_data="$table, $headers, $rows, $quickSearch" template_location="front" template_app="gallery"><![CDATA[
<div data-baseurl='{$table->baseUrl}' data-resort='{$table->resortKey}' data-pageParam='albumPage' data-controller='core.global.core.table{{if $table->canModerate()}},core.front.core.moderation{{endif}}'>
	{{if $table->pages > 1}}
		<div data-role="tablePagination">
			{template="pagination" group="global" app="core" location="global" params="$table->baseUrl, $table->pages, $table->page, $table->limit, TRUE, 'albumPage'"}
		</div>
		<br>
	{{endif}}

	<ol class='ipsList_reset ipsClear ipsGrid ipsGrid_collapsePhone' data-role='tableRows' data-controller='gallery.front.browse.list' id='elTable_{$table->uniqueId}'>
		{template="$table->rowsTemplate[1]" params="$table, $headers, $rows" object="$table->rowsTemplate[0]"}
	</ol>
</div>]]></template>
 <template template_group="global" template_name="searchResultAlbumCommentSnippet" template_data="$indexData, $itemData, $images, $url, $reviewRating, $condensed" template_location="front" template_app="gallery"><![CDATA[{{if $condensed}}
	{{if count( $images )}}
		{{$firstImage = array_shift( $images );}}
		<span class='ipsThumb_bg ipsThumb_small ipsPos_left cGallerySearchAlbumThumb' style='background-image: url("{file="$firstImage->thumb_file_name" extension="gallery_Images"}")'>
			<img src='{file="$firstImage->thumb_file_name" extension="gallery_Images"}' alt='' class="">
		</span>
		<ul class='ipsList_inline cGallerySearchAlbumThumbs ipsType_noBreak'>
			{{foreach $images as $image }}
				<li>
					<a href='{$image->url()}'>
						<span class='ipsThumb_bg ipsThumb_small ipsPos_left' style='background-image: url("{file="$image->medium_file_name" extension="gallery_Images"}")'>
							<img src='{file="$image->medium_file_name" extension="gallery_Images"}' alt='' class="">
						</span>
					</a>
				</li>
			{{endforeach}}
		</ul>
	{{else}}
		<span class='ipsNoThumb ipsThumb_small ipsPos_left'></span>
	{{endif}}
{{else}}
	<div class='ipsColumns ipsColumns_collapsePhone ipsColumns_noSpacing'>
		<div class='ipsColumn ipsColumn_narrow ipsType_center'>
			<a href='{$url}' title='{lang="view_this_album" sprintf="$itemData['album_name']"}'>
				{{if count( $images )}}
					{{$firstImage = array_shift( $images );}}
					<img src='{file="$firstImage->thumb_file_name" extension="gallery_Images"}' alt='' class="ipsImage ipsStream_thumbnail ipsStream_thumbnailSmall">
				{{else}}
					<div class='ipsThumb_small ipsNoThumb'></div>
				{{endif}}
			</a>
		</div>
		<div class='ipsColumn ipsColumn_fluid'>
			<div class='ipsStream_comment ipsPad'>
				{{if $reviewRating !== NULL}}
					{template="rating" app="core" params="'medium', $reviewRating" group="global"}
				{{endif}}
				{{if trim( $indexData['index_content'] ) !== ''}}
					<div class='ipsType_richText ipsType_break ipsType_medium' {{if !( \IPS\Dispatcher::i()->application->directory == 'core' and \IPS\Dispatcher::i()->module and \IPS\Dispatcher::i()->module->key == 'search' )}}data-ipsTruncate data-ipsTruncate-type='remove' data-ipsTruncate-size='3 lines' data-ipsTruncate-watch='false'{{else}}data-searchable data-findTerm{{endif}}>
						{$indexData['index_content']|raw}
					</div>
				{{endif}}
			</div>
			<ul class='ipsList_inline cGallerySearchAlbumThumbs cGallerySearchExpanded ipsType_noBreak ipsSpacer_top'>
				{{foreach $images as $image }}
					<li>
						<a href='{$image->url()}'>
							<span class='ipsThumb_bg ipsThumb_small ipsPos_left' style='background-image: url("{file="$image->medium_file_name" extension="gallery_Images"}")'>
								<img src='{file="$image->medium_file_name" extension="gallery_Images"}' alt='' class="">
							</span>
						</a>
					</li>
				{{endforeach}}
			</ul>
		</div>
	</div>
{{endif}}]]></template>
 <template template_group="global" template_name="searchResultAlbumSnippet" template_data="$indexData, $itemData, $images, $url, $condensed" template_location="front" template_app="gallery"><![CDATA[{{if $condensed}}
	{{if count( $images )}}
		{{$firstImage = array_shift( $images );}}
		<a href='{$firstImage->url()}'>
			<span class='ipsThumb_bg ipsThumb_small ipsPos_left' style='background-image: url("{file="$firstImage->thumb_file_name" extension="gallery_Images"}")'>
				<img src='{file="$firstImage->thumb_file_name" extension="gallery_Images"}' alt='' class="">
			</span>
		</a>
		<ul class='ipsList_inline cGallerySearchAlbumThumbs ipsType_noBreak'>
			{{foreach $images as $image }}
				<li>
					<a href='{$image->url()}'>
						<span class='ipsThumb_bg ipsThumb_small ipsPos_left' style='background-image: url("{file="$image->medium_file_name" extension="gallery_Images"}")'>
							<img src='{file="$image->medium_file_name" extension="gallery_Images"}' alt='' class="">
						</span>
					</a>
				</li>
			{{endforeach}}
		</ul>
	{{else}}
		<span class='ipsNoThumb ipsThumb_small ipsPos_left'></span>
	{{endif}}
{{else}}
	<div class='ipsColumns ipsColumns_collapsePhone'>
		<div class='ipsColumn ipsColumn_fluid ipsStream_snippetInfo'>
			{{if trim( $indexData['index_content'] ) !== ''}}
				<div class='ipsType_richText ipsType_break ipsType_medium' {{if !( \IPS\Dispatcher::i()->application->directory == 'core' and \IPS\Dispatcher::i()->module and \IPS\Dispatcher::i()->module->key == 'search' )}}data-ipsTruncate data-ipsTruncate-type='remove' data-ipsTruncate-size='3 lines' data-ipsTruncate-watch='false'{{else}}data-searchable data-findTerm{{endif}}>
					{$indexData['index_content']|raw}
				</div>
			{{endif}}

			{{if count($images)}}
				<div class='cGalleryAlbums_recent'>
					<ul class='ipsList_reset'>
						{{foreach $images as $k => $image}}
							{{$imageKey = ( $k === 0 ) ? "medium_file_name" : "thumb_file_name";}}
							<li style='background-image: url( "{file="$image->$imageKey" extension="gallery_Images"}" );' class='cGalleryTrimmedImage'>
								<a href='{$image->url()}'>
									<img src='{file="$image->$imageKey" extension="gallery_Images"}' alt="{$image->caption}">
								</a>
							</li>
						{{endforeach}}
					</ul>
				</div>
			{{endif}}
		</div>
	</div>
{{endif}}]]></template>
 <template template_group="global" template_name="searchResultCommentSnippet" template_data="$indexData, $itemData, $image, $url, $reviewRating, $condensed" template_location="front" template_app="gallery"><![CDATA[{{if $condensed}}
	{{if $image}}
		<span class='ipsThumb_bg ipsThumb_small ipsPos_left' style='background-image: url("{file="$image" extension="gallery_Images"}")'>
			<img src='{file="$image" extension="gallery_Images"}' alt='' class="">
		</span>
	{{else}}
		<span class='ipsNoThumb ipsThumb_small ipsPos_left'></span>
	{{endif}}
{{else}}
	<div class='ipsColumns ipsColumns_collapsePhone ipsColumns_noSpacing'>
		<div class='ipsColumn ipsColumn_narrow ipsType_center'>
			<a href='{$url}' title='{lang="view_this_image" sprintf="$itemData['image_caption']"}'>
				{{if $image}}
					<img src='{file="$image" extension="gallery_Images"}' alt='' class="ipsImage ipsStream_thumbnail ipsStream_thumbnailSmall">
				{{else}}
					<div class='ipsNoThumb_medium ipsNoThumb'></div>
				{{endif}}
			</a>
		</div>
		<div class='ipsColumn ipsColumn_fluid'>
			<div class='ipsStream_comment ipsPad'>
				{{if $reviewRating !== NULL}}
					{template="rating" app="core" params="'medium', $reviewRating" group="global"}
				{{endif}}
				{{if trim( $indexData['index_content'] ) !== ''}}
					<div class='ipsType_richText ipsType_break ipsType_medium' {{if !( \IPS\Dispatcher::i()->application->directory == 'core' and \IPS\Dispatcher::i()->module and \IPS\Dispatcher::i()->module->key == 'search' )}}data-ipsTruncate data-ipsTruncate-type='remove' data-ipsTruncate-size='3 lines' data-ipsTruncate-watch='false'{{else}}data-searchable data-findTerm{{endif}}>
						{$indexData['index_content']|raw}
					</div>
				{{endif}}
			</div>
		</div>
	</div>
{{endif}}]]></template>
 <template template_group="global" template_name="searchResultImageSnippet" template_data="$indexData, $itemData, $albumData, $image, $url, $condensed" template_location="front" template_app="gallery"><![CDATA[{{if $condensed}}
	{{if $image}}
		<span class='ipsThumb_bg ipsThumb_small ipsPos_left' style='background-image: url("{file="$image" extension="gallery_Images"}")'>
			<img src='{file="$image" extension="gallery_Images"}' alt='' class="">
		</span>
	{{else}}
		<span class='ipsNoThumb ipsThumb_small ipsPos_left'></span>
	{{endif}}
{{else}}
	<div class='ipsColumns ipsColumns_collapsePhone'>
		<div class='ipsColumn ipsColumn_wide ipsType_center cGalleryStreamPreview'>
			<a href='{$url}' title='{lang="view_this_image" sprintf="$indexData['index_title']"}'>
				{{if $image}}
					<img src='{file="$image" extension="gallery_Images"}' alt='' class="ipsImage ipsStream_thumbnail">
				{{else}}
					<div class='ipsNoThumb'></div>
				{{endif}}
			</a>
		</div>
		<div class='ipsColumn ipsColumn_fluid ipsStream_snippetInfo'>
			{{if $albumData}}
				<p class='ipsType_reset ipsType_normal ipsType_light ipsSpacer_bottom ipsSpacer_half'>
					{lang="from_the_album"} <a href='{url="app=gallery&module=gallery&controller=browse&album={$albumData['album_id']}" seoTemplate="gallery_album" seoTitle="$albumData['album_name_seo']"}'>{$albumData['album_name']}</a>
				</p>
			{{endif}}
			{{if trim( $indexData['index_content'] ) !== ''}}
				<div class='ipsType_richText ipsType_break ipsType_medium' {{if !( \IPS\Dispatcher::i()->application->directory == 'core' and \IPS\Dispatcher::i()->module and \IPS\Dispatcher::i()->module->key == 'search' )}}data-ipsTruncate data-ipsTruncate-type='remove' data-ipsTruncate-size='3 lines' data-ipsTruncate-watch='false'{{else}}data-searchable data-findTerm{{endif}}>
					{$indexData['index_content']|raw}
				</div>
			{{endif}}

			{{if $itemData['image_copyright']}}
				<p class='ipsSpacer_top ipsType_light ipsType_medium ipsType_reset'>
					&copy; {$itemData['image_copyright']}
				</p>
			{{endif}}
		</div>
	</div>
{{endif}}]]></template>
 <template template_group="livesearch" template_name="category" template_data="$category" template_location="admin" template_app="gallery"><![CDATA[<li class='ipsPad_half ipsClearfix' data-role='result'>
	<a href='{url="app=gallery&module=gallery&controller=categories&do=form&id="}{$category->id}' class='ipsPos_left'>{$category->_title}</a>
</li>

]]></template>
 <template template_group="stats" template_name="graphs" template_data="$graph" template_location="admin" template_app="gallery"><![CDATA[{$graph|raw}
<div class="ipsPad_half ipsAreaBackground">
	{lang="gallery_graph_disclaimer"}
</div>]]></template>
 <template template_group="stats" template_name="information" template_data="$table" template_location="admin" template_app="gallery"><![CDATA[{$table|raw}
<br>
<div class="ipsPad_half ipsType_light">
	{lang="gallery_stats_disclaimer"}
</div>]]></template>
 <template template_group="stats" template_name="uploadersTable" template_data="$select, $pagination, $members" template_location="admin" template_app="gallery"><![CDATA[
{{if trim( $pagination )}}
	{$pagination|raw}
	<br><br>
{{endif}}

{{if count( $select )}}
	<table class="ipsTable ipsTable_zebra acpBlock">
		<thead>
			<tr>
				<th>{lang="member"}</th>
				<th>{lang="gallery_images"}</th>
			</tr>
		</thead>
		<tbody>
			{{foreach $select as $row}}
				{{if isset( $members[ $row['image_member_id'] ] )}}
					{{$member = \IPS\Member::constructFromData( $members[ $row['image_member_id'] ] );}}
				{{else}}
					{{$member = new \IPS\Member;}}
				{{endif}}
				<tr>
					<td>{template="userPhoto" app="core" group="global" params="$member"} {$member->name}</td>
					<td><a href='{$member->url()->setQueryString( array( 'do' => 'content', 'type' => 'gallery_image' ) )}' target='_blank'>{$row['images']}</a></td>
				</tr>
			{{endforeach}}
		</tbody>
	</table>
	<br>

	{$pagination|raw}
{{else}}
	<p class="ipsPad">{lang="no_results"}</p>
{{endif}}]]></template>
 <template template_group="submit" template_name="categorySelector" template_data="$form" template_location="front" template_app="gallery"><![CDATA[
{{if !\IPS\Request::i()->isAjax()}}
	{template="pageHeader" group="global" app="core" params="\IPS\Member::loggedIn()->language()->addToStack('choose_category')"}
{{else}}
	<div class='ipsPad'>
{{endif}}
	{$form|raw}
{{if \IPS\Request::i()->isAjax()}}
	</div>
{{endif}}]]></template>
 <template template_group="submit" template_name="chooseAlbum" template_data="$category, $createAlbumForm, $canCreateAlbum, $maximumAlbums, $existingAlbumForm" template_location="front" template_app="gallery"><![CDATA[<div data-controller='gallery.front.submit.chooseCategory' class='ipsType_center ipsSpacer_top ipsSpacer_double'>
	<h2 class='ipsType_reset ipsType_large ipsSpacer_bottom'>{lang="uploading_to_x" sprintf="$category->_title"}</h2>
	<form action="{url="app=gallery&module=gallery&controller=submit&chosenCategory={$category->_id}&noAlbum=1" seoTemplate="gallery_submit"}">
		<button type="submit" class="ipsButton ipsButton_primary">{lang="use_no_album"} <i class='fa fa-caret-right'></i></button>	
	</form>
	<div class="ipsSpacer_top ipsType_veryLarge">{lang="or"}</div>
</div>

<div class='ipsGrid ipsGrid_collapsePhone ipsPad cGallerySubmit_albumChoice'>
	<div class='ipsGrid_span6'>
		<h2 class='ipsType_pageTitle'>{lang="create_new_album"}</h2>
		<hr class='ipsHr'>
		{{if $createAlbumForm}}
			{$createAlbumForm|raw}
		{{elseif !$canCreateAlbum}}
			<p class='ipsType_light'>{lang="cannot_create_album"}</p>
		{{else}}
			<p class='ipsType_light'>{lang="used_max_albums" sprintf="$maximumAlbums"}</p>
		{{endif}}
	</div>
	<div class='ipsGrid_span6'>
		<h2 class='ipsType_pageTitle'>{lang="choose_existing_album"}</h2>
		<hr class='ipsHr'>
		{{if $existingAlbumForm}}
			{$existingAlbumForm|raw}
		{{else}}
			<p class='ipsType_light'>{lang="no_existing_albums"}</p>
		{{endif}}
	</div>
</div>]]></template>
 <template template_group="submit" template_name="chooseCategory" template_data="$id, $action, $elements, $hiddenValues, $actionButtons, $uploadField, $class='', $attributes=array(), $sidebar, $form=NULL" template_location="front" template_app="gallery"><![CDATA[<div data-controller='gallery.front.submit.chooseCategory' data-preselected-album="{expression="\IPS\Request::i()->album"}" class='cGallerySubmit_chooseCategory'>
	<form accept-charset='utf-8' class="ipsForm {$class}" action="{$action}" method="post" {{if $uploadField}}enctype="multipart/form-data"{{endif}} {{foreach $attributes as $k => $v}}{$k}="{$v}"{{endforeach}} data-ipsForm>
		<input type="hidden" name="{$id}_submitted" value="1">
		{{foreach $hiddenValues as $k => $v}}
			{{if is_array($v)}}
				{{foreach $v as $_k => $_v}}
					<input type="hidden" name="{$k}[{$_k}]" value="{$_v}">
				{{endforeach}}
			{{else}}
				<input type="hidden" name="{$k}" value="{$v}">
			{{endif}}
		{{endforeach}}
		<div class='ipsGrid ipsGrid_collapsePhone ipsPad cGallerySubmit_albumChoice'>
			<div class='ipsGrid_span12'>
				<h2 class='ipsType_pageTitle ipsType_center ipsSpacer_bottom'>{lang="choose_category"}</h2>
				{$elements['']['image_category']->html()|raw}
			</div>
		</div>
		<div class="ipsAreaBackground_light ipsClearfix ipsPad ipsType_center ipsJS_hide" data-role="continueCategory">
			{{foreach $actionButtons as $button}}
				{$button|raw}
			{{endforeach}}
		</div>
	</form>
</div>]]></template>
 <template template_group="submit" template_name="createAlbum" template_data="$id, $action, $elements, $hiddenValues, $actionButtons, $uploadField, $class='', $attributes=array(), $sidebar, $form=NULL" template_location="front" template_app="gallery"><![CDATA[<form accept-charset='utf-8' class="ipsForm {$class}" action="{$action}" method="post" {{if $uploadField}}enctype="multipart/form-data"{{endif}} {{foreach $attributes as $k => $v}}{$k}="{$v}"{{endforeach}} data-ipsForm>
	<input type="hidden" name="{$id}_submitted" value="1">
	{{foreach $hiddenValues as $k => $v}}
		{{if is_array($v)}}
			{{foreach $v as $_k => $_v}}
				<input type="hidden" name="{$k}[{$_k}]" value="{$_v}">
			{{endforeach}}
		{{else}}
			<input type="hidden" name="{$k}" value="{$v}">
		{{endif}}
	{{endforeach}}
	{{if $uploadField}}
		<input type="hidden" name="MAX_FILE_SIZE" value="{$uploadField}">
		<input type="hidden" name="plupload" value="{expression="md5( uniqid() )"}">
	{{endif}}
	<ul class='ipsList_reset'>
		{{foreach $elements as $collection}}
			{{foreach $collection as $inputName => $input}}
				{{if in_array( $inputName, array( 'album_name', 'album_description' ) )}}
					{{if is_object( $input ) }}
						{$input->rowHtml($form)|raw}
					{{else}}
						{$input|raw}
					{{endif}}
				{{endif}}
			{{endforeach}}
		{{endforeach}}
		<li class='ipsFieldRow' id='elAlbumExtrasRow'>
			<ul class='ipsList_inline ipsSpacer_top ipsType_medium'>
				{{if isset( $elements['']['set_album_owner'] ) && count( $elements['']['set_album_owner']->options['options'] > 1 )}}
					<li>
						<a href='#elAlbumCreate_owner_menu' id='elAlbumCreate_owner' data-ipsMenu data-ipsMenu-appendTo='#elAlbumExtrasRow' data-ipsMenu-closeOnClick='false'>{lang="album_create_owner"} <i class='fa fa-caret-down'></i></a>
					</li>
				{{endif}}
				{{if isset( $elements['']['album_type'] ) && count( $elements['']['album_type']->options['options'] ) > 1}}
					<li>
						<a href='#elAlbumCreate_privacy_menu' id='elAlbumCreate_privacy' data-ipsMenu data-ipsMenu-appendTo='#elAlbumExtrasRow' data-ipsMenu-closeOnClick='false'>{lang="album_create_privacy"} <i class='fa fa-caret-down'></i></a>
					</li>
				{{endif}}
				{{if isset( $elements['']['album_sort_options'] ) || isset( $elements['']['album_allow_comments'] ) || isset( $elements['']['album_allow_reviews'] ) || isset( $elements['']['album_use_comments'] ) || isset( $elements['']['album_use_reviews'] )}}
					<li><a href='#elAlbumCreate_features_menu' id='elAlbumCreate_features' data-ipsMenu data-ipsMenu-appendTo='#elAlbumExtrasRow' data-ipsMenu-closeOnClick='false'>{lang="album_create_features"} <i class='fa fa-caret-down'></i></a></li>
				{{endif}}
			</ul>
		</li>
		{{foreach $actionButtons as $button}}
			<li class='ipsFieldRow'>
				{$button|raw}
			</li>
		{{endforeach}}		
	</ul>
	<div id='elAlbumCreate_features_menu' class='ipsMenu ipsMenu_wide ipsHide'>
		<div class='ipsPad'>
			<ul class='ipsForm ipsForm_horizontal'>
				{{foreach array( 'album_sort_options', 'album_allow_comments', 'album_allow_reviews', 'album_use_comments', 'album_use_reviews' ) as $inputName}}
					{{if isset( $elements[''][ $inputName ] )}}
						{{if is_object( $elements[''][ $inputName ] ) }}
							{$elements[''][ $inputName ]->rowHtml($form)|raw}
						{{else}}
							{$elements[''][ $inputName ]|raw}
						{{endif}}
					{{endif}}
				{{endforeach}}
			</ul>
		</div>
	</div>
	<div id='elAlbumCreate_privacy_menu' class='ipsMenu ipsMenu_wide ipsHide'>
		<div class='ipsPad'>
			<ul class='ipsForm ipsForm_horizontal'>
				{{foreach array( 'album_type', 'album_allowed_access' ) as $inputName}}
					{{if isset( $elements[''][ $inputName ] )}}
						{$elements[''][ $inputName ]->html()|raw}
					{{endif}}
				{{endforeach}}
			</ul>
		</div>
	</div>
	<div id='elAlbumCreate_owner_menu' class='ipsMenu ipsMenu_wide ipsHide'>
		<div class='ipsPad'>
			<ul class='ipsForm ipsForm_vertical'>
				{{foreach array( 'set_album_owner', 'album_owner' ) as $inputName}}
					{{if isset( $elements[''][ $inputName ] )}}
						{$elements[''][ $inputName ]->rowHtml()|raw}
					{{endif}}
				{{endforeach}}
			</ul>
		</div>
	</div>
</form>]]></template>
 <template template_group="submit" template_name="existingAlbumForm" template_data="$category, $id, $action, $elements, $hiddenValues, $actionButtons, $uploadField, $class='', $attributes=array(), $sidebar, $form=NULL" template_location="front" template_app="gallery"><![CDATA[
{{$existingAlbums = \IPS\gallery\Album::loadByOwner( NULL, array( array( 'album_category_id=?', $category->id ) ) );}}

<form accept-charset='utf-8' class="ipsForm {$class}" action="{$action}" method="post" {{if $uploadField}}enctype="multipart/form-data"{{endif}} {{foreach $attributes as $k => $v}}{$k}="{$v}"{{endforeach}} data-ipsForm data-controller='gallery.front.submit.existingAlbums'>
	<input type="hidden" name="{$id}_submitted" value="1">
	{{foreach $hiddenValues as $k => $v}}
		{{if is_array($v)}}
			{{foreach $v as $_k => $_v}}
				<input type="hidden" name="{$k}[{$_k}]" value="{$_v}">
			{{endforeach}}
		{{else}}
			<input type="hidden" name="{$k}" value="{$v}">
		{{endif}}
	{{endforeach}}
	<ul id='elGallerySubmit_albumChooser' class='ipsScrollbar ipsList_reset ipsSpacer_bottom'>
		{{foreach $elements['']['existing_album']->options['options'] as $optionID => $option}}
			{{$album = $existingAlbums[ $optionID ];}}
			<li>
				<input type='radio' name='existing_album' value='{$optionID}' class='ipsJS_hide' {{if $optionID == $elements['']['existing_album']->value}}checked{{endif}}>
				<div class='ipsAreaBackground_light ipsPad_half ipsClearfix {{if $elements['']['existing_album']->value == $optionID}}cAlbumSelected{{endif}}'>
					<div style='background-image: url( {expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), $album->coverPhoto( 'small' ) )"} );' class='cGallerySubmit_albumImage cGalleryTrimmedImage {{if \IPS\Member::loggedIn()->group['g_img_album_limit'] && $album->count_imgs >= \IPS\Member::loggedIn()->group['g_img_album_limit']}}ipsFaded{{endif}}'>
						<img src='{$album->coverPhoto( 'small' )}' alt='{$album->_title}'>
					</div>
					<div class='cGallerySubmit_albumInfo'>
						<p class='ipsType_reset ipsType_normal ipsContained_container'><strong class="ipsContained ipsType_break">{$album->_title}</strong></p>
						<ul class='ipsList_inline ipsType_medium ipsType_light'>
							<li><i class='fa fa-camera'></i> {lang="num_images" pluralize="$album->count_imgs"}</li>
							{{if \IPS\Member::loggedIn()->group['g_img_album_limit']}}
								<li>
									{{if $album->count_imgs >= \IPS\Member::loggedIn()->group['g_img_album_limit']}}
										{lang="album_full_desc"}
									{{else}}
										{lang="x_more_images_album" pluralize="( \IPS\Member::loggedIn()->group['g_img_album_limit'] - $album->count_imgs )"}
									{{endif}}
								</li>
							{{endif}}
						</ul>
					</div>
				</div>
			</li>
		{{endforeach}}
	</ul>
	<div class='ipsType_right'>
		<button type='submit' class='ipsButton ipsButton_medium ipsButton_primary'>{lang="choose_selected_album"}</button>
	</div>
</form>
]]></template>
 <template template_group="submit" template_name="existingAlbums" template_data="$category, $existingAlbumForm" template_location="front" template_app="gallery">
{$existingAlbumForm|raw}</template>
 <template template_group="submit" template_name="imageInformation" template_data="$images, $currentlyEditing, $currentImagePane, $allImagesForm" template_location="front" template_app="gallery"><![CDATA[
<a id='elImageInfo'></a>
<div data-controller='gallery.front.submit.main'>
	<div class='cGallerySubmit_infoPanel'>
		<div class='cGallerySubmit_strip ipsPad_double ipsAreaBackground_light ipsScrollbar ipsScrollbar_light' data-role='imageSlider'>
			<ul class='ipsList_reset'>
				{{foreach $images as $idx => $image}}
					<li class="{{if $currentlyEditing == $idx}}cGallerySubmit_current{{elseif $image->done}}cGallerySubmit_done{{endif}}" data-index='{$idx}'  data-role='imageThumb'>
						{{if $image->movie}}
							<div {{if $image->attachmentThumbnailUrl}}style="background-image: url( {expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), $image->attachmentThumbnailUrl )"} );"{{endif}} class="cGalleryTrimmedImage cGalleryMovieThumb ipsNoThumb ipsNoThumb_video">
								<a href="{url="app=gallery&module=gallery&controller=submit&type=images&edit={$idx}&_step=image_information" seoTemplate="gallery_submit"}">
									{{if $image->attachmentThumbnailUrl}}
										<img src="{$image->attachmentThumbnailUrl}" alt=''>
									{{else}}
										&nbsp;
									{{endif}}
								</a>
							</div>
						{{else}}
							<div style="background-image: url( {expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), $image->url )"} );" class="cGalleryTrimmedImage">
								<a href="{url="app=gallery&module=gallery&controller=submit&type=images&edit={$idx}&_step=image_information" seoTemplate="gallery_submit"}">
									<img src="{$image->url}" alt=''>
								</a>
							</div>
						{{endif}}
					</li>
				{{endforeach}}
			</ul>
		</div>
		<div class='cGallerySubmit_infoForm ipsPad_double ipsScrollbar' data-role="infoPanel">
			<section data-role='editForm'>
				{$currentImagePane|raw}
			</section>
		</div>
	</div>

	{$allImagesForm|raw}
</div>]]></template>
 <template template_group="submit" template_name="imageInformationDone" template_data="$images=array(), $category, $album=NULL" template_location="front" template_app="gallery"><![CDATA[
<div class='cGallerySubmit_finished ipsType_center'>
	<br><br>
	<i class='fa fa-check-circle ipsType_huge ipsType_light'></i>
	<p class='ipsType_pageTitle ipsType_light'>{lang="ready_to_submit"}</p>
	<p class='ipsType_reset ipsType_large ipsType_light'>{lang="ready_to_submit_blurb"}</p>
</div>]]></template>
 <template template_group="submit" template_name="imageInformationForm" template_data="$id, $action, $elements, $hiddenValues, $actionButtons, $uploadField, $class='', $attributes=array(), $sidebar, $form=NULL" template_location="front" template_app="gallery"><![CDATA[<form accept-charset='utf-8' class="ipsForm {$class}" action="{$action}" method="post" {{if $uploadField}}enctype="multipart/form-data"{{endif}} {{foreach $attributes as $k => $v}}{$k}="{$v}"{{endforeach}} data-ipsForm>
	<input type="hidden" name="{$id}_submitted" value="1">
	{{foreach $hiddenValues as $k => $v}}
		{{if is_array($v)}}
			{{foreach $v as $_k => $_v}}
				<input type="hidden" name="{$k}[{$_k}]" value="{$_v}">
			{{endforeach}}
		{{else}}
			<input type="hidden" name="{$k}" value="{$v}">
		{{endif}}
	{{endforeach}}
	{{if $uploadField}}
		<input type="hidden" name="MAX_FILE_SIZE" value="{$uploadField}">
		<input type="hidden" name="plupload" value="{expression="md5( uniqid() )"}">
	{{endif}}
	<ul class='ipsList_reset'>
		{{foreach $elements as $collection}}
			{{foreach $collection as $k => $input}}
				{{if mb_stripos( $k, 'image_credit_info' ) !== FALSE || mb_stripos( $k, 'image_copyright' ) !== FALSE}}
					<li class='ipsFieldRow ipsFieldRow_fullWidth ipsJS_hide' data-role='{expression="mb_stripos( $k, 'image_credit_info' ) !== FALSE ? 'image_credit_info' : 'image_copyright'"}'>
						<label class='ipsFieldRow_title'>{lang="$k"}</label>
						{$input->html()|raw}
					</li>
				{{elseif mb_stripos( $k, 'image_title' ) !== FALSE}}	
					<li class='ipsFieldRow ipsFieldRow_primary ipsFieldRow_fullWidth' data-role="captionRow">
						<label class='ipsFieldRow_title'>{lang="$k"} <a data-ipsHover data-ipsHover-onClick="true" data-ipsHover-content="#captionHelp" href='#'><i class='fa fa-question-circle'></i></a></label>
						{$input->html()|raw}
					</li>
				{{else}}
					{{if is_object( $input ) }}
						{$input->rowHtml($form)|raw}
					{{else}}
						{$input|raw}
					{{endif}}
				{{endif}}
			{{endforeach}}
		{{endforeach}}
	</ul>
	<ul class='ipsList_inline ipsSpacer_top ipsType_normal ipsJS_show'>
		<li><a href='#' data-action='addCopyright' data-opens='image_copyright'><i class='fa fa-plus'></i> {lang="add_copyright_image"}</a></li>
		<li><a href='#' data-action='addCredit' data-opens='image_credit_info'><i class='fa fa-plus'></i> {lang="add_credit_image"}</a></li>
	</ul>

	{{if $hiddenValues['edit'] != 0}}
		<button type='submit' data-role='saveAndDoPrev' class='cGallerySubmit_button cGallerySubmit_prevButton' name='submitButton' value='prev'><i class='fa fa-angle-left'></i></button>
	{{endif}}
	<button type='submit' data-role='saveAndDoNext' class='cGallerySubmit_button cGallerySubmit_nextButton' name='submitButton' value='next'><i class='fa fa-angle-right'></i></button>
</form>
<div id='captionHelp' class='ipsHide ipsPad'>
	{lang="upload_percn_help"}
</div>]]></template>
 <template template_group="submit" template_name="imageInformationWrapper" template_data="$form, $itemCount, $currentIndex" template_location="front" template_app="gallery"><![CDATA[
<div data-controller='gallery.front.submit.imageInfo' data-index='{$currentIndex}'>
	<h3 class='ipsType_pageTitle ipsSpacer_bottom' data-ipsSticky>{lang="editing_image"} <span class='ipsType_light'>({lang="x_of_y" sprintf="$currentIndex + 1, $itemCount"})</span></h3>
	<hr class='ipsHr'>
	{expression="$form->customTemplate( array( call_user_func_array( array( \IPS\Theme::i(), 'getTemplate' ), array( 'submit', 'gallery' ) ), 'imageInformationForm' ) )" raw="true"}
</div>]]></template>
 <template template_group="submit" template_name="processing" template_data="$redirector" template_location="front" template_app="gallery"><![CDATA[
<div class='ipsPad ipsPad_double'>
	<h1 class='ipsType_veryLarge ipsType_center'>{lang="saving_images"}</h1>
	<p class='ipsType_large ipsType_center ipsSpacer_bottom'>{lang="saving_images_desc"}</p>

	{$redirector|raw}
</div>]]></template>
 <template template_group="submit" template_name="submitBar" template_data="$id, $action, $elements, $hiddenValues, $actionButtons, $uploadField, $class='', $attributes=array(), $sidebar, $form=NULL" template_location="front" template_app="gallery"><![CDATA[
<form accept-charset='utf-8' class="ipsForm {$class}" action="{$action}" method="post" {{if $uploadField}}enctype="multipart/form-data"{{endif}} {{foreach $attributes as $k => $v}}{$k}="{$v}"{{endforeach}} data-ipsForm data-role="allImagesForm">
	<input type="hidden" name="{$id}_submitted" value="1">
	{{foreach $hiddenValues as $k => $v}}
		{{if is_array($v)}}
			{{foreach $v as $_k => $_v}}
				<input type="hidden" name="{$k}[{$_k}]" value="{$_v}">
			{{endforeach}}
		{{else}}
			<input type="hidden" name="{$k}" value="{$v}">
		{{endif}}
	{{endforeach}}
	{{if $uploadField}}
		<input type="hidden" name="MAX_FILE_SIZE" value="{$uploadField}">
		<input type="hidden" name="plupload" value="{expression="md5( uniqid() )"}">
	{{endif}}
	<div class='ipsAreaBackground ipsPad cGallerySubmit_bottomBar' id='elGallerySubmit_bottomBar'>
		<ul class='ipsList_inline'>
			<li>
				<a href='#' class='ipsButton ipsButton_veryLight ipsButton_large ipsTruncate ipsTruncate_line' id='elCopyrightMenu' data-ipsMenu data-ipsMenu-appendTo='#elGallerySubmit_bottomBar' data-ipsMenu-above='true' data-ipsMenu-closeOnClick='false'>{lang="set_copyright_all"} <i class='fa fa-caret-up'></i></a>
			</li>
			<li>
				<a href='#' class='ipsButton ipsButton_veryLight ipsButton_large ipsTruncate ipsTruncate_line' id='elCreditMenu' data-ipsMenu data-ipsMenu-appendTo='#elGallerySubmit_bottomBar' data-ipsMenu-above='true' data-ipsMenu-closeOnClick='false'>{lang="set_credit_all"} <i class='fa fa-caret-up'></i></a>
			</li>
			<li>
				{$elements['']['image_auto_follow']->html()|raw} <label for='check_image_auto_follow'>{lang="new_image_comments_notification"}</label>
			</li>
			<li class='ipsPos_right'>
				<button type='submit' class='ipsButton ipsButton_primary ipsButton_large' data-action='finish'><i class='fa fa-check'></i> {lang="image_info_finish"}</button>
			</li>
			<li class='ipsPos_right'>
				<button type='button' class='ipsButton ipsButton_veryLight ipsButton_large' data-action='finishAndCopy'><i class='fa fa-clone'></i> {lang="image_info_finishcopy"}</button>
			</li>
		</ul>
	</div>

	<div class='ipsMenu ipsMenu_wide ipsPad ipsHide' id='elCopyrightMenu_menu'>
		<h3 class='ipsType_sectionHead'>{lang="copyright"}</h3>
		<p class='ipsType_reset ipsSpacer_bottom'>{lang="set_copyright_desc"}</p>

		{$elements['']['image_copyright']->html()|raw}
	</div>

	<div class='ipsMenu ipsMenu_wide ipsPad ipsHide' id='elCreditMenu_menu'>
		<h3 class='ipsType_sectionHead'>{lang="credit"}</h3>
		<p class='ipsType_reset ipsSpacer_bottom'>{lang="credit_desc"}</p>

		{$elements['']['image_credit_info']->html()|raw}
	</div>
</form>
]]></template>
 <template template_group="submit" template_name="uploadImages" template_data="$form, $category" template_location="front" template_app="gallery"><![CDATA[
<div class='cGallerySubmit_uploadImages ipsPad_double' data-controller='gallery.front.submit.uploadImages'>
	{{if $form->error}}
		<div class="ipsMessage ipsMessage_error ipsSpacer_bottom">
			{$form->error}
		</div>
	{{endif}}
	<form accept-charset='utf-8' method="post" action="{$form->action}" id='elGallerySubmit' enctype="multipart/form-data">
		<div class='cGallerySubmit_uploadForm ipsPad_double'>
			<input type="hidden" name="{$form->id}_submitted" value="1">
			{{foreach $form->hiddenValues as $k => $v}}
				<input type="hidden" name="{$k}" value="{$v}">
			{{endforeach}}

			<div id='elGallerySubmit_imageUploader' class='ipsClear'>
				{$form->elements['']['images']->html( $form )|raw}
				{{if $form->elements['']['images']->error}}
					<br>
					<span class="ipsType_warning">{lang="$form->elements['']['images']->error"}</span>
				{{endif}}
				<button type='button' class='ipsButton ipsButton_veryLight ipsButton_verySmall ipsHide' data-action='uploadMore'>{lang="upload_more_images"}</button>
			</div>
		</div>

		<div class='cGallerySubmit_bottomBar ipsAreaBackground_light ipsPad ipsClearfix ipsType_right'>
			<span data-role='imageErrors' class='ipsHide ipsType_negative'><i class='fa fa-warning'></i> {lang="files_had_errors"}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
			<button type='button' class='ipsButton ipsButton_large ipsButton_important ipsHide' data-role='addFiles'>{lang="add_more_images"}</button>
			<button type='submit' class='ipsButton ipsButton_large ipsButton_primary' data-role='submitForm'>{lang="continue"}</button>
		</div>
	</form>
</div>]]></template>
 <template template_group="submit" template_name="wizardForm" template_data="$stepNames, $activeStep, $output, $baseUrl, $showSteps" template_location="front" template_app="gallery"><![CDATA[
{{foreach $stepNames as $step => $name}}
	{{if $activeStep == $name}}
		{$output|raw}
	{{endif}}
{{endforeach}}]]></template>
 <template template_group="submit" template_name="wizardWrapper" template_data="$stepNames, $activeStep, $output, $baseUrl, $showSteps" template_location="front" template_app="gallery"><![CDATA[
{{if !request.isAjax()}}
	<h1 class='ipsType_sectionTitle ipsType_reset'>{lang="add_gallery_image"}</h1>
{{endif}}
<div data-controller='gallery.front.submit.wizard'>
	<div class='cGalleryDialog_header ipsType_center ipsPad ipsAreaBackground'>
		<ul class='ipsList_reset cGallerySteps'>
			{{$doneSteps = TRUE;}}
			{{foreach $stepNames as $step => $name}}
				{{if $activeStep == $name}}{{$doneSteps = FALSE;}}{{endif}}
				<li data-step='{expression="$step + 1"}' data-stepName='{$name}' class='{{if $doneSteps}}cGallerySteps_done{{elseif $activeStep == $name}}cGallerySteps_active{{endif}}'>
					{{if $doneSteps}}
						<a href="{$baseUrl->setQueryString( '_step', $name )}" data-action="wizardLink">
					{{else}}
						<span>
					{{endif}}
					{lang="$name"}
					{{if $doneSteps}}
						</a>
					{{else}}
						</span>
					{{endif}}
				</li>
			{{endforeach}}
		</ul>
	</div>
	<div class='cGalleryDialog_content {{if \IPS\gallery\Image::moderateNewItems( \IPS\Member::loggedIn() )}}cGalleryDialog_content_moderated{{endif}}' data-role="wizardContent">
		{$output|raw}
	</div>
</div>]]></template>
 <template template_group="view" template_name="comments" template_data="$image" template_location="front" template_app="gallery"><![CDATA[<div class='ipsBox ipsSpacer_top'>
	<div class='' data-controller='core.front.core.commentFeed, core.front.core.ignoredComments' {{if settings.auto_polling_enabled}}data-autoPoll{{endif}} data-baseURL='{$image->url()}' {{if $image->isLastPage()}}data-lastPage{{endif}} data-feedID='image-{$image->id}' id='comments'>
		<div class='ipsPad'>
			<h2 class='ipsType_sectionHead ipsSpacer_bottom' data-role="comment_count">{lang="num_comments_uc" pluralize="$image->comments"}</h2>
			{{if $image->commentPageCount() > 1}}
				{$image->commentPagination( array('tab') )|raw}
				<br><br>
			{{endif}}

			{template="featuredComments" group="global" app="core" params="$image->featuredComments(), $image->url()->setQueryString('tab', 'comments')->setQueryString('recommended', 'comments')"}

			<div data-role='commentFeed' data-controller='core.front.core.moderation'>
				{{if count( $image->comments( NULL, NULL, 'date', 'asc', NULL, NULL, NULL, NULL, FALSE, isset( \IPS\Request::i()->showDeleted ) ) )}}
					<form action="{$image->url()->csrf()->setQueryString( 'do', 'multimodComment' )}" method="post" data-ipsPageAction data-role='moderationTools'>
						{{$commentCount=0; $timeLastRead = $image->timeLastRead(); $lined = FALSE;}}
						{{foreach $image->comments( NULL, NULL, 'date', 'asc', NULL, NULL, NULL, NULL, FALSE, isset( \IPS\Request::i()->showDeleted ) ) as $comment}}
							{{if !$lined and $timeLastRead and $timeLastRead->getTimestamp() < $comment->mapped('date')}}
								{{if $lined = TRUE and $commentCount}}
									<hr class="ipsCommentUnreadSeperator">
								{{endif}}
							{{endif}}
							{{$commentCount++;}}
							{$comment->html()|raw}
						{{endforeach}}
						{template="commentMultimod" app="core" group="global" params="$image"}
					</form>
				{{else}}
					<p class='ipsType_normal ipsType_light ipsType_reset' data-role='noComments'>{lang="no_comments"}</p>
				{{endif}}
			</div>			
			{{if $image->commentPageCount() > 1}}
				<hr class='ipsHr'>
				{$image->commentPagination( array('tab') )|raw}
			{{endif}}

			{{if $image->commentForm() || $image->locked() || \IPS\Member::loggedIn()->restrict_post || \IPS\Member::loggedIn()->members_bitoptions['unacknowledged_warnings']}}
			<a id='replyForm'></a>
			<div data-role='replyArea' class='ipsAreaBackground ipsPad {{if !$image->canComment()}}cTopicPostArea_noSize{{endif}} ipsSpacer_top'>
				{{if $image->commentForm()}}
					{{if $image->locked()}}
						<p class='ipsType_reset ipsType_warning ipsComposeArea_warning ipsSpacer_bottom ipsSpacer_half'><i class='fa fa-info-circle'></i> {lang="image_locked_can_comment"}</p>
					{{endif}}
						{$image->commentForm()|raw}
					{{else}}
					{{if $image->locked()}}
						{template="commentUnavailable" group="forms" location="front" app="core" params="'image_locked_cannot_comment'"}
					{{elseif \IPS\Member::loggedIn()->restrict_post}}
						{template="commentUnavailable" group="forms" location="front" app="core" params="'restricted_cannot_comment', \IPS\Member::loggedIn()->warnings(5,NULL,'rpa'), \IPS\Member::loggedIn()->restrict_post"}
					{{elseif \IPS\Member::loggedIn()->members_bitoptions['unacknowledged_warnings']}}
						{template="commentUnavailable" group="forms" location="front" app="core" params="'unacknowledged_warning_cannot_post', \IPS\Member::loggedIn()->warnings( 1, FALSE )"}
					{{endif}}
				{{endif}}
			</div>
			{{endif}}
		</div>
	</div>
</div>
]]></template>
 <template template_group="view" template_name="image" template_data="$image, $slider, $next=NULL, $prev=NULL, $hasNext=TRUE, $hasPrev=TRUE, $commentsAndReviews=FALSE" template_location="front" template_app="gallery"><![CDATA[
{{if $club = $image->container()->club()}}
	{{if settings.clubs and settings.clubs_header == 'full'}}
		{template="header" app="core" group="clubs" params="$club, $image->container()"}
	{{endif}}
	<div id='elClubContainer'>
{{endif}}

<div data-controller='gallery.front.view.image'>
	<div id='elGalleryHeader'>
		{template="imageFrame" group="view" app="gallery" params="$image, $slider, $next, $prev"}
		<div id='elGalleryNav' data-role='collectionNav'>
			<ul class='ipsList_inline ipsClearfix'>
				{template="imageSlider" group="view" app="gallery" params="$image, $slider, $next, $prev, $hasNext, $hasPrev"}
			</ul>
			<p class='ipsType_reset ipsType_center'>
				<div class='ipsContained ipsType_break'>
					{lang="slider_text" sprintf="$image->directContainer()->_title"}
				</div>
			</p>
		</div>
	</div>

	<section data-role='imageInfo'>
		{template="imageInfo" group="view" params="$image, $slider, $next, $prev"}	
	</section>

	<div data-role='imageComments'>
	{{if $commentsAndReviews}}
		<br>
		{{if ( $image->directContainer()->allow_reviews && $image->container()->allow_reviews ) && ( $image->directContainer()->allow_comments && $image->container()->allow_comments ) }}
			<a id="replies"></a>
			<h2 class='ipsHide'>{lang="user_feedback"}</h2>
		{{endif}}
		{$commentsAndReviews|raw}
	{{endif}}
	</div>

</div> 

{{if $image->container()->club()}}
	</div>
{{endif}}]]></template>
 <template template_group="view" template_name="imageFrame" template_data="$image, $slider, $next=NULL, $prev=NULL" template_location="front" template_app="gallery"><![CDATA[
<div id='elGalleryImage' data-role="imageFrame" {{if $image->data}}data-imageSizes='{$image->data}'{{endif}}>
	{{if $image->media }}
		<div class='cGallery_videoContainer'>
			{{if in_array( $image->file_type, array( 'video/ogg', 'video/webm', 'video/mp4', 'video/x-flv', 'video/3gpp' ) )}}
				<video id="elGalleryVideo" data-role="video" class="ipsPos_center video-js vjs-default-skin" controls preload="auto" width="100%" height="100%"{{if $image->medium_file_name }} poster="{file="$image->medium_file_name" extension="gallery_Images"}"{{endif}} data-setup='{"techOrder": ["html5","flash"]}'>
					<source src="{file="$image->original_file_name" extension="gallery_Images"}" type='{$image->file_type}' />
				</video>
			{{else}}
				<!-- Old fashioned...supports things like wmv though-->
				<embed wmode="opaque" autoplay="true" showcontrols="true" showstatusbar="true" showtracker="true" src="{file="$image->original_file_name" extension="gallery_Images"}" width="480" height="360" type='{$image->file_type}' />
			{{endif}}
		</div>
	{{else}}
		<div class='cGalleryViewImage' data-role='notesWrapper' data-controller='gallery.front.view.notes' data-imageID='{$image->id}' {{if $image->canEdit()}}data-editable{{endif}} data-notesData='{$image->_notes_json}'>
			
			<img src='{file="$image->masked_file_name" extension="gallery_Images"}' alt='{$image->caption}' title='{$image->caption}' data-role='theImage' class='ipsHide'>
			<noscript>
				<img src='{file="$image->masked_file_name" extension="gallery_Images"}' alt='{$image->caption}' title='{$image->caption}' data-role='theImage'>
			</noscript>
			{{if count( $image->_notes )}}
				<noscript>
					{{foreach $image->_notes as $note}}
						<div class='cGalleryNote' style='left: {$note['LEFT']}%; top: {$note['TOP']}%; width: {$note['WIDTH']}%; height: {$note['HEIGHT']}%'>
							<div class='cGalleryNote_border'></div>
							<div class='cGalleryNote_note'>{$note['NOTE']}</div>
						</div>
					{{endforeach}}
				</noscript>
			{{endif}}
		</div>
			
		<ul class='ipsButton_split cGalleryViewImage_controls'>
			{{if $image->canEdit()}}
				<li><a href='#' class='ipsButton ipsButton_overlaid ipsButton_verySmall ipsJS_show' title='{lang="add_image_note"}' data-action='addNote' data-ipsTooltip><i class='fa fa-pencil-square-o'></i></a></li>
				<li>
					<a href='#' class='ipsButton ipsButton_overlaid ipsButton_verySmall' title='{lang="rotate_image"}' data-ipsTooltip id='elImage_rotate' data-ipsMenu data-ipsMenu-appendTo='#elGalleryImage'>
						<i class='fa fa-rotate-right'></i> <i class='fa fa-caret-down'></i>
					</a>
					<ul class='ipsMenu ipsMenu_auto ipsHide' id='elImage_rotate_menu'>
						<li class='ipsMenu_item'>
							<a href='{$image->url( 'rotate' )->csrf()->setQueryString( 'direction', 'right' )}' title='{lang="rotate_right"}'>
								<i class='fa fa-rotate-right'></i> &nbsp;{lang="rotate_right"}
							</a>
						</li>
						<li class='ipsMenu_item'>
							<a href='{$image->url( 'rotate' )->csrf()->setQueryString( 'direction', 'left' )}' title="{lang="rotate_left"}">
								<i class='fa fa-rotate-left'></i> &nbsp;{lang="rotate_left"}
							</a>
						</li>
					</ul>
				</li>
			{{endif}}
			{{if count( $image->sizes() ) > 1}}
				<li>
					<a href='#' class='ipsButton ipsButton_overlaid ipsButton_verySmall' title='{lang="view_all_sizes"}' data-ipsTooltip id='elImageSize' data-ipsMenu data-ipsMenu-appendTo='#elGalleryImage'>
						<i class='fa fa-picture-o'></i> <i class='fa fa-caret-down'></i>
					</a>
					<ul class='ipsMenu ipsMenu_medium ipsHide' id='elImageSize_menu'>
						{{foreach $image->sizes() as $k => $dims}}
							<li class='ipsMenu_item'><a href='{$image->url()->setQueryString( 'imageSize', $k )}'>{$dims[0]}x{$dims[1]}</a></li>
						{{endforeach}}
					</ul>
				</li>
			{{endif}}
			{{if ( $image->album_id AND $image->author()->member_id == \IPS\Member::loggedIn()->member_id ) OR \IPS\gallery\Image::modPermission( 'edit', NULL, $image->container() ) || \IPS\Member::loggedIn()->member_id}}
				<li>
					{{if ( $image->album_id AND $image->author()->member_id == \IPS\Member::loggedIn()->member_id ) OR \IPS\gallery\Image::modPermission( 'edit', NULL, $image->container() )}}
						<a href='#' class='ipsButton ipsButton_overlaid ipsButton_verySmall' data-ipsTooltip title='{lang="set_image_as"}' id='elImageSetAs' data-ipsMenu data-ipsMenu-appendTo='#elGalleryImage'>
							<i class='fa fa-object-group'></i> <i class='fa fa-caret-down'></i>
						</a>
						<ul class='ipsMenu ipsMenu_auto ipsHide' id='elImageSetAs_menu'>
							{{if \IPS\gallery\Image::modPermission( 'edit', NULL, $image->container() ) AND ( $image->album_id AND $image->author()->member_id == \IPS\Member::loggedIn()->member_id )}}
								<li class='ipsMenu_item'><a data-action='setAsCover' href='{$image->url()->setQueryString( 'do', 'cover' )->setQueryString( 'set', 'category')->csrf()}'>{lang="cover_category_only"}</a></li>
								<li class='ipsMenu_item'><a data-action='setAsCover' href='{$image->url()->setQueryString( 'do', 'cover' )->setQueryString( 'set', 'album')->csrf()}'>{lang="cover_album_only"}</a></li>
								<li class='ipsMenu_item'><a data-action='setAsCover' href='{$image->url()->setQueryString( 'do', 'cover' )->setQueryString( 'set', 'both')->csrf()}'>{lang="cover_both"}</a></li>
							{{elseif \IPS\gallery\Image::modPermission( 'edit', NULL, $image->container() )}}
								<li class='ipsMenu_item'><a data-action='setAsCover' href='{$image->url()->setQueryString( 'do', 'cover' )->setQueryString( 'set', 'category')->csrf()}'>{lang="cover_category"}</a></li>
							{{elseif $image->album_id AND \IPS\Member::loggedIn()->member_id AND $image->author()->member_id == \IPS\Member::loggedIn()->member_id}}
								<li class='ipsMenu_item'><a data-action='setAsCover' href='{$image->url()->setQueryString( 'do', 'cover' )->setQueryString( 'set', 'album')->csrf()}'>{lang="cover_album"}</a></li>
							{{endif}}
							{{if \IPS\Member::loggedIn()->member_id}}
								<li class='ipsMenu_sep'><hr></li>
								<li class='ipsMenu_item'>
									<a href='{$image->url('setAsPhoto')->csrf()}' data-action='setAsProfile' title="{lang="set_gallery_image_photo"}">{lang="set_gallery_image_photo"}</a>
								</li>
							{{endif}}
						</ul>
					{{elseif \IPS\Member::loggedIn()->member_id}}
						<a href='{$image->url('setAsPhoto')->csrf()}' class='ipsButton ipsButton_overlaid ipsButton_verySmall' title='{lang="set_gallery_image_photo"}'>
							{lang="set_gallery_image_photo"}
						</a>
					{{endif}}
				</li>
			{{endif}}
			<li>
				<a href='{$image->url('download')}' class='ipsButton ipsButton_overlaid ipsButton_verySmall' title='{lang="download"}' data-ipsTooltip><i class='fa fa-download'></i></a>
			</li>
			<li>
				<a href='{file="$image->masked_file_name" extension="gallery_Images"}' class='ipsButton ipsButton_overlaid ipsButton_verySmall' title='{lang="view_in_lightbox"}' data-ipsTooltip data-ipsLightbox data-ipsLightbox-useEvents><i class='fa fa-expand'></i></a>
			</li>
		</ul>
	{{endif}}
	<span id='elGalleryImageNav'>
		{{if $prev}}
			<a href='{$prev->url()->setQueryString( 'browse', 1 )}' id='elGalleryImageNav_prev' data-action='prevImage' data-imageID='{$prev->id}' title='{$prev->caption}'><i class='fa fa-angle-left'></i></a>
		{{endif}}
		{{if $next}}
			<a href='{$next->url()->setQueryString( 'browse', 1 )}' id='elGalleryImageNav_next' data-action='nextImage' data-imageID='{$next->id}' title='{$next->caption}'><i class='fa fa-angle-right'></i></a>
		{{endif}}
	</span>
</div>]]></template>
 <template template_group="view" template_name="imageInfo" template_data="$image, $slider, $next=NULL, $prev=NULL" template_location="front" template_app="gallery"><![CDATA[
{template="contentItemMessages" group="global" app="core" params="$image->getMessages(), $image"}

<div class='ipsColumns ipsColumns_collapsePhone'>
	<div class='ipsColumn ipsColumn_fluid'>
		{{if $image->hidden() === 1 and $image->canUnhide()}}
			<div class="ipsBox ipsPad ipsAreaBackground_light ipsSpacer_bottom">
				<p class="ipsType_reset ipsType_normal"><i class='fa fa-warning'></i> {lang="image_pending_approval"}</p>
				<br>
				<ul class='ipsList_inline'>
					<li><a href="{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unhide' ) )}" class="ipsButton ipsButton_small ipsButton_positive" title='{lang="approve_title_image"}'><i class="fa fa-check-circle"></i> &nbsp;{lang="approve"}</a></li>
					{{if $image->canDelete()}}				
						<li><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'delete' ) )}' data-confirm title='{lang="delete_title_image"}' class="ipsButton ipsButton_small ipsButton_negative"><i class='fa fa-times'></i> &nbsp;{lang="delete"}</a></li>
					{{endif}}
				</ul>
			</div>
		{{endif}}

		<div class='ipsBox ipsPad' data-role='imageDescription'>
			<h1 class='ipsType_pageTitle ipsContained_container'>
				{{if $image->prefix() OR ( $image->canEdit() AND $image::canTag( NULL, $image->container() ) AND $image::canPrefix( NULL, $image->container() ) )}}
					<span {{if !$image->prefix()}}class='ipsHide'{{endif}} {{if ( $image->canEdit() AND $image::canTag( NULL, $image->container() ) AND $image::canPrefix( NULL, $image->container() ) )}}data-editablePrefix{{endif}}>
						{template="prefix" group="global" app="core" params="$image->prefix( TRUE ), $image->prefix()"}
					</span>
				{{endif}}
				{{if $image->hidden() === 1}}
					<span><span class="ipsBadge ipsBadge_icon ipsBadge_warning" data-ipsTooltip title='{lang="pending_approval"}'><i class='fa fa-warning'></i></span></span>
				{{elseif $image->hidden() === -1}}
					<span><span class="ipsBadge ipsBadge_icon ipsBadge_warning" data-ipsTooltip title='{$image->hiddenBlurb()}'><i class='fa fa-eye-slash'></i></span></span>
				{{elseif $image->hidden() === -2}}
					<span><span class="ipsBadge ipsBadge_icon ipsBadge_warning" data-ipsTooltip title='{$image->deletedBlurb()}'><i class='fa fa-trash'></i></span></span>
				{{endif}}
				{{if $image->mapped('featured')}}
					<span><span class="ipsBadge ipsBadge_icon ipsBadge_positive" data-ipsTooltip title='{lang="featured"}'><i class='fa fa-star'></i></span></span>
				{{endif}}
				{{if $image->canEdit()}}
					<span class='ipsContained ipsType_break' data-controller="core.front.core.moderation">{{if $image->locked()}}<i class='fa fa-lock'></i> {{endif}}
						<span data-role="editableTitle" title='{lang="click_hold_edit"}'>{$image->caption}</span>
					</span>
				{{else}}
					<span class='ipsContained ipsType_break'>{{if $image->locked()}}<i class='fa fa-lock'></i> {{endif}}{$image->caption}</span>
				{{endif}}
			</h1>
			<div class='ipsPhotoPanel ipsPhotoPanel_mini ipsClearfix ipsSpacer_bottom ipsSpacer_top'>
				{template="userPhoto" app="core" group="global" params="$image->author(), 'mini', $image->warningRef()"}
				<div>
					<div class='ipsPos_right ipsResponsive_noFloat ipsResponsive_hidePhone'>
						{template="follow" app="core" group="global" params="'gallery', 'image', $image->id, $image->followers()->count( TRUE )"}
					</div>
					<p class='ipsType_reset ipsType_normal ipsType_blendLinks'>
						{lang="byline_nodate_itemprop" htmlsprintf="$image->author()->link( $image->warningRef() )"}
					</p>
					<ul class='ipsList_inline'>
						<li class='ipsType_light'>{datetime="$image->date"}</li>
						<li class='ipsType_light'>{lang="num_views_with_number" pluralize="$image->views"}</li>
						{{if $image->author()->member_id OR $image->canChangeAuthor()}}
							{{if $image->author()->member_id}}
								<li><a href='{url="app=core&module=members&controller=profile&id={$image->author()->member_id}&do=content&type=gallery_image" base="front" seoTitles="$image->author()->members_seo_name" seoTemplate="profile_content"}'>{lang="find_users_images"}</a></li>
							{{endif}}
							{{if $image->canChangeAuthor()}}
								<li><a href='{$image->url()->setQueryString( array( 'do' => 'changeAuthor' ) )}' data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title="{lang="change_author"}" title='{lang="change_author_ititle"}'>{lang="change_author"}</a></li>
							{{endif}}
						{{endif}}
					</ul>
				</div>
			</div>

			{{if $image->description}}
				<div class='ipsType_medium ipsType_richText ipsType_break ipsSpacer_both' data-controller="core.front.core.lightboxedImages">
					{$image->content()|raw}
				</div>
			{{endif}}

			{{if count( $image->tags() ) OR ( $image->canEdit() AND $image::canTag( NULL, $image->container() ) )}}
				{template="tags" group="global" app="core" params="$image->tags(), FALSE, FALSE, ( $image->canEdit() AND $image::canTag( NULL, $image->container() ) ) ? $image->url() : NULL"}
				<br>
			{{endif}}

			{{if $image->credit_info && $image->copyright}}
				<div class='ipsGrid ipsGrid_collapsePhone'>
					<div class='ipsGrid_span6'>
			{{endif}}

				{{if $image->credit_info}}
					<h3 class='ipsType_minorHeading'>{lang="image_credit_info"}</h3>
					<div class='ipsType_richText ipsType_medium'>
						{$image->credit_info}
					</div>
				{{endif}}

			{{if $image->credit_info && $image->copyright}}
					</div>
					<div class='ipsGrid_span6'>
			{{endif}}

				{{if $image->copyright}}
					<h3 class='ipsType_minorHeading'>{lang="image_copyright"}</h3>
					<div class='ipsType_richText'>
						&copy; {$image->copyright}
					</div>
				{{endif}}

			{{if $image->credit_info && $image->copyright}}
					</div>
				</div>
			{{endif}}

			
			<div class='ipsItemControls'>
				{{if \IPS\IPS::classUsesTrait( $image, 'IPS\Content\Reactable' ) and settings.reputation_enabled}}
					{template="reputation" app="core" group="global" params="$image"}
				{{endif}}
				<ul class='ipsToolList ipsToolList_horizontal ipsPos_left ipsClearfix ipsResponsive_noFloat ipsItemControls_left'>
					{{if ( $image->canEdit() or $image->canFeature() or $image->canPin() or $image->canUnfeature() or $image->canHide() or $image->canUnhide() or $image->canMove() or $image->canLock() or $image->canUnlock() or $image->canDelete() ) or ( $image->hidden() == -2 AND \IPS\Member::loggedIn()->modPermission('can_manage_deleted_content') )}}
						<li>
							<a href='#elImageActions_menu' id='elImageActions' class='ipsButton ipsButton_light ipsButton_verySmall ipsButton_fullWidth' data-ipsMenu>{lang="manage_image"} <i class='fa fa-caret-down'></i></a>
							<ul id='elImageActions_menu' class='ipsMenu ipsMenu_auto ipsHide'>
								{{if \IPS\Member::loggedIn()->modPermission('can_manage_deleted_content') AND $image->hidden() == -2}}
									<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'restore' ) )}' data-confirm data-confirmSubMessage='{lang="restore_as_visible_desc"}'>{lang="restore_as_visible"}</a></li>
									<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'restoreAsHidden' ) )}' data-confirm data-confirmSubMessage='{lang="restore_as_hidden_desc"}'>{lang="restore_as_hidden"}</a></li>
									<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'delete', 'immediate' => 1 ) )}' data-confirm data-confirmSubMessage='{lang="delete_immediately_desc"}'>{lang="delete_immediately"}</a></li>
								{{else}}
									{{if $image->canEdit()}}				
										<li class='ipsMenu_item'><a href='{$image->url()->setQueryString( array( 'do' => 'edit' ) )}' title="{lang="gallery_edit_details_title"}">{lang="gallery_edit_details"}</a></li>
									{{endif}}
									{{if $image->canFeature()}}				
										<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'feature' ) )}' title="{lang="feature_title_image"}">{lang="feature"}</a></li>
									{{endif}}
									{{if $image->canUnfeature()}}				
										<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unfeature' ) )}' title="{lang="unfeature_title_image"}">{lang="unfeature"}</a></li>
									{{endif}}
									{{if $image->canPin()}}
										<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'pin' ) )}' title="{lang="pin_title_image"}">{lang="pin"}</a></li>
									{{endif}}
									{{if $image->canUnpin()}}
										<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unpin' ) )}' title="{lang="unpin_title_image"}">{lang="unpin"}</a></li>
									{{endif}}
									{{if $image->canHide()}}				
										<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'hide' ) )}' title="{lang="hide_title_image"}" data-ipsDialog data-ipsDialog-title="{lang="hide"}">{lang="hide"}</a></li>
									{{endif}}
									{{if $image->canUnhide()}}				
										<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unhide' ) )}' title="{{if $image->hidden() === 1}}{lang="approve_title_image"}{{else}}{lang="unhide_title_image"}{{endif}}">{{if $image->hidden() === 1}}{lang="approve"}{{else}}{lang="unhide"}{{endif}}</a></li>
									{{endif}}
									{{if $image->canLock()}}				
										<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'lock' ) )}' title="{lang="lock_title_image"}">{lang="lock"}</a></li>
									{{endif}}
									{{if $image->canUnlock()}}				
										<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unlock' ) )}' title="{lang="unlock_title_image"}">{lang="unlock"}</a></li>
									{{endif}}
									{{if $image->canMove()}}				
										<li class='ipsMenu_item'><a href='{$image->url()->setQueryString( array( 'do' => 'move' ) )}' data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title="{lang="move"}"  title="{lang="gallery_move_title"}">{lang="move"}</a></li>
									{{endif}}
									{{if $image->canDelete()}}				
										<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'delete' ) )}' data-confirm  title="{lang="delete_title_image"}">{lang="delete"}</a></li>
									{{endif}}
									{{if $image->canOnMessage( 'add' )}}
										<li class='ipsMenu_item'><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'messageForm' ) )}' data-ipsDialog data-ipsDialog-title='{lang="add_message"}'>{lang="add_message"}</a></li>
									{{endif}}
									{{if \IPS\Member::loggedIn()->modPermission('can_view_moderation_log')}}
										<li class='ipsMenu_sep'><hr></li>
										<li class="ipsMenu_item"><a href='{$image->url()->csrf()->setQueryString( array( 'do' => 'modLog' ) )}' data-ipsDialog data-ipsDialog-title='{lang="moderation_history"}'>{lang="moderation_history"}</a></li>
									{{endif}}
								{{endif}}
							</ul>
						</li>
					{{endif}}

					{{if $image->canReport()}}
						<li>
							<a href='{$image->url('report')}' class='ipsButton ipsButton_link ipsButton_verySmall ipsButton_fullWidth' data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title="{lang="report_image"}" data-ipsDialog-remoteSubmit data-ipsDialog-flashMessage="{lang="report_submit_success"}" title="{lang="report_image"}">{lang="report_image"}</a>
						</li>
					{{endif}}
				</ul>
			</div>

			<div class='ipsResponsive_showPhone ipsResponsive_block ipsSpacer_both'>
				{template="follow" app="core" group="global" params="'gallery', 'image', $image->id, $image->followers()->count( TRUE )"}
			</div>
			{{if count( $image->shareLinks() )}}
				<div class='ipsSpacer_top'>
					{template="sharelinks" app="core" group="global" params="$image"}
				</div>
			{{endif}}	
		</div>
	</div>
	<div class='ipsColumn ipsColumn_wide' id='elGalleryImageStats'>
		<div class='ipsBox ipsPad' data-role="imageStats">
			{{if $image->directContainer()->allow_rating}}
				<div class='ipsType_center'>
					{$image->rating()|raw}
				</div>
				<hr class='ipsHr'>
			{{endif}}

			{{if $image->gps_show}}
				{$image->map( 240, 100 )|raw}
				<div class='ipsType_small'>
					{$image->loc_short}
					{{if $image->canEdit() }}
						<br><br>
						<a href='#' id='elMapForm' data-ipsMenu data-ipsMenu-closeOnClick='false'>{lang="map_privacy"} <i class='fa fa-caret-down'></i></a>
						<div class='ipsMenu ipsMenu_auto ipsHide ipsPad' id='elMapForm_menu'>
							{$image->enableMapForm()|raw}
						</div>
					{{endif}}
				</div>
				<hr class='ipsHr'>
			{{elseif $image->canEdit() AND $image->gps_raw}}
				<div class='ipsFaded'>
					{$image->map( 240, 100 )|raw}
					<div class='ipsType_small'>
						{$image->loc_short}
					</div>
				</div>
				{{if $image->canEdit() }}
					<div class='ipsType_small ipsSpacer_top'>
						<strong>{lang="map_not_being_shown"}</strong>
						<a href='#' id='elMapForm' data-ipsMenu data-ipsMenu-closeOnClick='false'>{lang="map_privacy"} <i class='fa fa-caret-down'></i></a>
						<div class='ipsMenu ipsMenu_auto ipsHide ipsPad' id='elMapForm_menu'>
							{$image->enableMapForm()|raw}
						</div>
					</div>
				{{endif}}
				<hr class='ipsHr'>
			{{endif}}

			{{if $image->directContainer() instanceof \IPS\gallery\Album}}
				<div>
					<strong class='ipsType_minorHeading'>{lang="from_the_album"}</strong>
					<br>
					<h3 class='ipsType_sectionHead'><span class='ipsContained ipsType_break'><a href='{$image->directContainer()->url()}' class='ipsType_normal ipsTruncate ipsTruncate_line'>{$image->directContainer()->_title}</a></span></h3>
					<ul class='ipsList_inline ipsType_medium'>
						<li><i class='fa fa-camera'></i> <strong>{lang="num_images" pluralize="$image->directContainer()->count_imgs"}</strong></li>
						{{if $image->container()->allow_comments and $image->directContainer()->use_comments}}
							<li><i class='fa fa-comment'></i> <strong>{lang="num_comments" pluralize="$image->directContainer()->comments"}</strong></li>
						{{endif}}
						{{if $image->container()->allow_comments and $image->directContainer()->allow_comments}}
							<li><i class='fa fa-comment'></i> <strong>{lang="gallery_image_comments_s" pluralize="$image->directContainer()->count_comments"}</strong></li>
						{{endif}}
					</ul>
				</div>
				<hr class='ipsHr'>
			{{endif}}

			{{if count($image->metadata)}}
				<h2 class='ipsType_minorHeading ipsType_break'>{lang="gallery_metadata" sprintf="$image->caption"}</h2>
				<div class='cGalleryExif'>
					{{if isset( $image->metadata['EXIF.FocalLength'] ) || ( isset( $image->metadata['IFD0.Make'] ) AND isset( $image->metadata['IFD0.Model'] ) ) || isset( $image->metadata['EXIF.ShutterSpeedValue'] ) || isset( $image->metadata['COMPUTED.ApertureFNumber'] ) || isset( $image->metadata['Exif.Photo.ISOSpeed'] )}}
						<h3 class='ipsType_reset ipsType_small'>
							{{if isset( $image->metadata['IFD0.Make'] ) AND isset( $image->metadata['IFD0.Model'] )}}
								<strong>{lang="gallery_exif_camera"} {$image->metadata['IFD0.Make']} {$image->metadata['IFD0.Model']}</strong>
							{{else}}
								<strong>{lang="camera_information"}</strong>
							{{endif}}
						</h3>
						<ul class='ipsList_inline cGalleryExif_data'>
							{{if isset( $image->metadata['EXIF.FocalLength'] )}}
								<li data-ipsTooltip title='{lang="EXIF.FocalLength"}'>
									<span><i class='fa fa-arrows-h'></i></span>
									{$image->focallength}
								</li>
							{{endif}}
							{{if isset( $image->metadata['EXIF.ExposureTime'] )}}
								<li data-ipsTooltip title='{lang="EXIF.ExposureTime"}'>
									<span><i class='fa fa-clock-o'></i></span>
									{$image->metadata['EXIF.ExposureTime']}
								</li>
							{{endif}}
							{{if isset( $image->metadata['COMPUTED.ApertureFNumber'] )}}
								<li data-ipsTooltip title='{lang="COMPUTED.ApertureFNumber"}'>
									<span class='cGalleryExif_f'>f</span>
									{$image->metadata['COMPUTED.ApertureFNumber']}
								</li>
							{{endif}}
							{{if isset( $image->metadata['Exif.Photo.ISOSpeed'] ) || isset( $image->metadata['EXIF.ISOSpeedRatings'] )}}
								<li data-ipsTooltip title='{lang="gallery_exif_isospeed"}'>
									<span class='cGalleryExif_iso'>{lang="gallery_exif_iso"}</span>
									{{if isset( $image->metadata['Exit.Photo.ISOSpeed'] )}}
										{$image->metadata['Exif.Photo.ISOSpeed']}
									{{else}}
										{{if is_array( $image->metadata['EXIF.ISOSpeedRatings'] )}}
											{expression="implode( '/', $image->metadata['EXIF.ISOSpeedRatings'] )"}
										{{else}}
											{$image->metadata['EXIF.ISOSpeedRatings']}
										{{endif}}
									{{endif}}
								</li>
							{{endif}}
						</ul>
						<a href='{$image->url( 'metadata' )}' data-ipsDialog data-ipsDialog-title='{lang="view_all_photo_info"}'>{lang="view_all_photo_info"}</a>
					{{else}}
						<a href='{$image->url( 'metadata' )}' data-ipsDialog data-ipsDialog-title='{lang="view_all_photo_info"}'>{lang="view_photo_info"}</a>
					{{endif}}
				</div>
			{{endif}}
		</div>
	</div>
</div>]]></template>
 <template template_group="view" template_name="imageSizes" template_data="$image, $sizes" template_location="front" template_app="gallery"><![CDATA[
{template="pageHeader" group="global" app="core" params="sprintf( \IPS\Member::loggedIn()->language()->get('all_image_sizes'), $image->caption )"}

<div>
	<ul class='ipsList_inline'>
		<li><a href='{$image->url()}' class='ipsButton ipsButton_veryLight ipsButton_verySmall' title='{lang="back_to_image_page"}' data-ipsTooltip><i class='fa fa-chevron-left'></i> {lang="back_to_image_page"}</a></li>
		<li>
			<ul class='ipsButton_split'>
				{{if isset( $sizes['thumb'] )}}
					<li><a href='{$image->url()->setQueryString( 'imageSize', 'thumb' )}' class='ipsButton {{if \IPS\Request::i()->imageSize == 'thumb'}}ipsButton_primary{{else}}ipsButton_light{{endif}} ipsButton_verySmall' title='{lang="size_thumb"}'>{lang="size_thumb"} <span class='ipsType_light ipsResponsive_hidePhone ipsResponsive_inline'>({$sizes['thumb'][0]}x{$sizes['thumb'][1]})</span></a></li>
				{{endif}}
				{{if isset( $sizes['small'] )}}
					<li><a href='{$image->url()->setQueryString( 'imageSize', 'small' )}' class='ipsButton {{if \IPS\Request::i()->imageSize == 'small'}}ipsButton_primary{{else}}ipsButton_light{{endif}}  ipsButton_verySmall' title='{lang="size_small"}'>{lang="size_small"} <span class='ipsType_light ipsResponsive_hidePhone ipsResponsive_inline'>({$sizes['small'][0]}x{$sizes['small'][1]})</span></a></li>
				{{endif}}
				{{if isset( $sizes['medium'] )}}
					<li><a href='{$image->url()->setQueryString( 'imageSize', 'medium' )}' class='ipsButton {{if \IPS\Request::i()->imageSize == 'medium' or !\IPS\Request::i()->imageSize}}ipsButton_primary{{else}}ipsButton_light{{endif}} ipsButton_verySmall' title='{lang="size_medium"}'>{lang="size_medium"} <span class='ipsType_light ipsResponsive_hidePhone ipsResponsive_inline'>({$sizes['medium'][0]}x{$sizes['medium'][1]})</span></a></li>
				{{endif}}
				{{if isset( $sizes['large'] )}}
					<li><a href='{$image->url()->setQueryString( 'imageSize', 'large' )}' class='ipsButton {{if \IPS\Request::i()->imageSize == 'large'}}ipsButton_primary{{else}}ipsButton_light{{endif}}  ipsButton_verySmall' title='{lang="size_large"}'>{lang="size_large"} <span class='ipsType_light ipsResponsive_hidePhone ipsResponsive_inline'>({$sizes['large'][0]}x{$sizes['large'][1]})</span></a></li>
				{{endif}}
			</ul>
		</li>
		<li><a href='{$image->url('download')->setQueryString( 'imageSize', \IPS\Request::i()->imageSize ?: 'medium' )}' class='ipsButton ipsButton_veryLight ipsButton_verySmall' title='{lang="download"}' data-ipsTooltip><i class="fa fa-download"></i></a></li>
	</ul>
</div>

<div id='elGalleryImage_sized'>
	{{$name = ( isset( \IPS\Request::i()->imageSize ) AND \IPS\Request::i()->imageSize AND \IPS\Request::i()->imageSize != 'large' ) ? \IPS\Request::i()->imageSize . "_file_name" : "masked_file_name";}}
	<img src='{file="$image->$name" extension="gallery_Images"}' alt='{$image->caption}' title='{$image->caption}'>
</div>

{{if $image->credit_info}}
	<h3 class='ipsType_minorHeading'>{lang="image_credit_info"}</h3>
	<div class='ipsType_richText ipsType_medium ipsSpacer_bottom'>
		{$image->credit_info}
	</div>
{{endif}}

{{if $image->copyright}}
	<h3 class='ipsType_minorHeading'>{lang="image_copyright"}</h3>
	<div class='ipsType_richText ipsSpacer_bottom'>
		&copy; {$image->copyright}
	</div>
{{endif}}]]></template>
 <template template_group="view" template_name="imageSlider" template_data="$image, $slider, $next=NULL, $prev=NULL, $hasNext=TRUE, $hasPrev=TRUE" template_location="front" template_app="gallery"><![CDATA[
<li class='ipsJS_show'><a href='#' data-action='prev' {{if !$hasPrev}}data-disabled='true'{{endif}}><i class='fa fa-angle-left'></i></a></li>
<li class='cGalleryAlbumSlider_wrapper'>
	<ol class='ipsList_reset cGalleryAlbumSlider' data-role='collection'>

{{for $i=0, $j=count($slider['previous']); $i<3-$j; $i++}}
	{template="imageThumbnail" group="view" params="FALSE"}
{{endfor}}
{{foreach array_reverse( $slider['previous'] ) as $idx => $previous}}
	{template="imageThumbnail" group="view" params="$previous"}
{{endforeach}}
	{template="imageThumbnail" group="view" params="$image, true"}
{{foreach $slider['next'] as $next}}
	{template="imageThumbnail" group="view" params="$next"}
{{endforeach}}
{{for $i=0, $j=count($slider['next']); $i<3-$j; $i++}}
	{template="imageThumbnail" group="view" params="FALSE"}
{{endfor}}

	</ol>
</li>
<li class='ipsJS_show'><a href='#' data-action='next' {{if !$hasNext}}data-disabled='true'{{endif}}><i class='fa fa-angle-right'></i></a></li>]]></template>
 <template template_group="view" template_name="imageThumbnail" template_data="$image, $highlight=FALSE, $json=FALSE" template_location="front" template_app="gallery"><![CDATA[{{if $image}}
	{{if $image->medium_file_name}}
		<li style='background-image: url( "{expression="str_replace( array( '(', ')' ), array( '\(', '\)' ), \IPS\File::get( 'gallery_Images', $image->thumb_file_name )->url )"}" );' class='cGalleryTrimmedImage {{if $highlight}}cGalleryAlbumSlider_active{{endif}}' data-imageID='{$image->id}'>
			<a href='{$image->url()->setQueryString( 'browse', 1 )}' title='{$image->caption}'>
				<img src='{file="$image->thumb_file_name" extension="gallery_Images"}' alt='{$image->caption}'>
			</a>
		</li>
	{{else}}
		<li class='ipsNoThumb ipsNoThumb_video ipsCursor_pointer' data-imageID='{$image->id}'>
			<a href='{$image->url()->setQueryString( 'browse', 1 )}' title='{$image->caption}'></a>
		</li>
	{{endif}}
{{else}}
	<li class='ipsAreaBackground'>&nbsp;</li>
{{endif}}]]></template>
 <template template_group="view" template_name="metadata" template_data="$image" template_location="front" template_app="gallery"><![CDATA[{template="pageHeader" if="!\IPS\Request::i()->isAjax()" group="global" app="core" params="\IPS\Member::loggedIn()->language()->addToStack('gallery_metadata', FALSE, array( 'sprintf' => array( $image->caption ) ) )"}
<div class='ipsPad'>
	{{if count( $image->metadata )}}
		<ol class='ipsDataList'>
			{{foreach $image->metadata as $key => $value}}
				{{if !is_array( $value ) AND ( $image->gps_show OR mb_strpos( $key, 'GPS.' ) === FALSE ) AND mb_strpos( $key, 'UndefinedTag' ) === FALSE AND ( !\IPS\Member::loggedIn()->language()->checkKeyExists( $key ) OR ( \IPS\Member::loggedIn()->language()->checkKeyExists( $key ) AND \IPS\Member::loggedIn()->language()->get( $key ) ) )}}
					<li class='ipsDataItem ipsClearfix'>
						<div class='ipsDataItem_generic ipsDataItem_size7'><strong class='ipsPos_right'>{lang="$key"}</strong></div>
						<div class='ipsDataItem_main'>{{if \IPS\Member::loggedIn()->language()->checkKeyExists( $key . '_map_' . $value )}}{lang="{$key}_map_{$value}"}{{else}}{$value}{{endif}}</div>
					</li>
				{{endif}}
			{{endforeach}}
		</ol>
	{{else}}
		<p class='ipsType ipsType_light'>{lang="gallery_no_metadata"}</p>
	{{endif}}
</div>]]></template>
 <template template_group="view" template_name="reviews" template_data="$image" template_location="front" template_app="gallery"><![CDATA[<div data-controller='core.front.core.commentFeed' {{if settings.auto_polling_enabled}}data-autoPoll{{endif}} data-commentsType='reviews' data-baseURL='{$image->url()}' {{if $image->isLastPage('reviews')}}data-lastPage{{endif}} data-feedID='image-{$image->id}-reviews' id='reviews'>
	{{if $image->reviewForm()}}
		{{if $image->locked()}}
			<strong class='ipsType_warning'><i class='fa fa-info-circle'></i> {lang="item_locked_can_review"}</strong>
		{{endif}}
		<div id='elImageReviewForm'>
			{$image->reviewForm()|raw}
		</div>
	{{else}}
		{{if $image->hasReviewed()}}
			<!-- Already reviewed -->
		{{elseif $image->locked()}}
			{template="commentUnavailable" group="forms" location="front" app="core" params="'item_locked_cannot_review'"}
		{{elseif \IPS\Member::loggedin()->restrict_post}}
			{{if \IPS\Member::loggedIn()->restrict_post == -1}}
				{template="reviewUnavailable" group="forms" location="front" app="core" params="'restricted_cannot_comment'"}
			{{else}}
				{template="reviewUnavailable" group="forms" location="front" app="core" params="'restricted_cannot_comment', \IPS\Member::loggedIn()->warnings(5,NULL,'rpa'), \IPS\Member::loggedIn()->restrict_post"}
			{{endif}}
		{{elseif \IPS\Member::loggedIn()->members_bitoptions['unacknowledged_warnings']}}
			{template="reviewUnavailable" group="forms" location="front" app="core" params="'unacknowledged_warning_cannot_post', \IPS\Member::loggedIn()->warnings( 1, FALSE )"}
		{{endif}}
	{{endif}}
	{{if count( $image->reviews( NULL, NULL, NULL, 'desc', NULL, NULL, NULL, NULL, isset( \IPS\Request::i()->showDeleted ) ) )}}
		{{if !$image->hasReviewed()}}<hr class='ipsHr'>{{endif}}
		<div class="ipsClearfix ipsSpacer_bottom">
			{{if $image->reviewPageCount() > 1}}
				<div class="ipsPos_left ipsResponsive_noFloat">
					{$image->reviewPagination( array( 'tab', 'sort' ) )|raw}
				</div>
			{{endif}}
			<div class="ipsClearfix ipsPos_right ipsResponsive_hidePhone">
				<ul class="ipsButtonRow ipsClearfix">
					<li data-action="tableFilter">
						<a href="{$image->url()->setQueryString( array( 'tab' => 'reviews', 'page' => 1, 'sort' => 'helpful' ) )}" class="{{if !isset( request.sort ) or request.sort != 'newest'}}ipsButtonRow_active{{endif}}" data-action="filterClick">{lang="most_helpful"}</a>
					</li>
					<li data-action="tableFilter">
						<a href="{$image->url()->setQueryString( array( 'tab' => 'reviews', 'page' => 1, 'sort' => 'newest' ) )}" class="{{if isset( request.sort ) and request.sort == 'newest'}}ipsButtonRow_active{{endif}}" data-action="filterClick">{lang="newest"}</a>
					</li>
				</ul>
			</div>
		</div>

		<div data-role='commentFeed' data-controller='core.front.core.moderation'>
			<form action="{$image->url()->csrf()->setQueryString( 'do', 'multimodReview' )}" method="post" data-ipsPageAction data-role='moderationTools'>
				{{$reviewCount=0; $timeLastRead = $image->timeLastRead(); $lined = FALSE;}}
				{{foreach $image->reviews( NULL, NULL, NULL, 'desc', NULL, NULL, NULL, NULL, isset( \IPS\Request::i()->showDeleted ) ) as $review}}
					{{if !$lined and $timeLastRead and $timeLastRead->getTimestamp() < $review->mapped('date')}}
						{{if $lined = TRUE and $reviewCount}}
							<hr class="ipsCommentUnreadSeperator">
						{{endif}}
					{{endif}}
					{{$reviewCount++;}}
					{$review->html()|raw}
				{{endforeach}}
				{template="commentMultimod" app="core" group="global" params="$image, 'review'"}
			</form>
		</div>
		{{if $image->reviewPageCount() > 1}}
			<div>
				{$image->reviewPagination( array( 'tab', 'sort' ) )|raw}
			</div>
		{{endif}}
	{{elseif !$image->canReview()}}
		<p class="ipsType_normal ipsType_light ipsType_reset" data-role="noReviews">{lang="no_reviews"}</p>
	{{endif}}
</div>]]></template>
 <template template_group="view" template_name="rssContent" template_data="$image" template_location="front" template_app="gallery"><![CDATA[{$image->description|raw}
<p>
	<a href='{$image->url()}' title='{$image->caption}'><img src='{file="$image->medium_file_name" extension="gallery_Images"}' title='{$image->caption}' alt='{$image->caption}'></a>
</p>]]></template>
 <template template_group="widgets" template_name="albums" template_data="$albums, $title, $orientation='vertical'" template_location="front" template_app="gallery"><![CDATA[{{if !empty( $albums ) }}
	<h3 class='ipsType_reset ipsWidget_title'>{$title}</h3>
		{{if $orientation == 'horizontal'}}
			<div class='ipsWidget_inner ipsPad'>
				<div class='ipsCarousel ipsClearfix' data-ipsCarousel data-ipsCarousel-showDots>
					<ul class='cGalleryCarousel ipsGrid ipsGrid_collapsePhone' data-role="carouselItems">
		{{else}}
			<div class='ipsWidget_inner'>
				<div class='ipsPad_half'>
					<ul class='ipsList_reset cGalleryWidgetList'>
        {{endif}}

		{{foreach $albums as $album}}
			<li class='cGalleryWidget {{if $orientation == 'horizontal'}}ipsCarousel_item{{endif}}'>
				{{if $orientation == 'horizontal'}}
					{{if $album->asNode()->coverPhoto('medium')}}
						<a href='{$album->url()}' title='{lang="view_this_album" sprintf="$album->name"}' class='ipsThumb ipsThumb_bg ipsThumb_large' style='background-image: url("{$album->asNode()->coverPhoto('medium')}");'>
							<img src='{$album->asNode()->coverPhoto('medium')}' alt=''>
						</a>
					{{else}}
						<a href='{$album->url()}' title='{lang="view_this_album sprintf="$album->name"}' class='ipsNoThumb ipsNoThumb_video ipsThumb_bg ipsThumb_large'></a>
					{{endif}}
				{{else}}
					{{if $album->asNode()->coverPhoto('medium')}}
						<a href='{$album->url()}' title='{lang="view_this_album" sprintf="$album->name"}' class='ipsThumb ipsThumb_bg cGalleryWidget_verticalThumb' style='background-image: url("{$album->asNode()->coverPhoto('medium')}");'>
							<img src='{$album->asNode()->coverPhoto('medium')}' alt=''>
						</a>
					{{else}}
						<a href='{$album->url()}' title='{lang="view_this_album" sprintf="$album->name"}' class='ipsNoThumb ipsNoThumb_video ipsThumb_bg cGalleryWidget_verticalThumb'></a>
					{{endif}}
				{{endif}}
				<div class='ipsSpacer_top ipsSpacer_half cGalleryWidgetInfo'>
					<div class="ipsCommentCount ipsPos_right {{if $album->count_imgs === 0}}ipsFaded{{endif}}" data-ipsTooltip title='{lang="num_images" pluralize="$album->count_imgs"}'>
						<i class='fa fa-camera'></i>
						{$album->count_imgs}
					</div>
					{{if $album->unread()}}
						<div class='ipsTruncate ipsTruncate_line'>
							<a href="{$album->url()}" title='{lang="view_this_album" sprintf="$album->name"}' class='cGalleryWidget_title ipsType_medium'>
								<span class="ipsItemStatus ipsItemStatus_small"><i class="fa fa-circle"></i></span>
								<strong>{$album->name}</strong>
							</a>
						</div>
					{{else}}
						<div class='ipsTruncate ipsTruncate_line'>
							<a href="{$album->url()}" title='{lang="view_this_album" sprintf="$album->name"}' class='cGalleryWidget_title ipsType_medium'>
								{$album->name}
							</a>
						</div>
					{{endif}}
					<span class='ipsType_medium ipsType_blendLinks'>{lang="byline_nodate" htmlsprintf="$album->author()->link()"}</span><br>
					<span class='ipsType_light ipsType_medium'>{datetime="$album->mapped('updated')"}</span>
				</div>
			</li>
		{{endforeach}}

		{{if $orientation == 'vertical'}}
					</ul>
				</div>
		{{else}}
					</ul>
					<span class='ipsCarousel_shadow ipsCarousel_shadowLeft'></span>
					<span class='ipsCarousel_shadow ipsCarousel_shadowRight'></span>
					<a href='#' class='ipsCarousel_nav ipsHide' data-action='prev'><i class='fa fa-chevron-left'></i></a>
					<a href='#' class='ipsCarousel_nav ipsHide' data-action='next'><i class='fa fa-chevron-right'></i></a>
				</div>
		{{endif}}
			</div>
{{endif}}]]></template>
 <template template_group="widgets" template_name="galleryStats" template_data="$stats, $latestImage, $orientation='vertical'" template_location="front" template_app="gallery"><![CDATA[<h3 class='ipsType_reset ipsWidget_title'>{lang="block_galleryStats"}</h3>
<div class='ipsWidget_inner'>
	{{if $orientation == 'vertical'}}
		<div class='ipsPad_half'>		
			<ul class='ipsDataList' id='elGalleryStats'>
				<li class='ipsDataItem'>
					<div class='ipsDataItem_main ipsPos_middle'>
						<strong>{lang="total_images_front_v" pluralize="$stats['totalImages']"}</strong>
					</div>
					<div class='ipsDataItem_stats ipsDataItem_statsLarge'>
						<span class='ipsDataItem_stats_number'>{number="$stats['totalImages']"}</span>
					</div>
				</li>
				{{if $stats['totalComments']}}
					<li class='ipsDataItem'>
						<div class='ipsDataItem_main ipsPos_middle'>
							<strong>{lang="stats_total_comments_v" pluralize="$stats['totalComments']"}</strong>
						</div>
						<div class='ipsDataItem_stats ipsDataItem_statsLarge'>
							<span class='ipsDataItem_stats_number'>{number="$stats['totalComments']"}</span>
						</div>
					</li>
				{{endif}}
				{{if $stats['totalAlbums']}}
					<li class='ipsDataItem'>
						<div class='ipsDataItem_main ipsPos_middle'>
							<strong>{lang="total_albums_v" pluralize="$stats['totalAlbums']"}</strong>
						</div>
						<div class='ipsDataItem_stats ipsDataItem_statsLarge'>
							<span class='ipsDataItem_stats_number'>{number="$stats['totalAlbums']"}</span>
						</div>
					</li>
				{{endif}}
			</ul>
			{{if $latestImage}}
				<hr class='ipsHr'>
				{template="latestImage" group="widgets" app="gallery" params="$latestImage, $orientation"}
			{{endif}}
		</div>
	{{else}}
		{{$columns = 1;}}
		{{$columns += ( $stats['totalComments'] ) ? 1 : 0;}}
		{{$columns += ( $stats['totalAlbums'] ) ? 1 : 0;}}
		{{$span = 12 / $columns;}}
		<div class='ipsGrid ipsGrid_collapsePhone ipsWidget_stats'>
			<div class='ipsGrid_span{$span} ipsType_center'>
				<span class='ipsType_large ipsWidget_statsCount'>{number="$stats['totalImages']"}</span><br>
				<span class='ipsType_light ipsType_medium'>{lang="total_images_front_h" pluralize="$stats['totalImages']"}</span>
			</div>
			{{if $stats['totalComments']}}
				<div class='ipsGrid_span{$span} ipsType_center'>
					<span class='ipsType_large ipsWidget_statsCount'>{number="$stats['totalComments']"}</span><br>
					<span class='ipsType_light ipsType_medium'>{lang="stats_total_comments_h" pluralize="$stats['totalComments']"}</span>
				</div>
			{{endif}}
			{{if $stats['totalAlbums']}}
				<div class='ipsGrid_span{$span} ipsType_center'>
					<span class='ipsType_large ipsWidget_statsCount'>{number="$stats['totalAlbums']"}</span><br>
					<span class='ipsType_light ipsType_medium'>{lang="total_albums_h" pluralize="$stats['totalAlbums']"}</span>
				</div>
			{{endif}}
		</div>
	{{endif}}
</div>]]></template>
 <template template_group="widgets" template_name="imageFeed" template_data="$images, $title, $orientation='vertical'" template_location="front" template_app="gallery"><![CDATA[{{if !empty( $images ) }}
	<h3 class='ipsType_reset ipsWidget_title'>{$title}</h3>
        {{if $orientation == 'horizontal'}}
            <div class='ipsWidget_inner ipsPad'>
        {{else}}
            <div class='ipsWidget_inner'>
        {{endif}}
		{{if $orientation == 'vertical'}}
			<div class='ipsPad_half'>
				<ul class='ipsList_reset cGalleryWidgetList'>
					{{foreach $images as $image}}
						{template="imageRow" group="widgets" app="gallery" params="$image, $orientation"}
					{{endforeach}}
				</ul>
			</div>
		{{else}}
        <div class='ipsCarousel ipsClearfix' data-ipsCarousel data-ipsCarousel-showDots>
			<ul class='cGalleryCarousel ipsGrid ipsGrid_collapsePhone' data-role="carouselItems">
				{{foreach $images as $idx => $image}}
					{template="imageRow" group="widgets" app="gallery" params="$image, $orientation"}
				{{endforeach}}
			</ul>
            <span class='ipsCarousel_shadow ipsCarousel_shadowLeft'></span>
            <span class='ipsCarousel_shadow ipsCarousel_shadowRight'></span>
            <a href='#' class='ipsCarousel_nav ipsHide' data-action='prev'><i class='fa fa-chevron-left'></i></a>
            <a href='#' class='ipsCarousel_nav ipsHide' data-action='next'><i class='fa fa-chevron-right'></i></a>
        </div>
		{{endif}}
	</div>
{{endif}}]]></template>
 <template template_group="widgets" template_name="imageRow" template_data="$image, $orientation='vertical'" template_location="front" template_app="gallery"><![CDATA[<li class='cGalleryWidget {{if $orientation == 'horizontal'}}ipsCarousel_item{{endif}}'>
	{{if $orientation == 'horizontal'}}
		{{if $image->medium_file_name}}
			<a href='{$image->url()}' title='{lang="view_this_image" sprintf="$image->caption"}' class='ipsThumb ipsThumb_bg ipsThumb_large' style='background-image: url("{file="$image->medium_file_name" extension="gallery_Images"}");'>
				<img src='{file="$image->medium_file_name" extension="gallery_Images"}' alt=''>
			</a>
		{{else}}
			<a href='{$image->url()}' title='{lang="view_this_image" sprintf="$image->caption"}' class='ipsNoThumb ipsNoThumb_video ipsThumb_bg ipsThumb_large'></a>
		{{endif}}
	{{else}}
		{{if $image->medium_file_name}}
			<a href='{$image->url()}' title='{lang="view_this_image" sprintf="$image->caption"}' class='ipsThumb ipsThumb_bg cGalleryWidget_verticalThumb' style='background-image: url("{file="$image->medium_file_name" extension="gallery_Images"}");'>
				<img src='{file="$image->medium_file_name" extension="gallery_Images"}' alt=''>
			</a>
		{{else}}
			<a href='{$image->url()}' title='{lang="view_this_image" sprintf="$image->caption"}' class='ipsNoThumb ipsNoThumb_video ipsThumb_bg cGalleryWidget_verticalThumb'></a>
		{{endif}}
	{{endif}}
	{{if $image->directContainer()->allow_comments}}
		<div class="cGalleryWidget_comments {{if $image->comments === 0}}ipsFaded{{endif}}" data-ipsTooltip title='{lang="num_comments" pluralize="$image->comments"}'>
			<i class='fa fa-comment'></i> {$image->comments}
		</div>
	{{endif}}
	<div class='ipsSpacer_top ipsSpacer_half cGalleryWidgetInfo'>
		{{if $image->unread()}}
			<div class='ipsTruncate ipsTruncate_line'>
				<a href="{$image->url()}" title='{lang="view_this_image" sprintf="$image->caption"}' class='cGalleryWidget_title ipsType_medium'>
					<span class="ipsItemStatus ipsItemStatus_small"><i class="fa fa-circle"></i></span>
					<strong>{$image->caption}</strong>
				</a>
			</div>
		{{else}}
			<div class='ipsTruncate ipsTruncate_line'>
				<a href="{$image->url()}" title='{lang="view_this_image" sprintf="$image->caption"}' class='cGalleryWidget_title ipsType_medium'>
					{$image->caption}
				</a>
			</div>
		{{endif}}
		<span class='ipsType_medium ipsType_blendLinks'>{lang="byline_nodate" htmlsprintf="$image->author()->link()"}</span><br>
		<span class='ipsType_light ipsType_medium'>{datetime="$image->mapped('date')"}</span>
	</div>
</li>]]></template>
 <template template_group="widgets" template_name="latestImage" template_data="$latestImage, $orientation='vertical'" template_location="front" template_app="gallery"><![CDATA[<div id='elGalleryStatsLatest' class='ipsClearfix cGalleryWidget'>
	<strong class='ipsType_minorHeading'>{lang="latest_image"}</strong><br>
	{{if $latestImage->medium_file_name}}
		<a href='{$latestImage->url()}' title='{lang="view_this_image" sprintf="$latestImage->caption"}' class='ipsThumb ipsThumb_bg cGalleryWidget_verticalThumb' style='background-image: url("{file="$latestImage->medium_file_name" extension="gallery_Images"}");'>
			<img src='{file="$latestImage->medium_file_name" extension="gallery_Images"}' alt=''>
		</a>
	{{else}}
		<a href='{$latestImage->url()}' title='{lang="view_this_image" sprintf="$latestImage->caption"}' class='ipsNoThumb ipsNoThumb_video ipsThumb_bg cGalleryWidget_verticalThumb'></a>
	{{endif}}
	<div class='ipsSpacer_top ipsSpacer_half cGalleryWidgetInfo'>
		{{if $latestImage->directContainer()->allow_comments}}
		<div class="ipsCommentCount ipsPos_right {{if $latestImage->comments === 0}}ipsFaded{{endif}}" data-ipsTooltip title='{lang="num_comments" pluralize="$latestImage->comments"}'>
			{$latestImage->comments}
		</div>
		{{endif}}
		{{if $latestImage->unread()}}
		<div class='ipsTruncate ipsTruncate_line'>
			<a href="{$latestImage->url()}" title='{lang="view_this_image" sprintf="$latestImage->caption"}' class='cGalleryWidget_title ipsType_medium'>
				<span class="ipsItemStatus ipsItemStatus_small"><i class="fa fa-circle"></i></span>
				<strong>{$latestImage->caption}</strong>
			</a>
		</div>
		{{else}}
		<div class='ipsTruncate ipsTruncate_line'>
			<a href="{$latestImage->url()}" title='{lang="view_this_image" sprintf="$latestImage->caption"}' class='cGalleryWidget_title ipsType_medium'>
				{$latestImage->caption}
			</a>
		</div>
		{{endif}}
		<span class='ipsType_medium ipsType_blendLinks'>{lang="byline_nodate" htmlsprintf="$latestImage->author()->link()"}</span><br>
		<span class='ipsType_light ipsType_medium'>{datetime="$latestImage->mapped('date')"}</span>
	</div>
</div>
]]></template>
 <template template_group="widgets" template_name="recentComments" template_data="$comments, $title, $orientation='vertical'" template_location="front" template_app="gallery"><![CDATA[{{if !empty( $comments ) }}
	<h3 class='ipsType_reset ipsWidget_title'>{$title}</h3>
	<div class='ipsPad_half ipsWidget_inner'>
		<ul class='ipsDataList ipsDataList_reducedSpacing'>
			{{foreach $comments as $comment}}
				<li class='ipsDataItem'>
					<div class='ipsDataItem_icon ipsPos_top'>
						{template="thumbImage" group="global" app="core" params="$comment->item()->thumb_file_name, $comment->item()->caption, 'tiny', '', 'view_this', '', 'gallery_Images'"}
					</div>
					<div class='ipsDataItem_main'>
						<div class='ipsContained ipsType_break'><a href="{$comment->url()}" title='{lang="view_this_image" sprintf="$comment->item()->caption"}' class='ipsType_medium ipsTruncate ipsTruncate_line'>{$comment->item()->caption}</a></div>
						<p class='ipsType_reset ipsType_light ipsType_medium ipsType_blendLinks'>{lang="byline_nodate" htmlsprintf="$comment->author()->link()"} &middot; <a href="{$comment->url()}" class='ipsDataItem_title ipsType_break ipsType_blendLinks'>{$comment->dateLine()|raw}</a></p>
						<div class='ipsType_richText ipsType_medium ipsSpacer_top ipsSpacer_half ipsType_break' data-ipsTruncate data-ipsTruncate-type="remove" data-ipsTruncate-size="2 lines">
							{$comment->truncated()|raw}
						</div>
					</div>
				</li>
			{{endforeach}}
		</ul>
	</div>
{{endif}}]]></template>
 <template template_group="widgets" template_name="recentImageReviews" template_data="$comments, $title, $orientation='vertical'" template_location="front" template_app="gallery"><![CDATA[{{if !empty( $comments ) }}
	<h3 class='ipsType_reset ipsWidget_title'>{$title}</h3>
	<div class='ipsPad_half ipsWidget_inner'>
		<ul class='ipsDataList ipsDataList_reducedSpacing'>
			{{foreach $comments as $comment}}
				<li class='ipsDataItem'>
					<div class='ipsDataItem_generic ipsDataItem_size1'>
						{template="thumbImage" group="global" app="core" params="$comment->item()->thumb_file_name, $comment->item()->caption, 'tiny', '', 'view_this', '', 'gallery_Images'"}
					</div>
					<div class='ipsDataItem_main'>
						<div class='ipsContained ipsType_break'><a href="{$comment->url()}" title='{lang="view_this_image" sprintf="$comment->item()->caption"}' class='ipsType_medium ipsTruncate ipsTruncate_line'>{$comment->item()->caption}</a></div>
						<p class='ipsType_reset ipsType_light ipsType_medium ipsType_blendLinks'>{lang="byline_nodate" htmlsprintf="$comment->author()->link()"}</p>
						{template="rating" group="global" location="front" app="core" params="'small', $comment->rating, \IPS\Settings::i()->reviews_rating_out_of"}
						<div class='ipsType_richText ipsType_medium ipsSpacer_top ipsSpacer_half' data-ipsTruncate data-ipsTruncate-type="remove" data-ipsTruncate-size="2 lines">
							{$comment->truncated()|raw}
						</div>
					</div>
				</li>
			{{endforeach}}
		</ul>
	</div>
{{endif}}]]></template>
 <css css_location="front" css_app="gallery" css_attributes="" css_path="." css_name="embed.css">/* NEW EMBED */
.cGalleryEmbed a {
	display: block;
}

..cGalleryEmbed_albumStrip {
	white-space: nowrap;
}

.cGalleryEmbed_albumStrip li {
	width: 20%;
	min-width: 40px;
	float: left;
	position: relative;
}
	
	.cGalleryEmbed_albumStrip_mini li {
		width: 10%;
		min-width: 40px;
	}

	.cGalleryEmbed_albumStrip li:after {
		content: '';
		display: block;
		padding-bottom: 100%;
	}

.cGalleryEmbed_albumStrip li a {
	background-repeat: no-repeat;
	background-position: center;
	background-size: cover;
	position: absolute;
	top: 0;
	left: 0;
	right: 1px;
	bottom: 1px;
	line-height: 90px;
	font-size: 20px;
	text-align: center;
	color: #000;
	display: block;
}

	.cGalleryEmbed_albumStrip_mini li a {
		line-height: 48px;
		font-size: 15px;
	}

	.cGalleryEmbed_albumStrip li a span {
		opacity: 0.3;
	}

.cGalleryEmbed_albumStrip:not( .cGalleryEmbed_albumStrip_mini ) {
	margin: -30px 7px 0;
	border: 1px solid rgba(0,0,0,0.05);
}

.ipsRichEmbed_mastheadBg.cGalleryEmbed_imageComment a {
	height: 220px;
}

/* OLD EMBED */
.ipsEmbedded .cGalleryTrimmedImage {
	background-color: #333;
	background-size: cover;
	background-position: 50%;
	background-repeat: no-repeat;
	overflow: hidden;
}

	.ipsEmbedded .cGalleryTrimmedImage img {
		display: none;
	}

	.ipsEmbedded .cGalleryTrimmedImage a {
		width: 120px;
		height: 120px;
		display: block;
	}

.ipsEmbedded .cGallery_albumImages {
	margin-top: 5px;
}

.ipsEmbedded .cGallery_albumImage a {
	width: 40px;
	height: 40px;
	border: 2px solid #fff;
}

.ipsEmbedded .cGallery_albumStats {
	color: #fff;
	font-weight: bold;
	position: absolute;
	bottom: 5px;
	text-shadow: 0px 1px 0px rgba(0,0,0,0.5);
}
html[dir=&quot;ltr&quot;] .ipsEmbedded .cGallery_albumStats {
	right: 5px;
}
html[dir=&quot;rtl&quot;] .ipsEmbedded .cGallery_albumStats {
	left: 5px;
}</css>
 <css css_location="front" css_app="gallery" css_attributes="" css_path="." css_name="gallery_responsive.css"><![CDATA[/* PHONES */
@media screen and (max-width: 767px) {
	.ipsApp .cGalleryAlbums_recent {
		padding: 0;
	}

	.cGalleryAlbums_recent > ul {
		height: 134px;
	}
	html[dir="ltr"] .cGalleryAlbums_recent > ul {
		padding-left: 138px;
	}
	html[dir="rtl"] .cGalleryAlbums_recent > ul {
		padding-right: 138px;
	}

	.cGalleryAlbums_recent > ul > li:first-child,
	.cGalleryAlbums_recent > ul > li:first-child a {
		width: 134px;
		height: 134px;
	}

	.cGalleryAlbums_recent > ul > li,
	.cGalleryAlbums_recent > ul > li a {
		width: 65px;
		height: 65px;
	}

	/* IMAGE VIEW */
	#elGalleryHeader {
		margin: -10px -10px 0 -10px;
	}

	.cGalleryAlbumSlider_wrapper {
		width: 265px;
	}

	.cGalleryAlbumSlider li {
		width: 38px;
		height: 38px;
	}

	#elGalleryNav a[data-action] {
		font-size: 30px;
		position: relative;
		top: -5px;
	}

	body[data-pageapp="gallery"][data-pagecontroller="view"] .cWidgetContainer:not( .ipsHide ) + div #elGalleryHeader {
		margin-top: 10px;
	}

	.ipsStreamItem_condensed.ipsStreamItem.ipsStreamItem_contentBlock.cGalleryAlbumSearchResult {
		padding-bottom: 40px;
	}

	.cGalleryRowsList .ipsThumb.ipsThumb_medium.ipsThumb_bg {
		max-width: 100%;
		width: 100%;
		margin-bottom: 7px;
	}

	html[dir="ltr"] .cGalleryRowsList .ipsDataItem_main {
		padding-left: 0;
	}
	html[dir="rtl"] .cGalleryRowsList .ipsDataItem_main {
		padding-right: 0;
	}

	html[dir="ltr"] .cGalleryRowsList .ipsDataItem_modCheck {
		right: 10px;
		left: auto;
		top: 150px;
	}
	html[dir="rtl"] .cGalleryRowsList .ipsDataItem_modCheck {
		left: 10px;
		right: auto;
		top: 150px;
	}
	
	html[dir="ltr"] ul.cGallerySearchAlbumThumbs.ipsList_inline {
		margin-left: 0px;
	}
	html[dir="rtl"] ul.cGallerySearchAlbumThumbs.ipsList_inline {
		margin-right: 0px;
	}
}]]></css>
 <css css_location="front" css_app="gallery" css_attributes="" css_path="." css_name="gallery.css"><![CDATA[/* Gallery rework */
#elGalleryHeader {
	margin: 10px 0 15px 0;
}

#elGalleryImage {
	background: #333333;
	min-height: 300px;
	padding: 20px;
	position: relative;
	text-align: center;
}

#elGalleryNav {
	padding: 10px;
	background: #222;
	min-height: 90px;
	text-align: center;
	color: #9f9f9f;
	font-size: 11px;
}
	
	.cGalleryAlbumSlider_wrapper {
		width: 350px;
		overflow: hidden;
		position: relative;
		height: 50px;
	}

	.cGalleryAlbumSlider {
		display: inline-block;
		white-space: nowrap;
		font-size: 0px !important;
		position: absolute;
		top: 0;
	}
	html[dir="ltr"] .cGalleryAlbumSlider {
		left: 0;
	}
	html[dir="rtl"] .cGalleryAlbumSlider {
		right: 0;
	}

		.cGalleryAlbumSlider .cGalleryTrimmedImage {
			background-color: #222;
		}

		.cGalleryAlbumSlider li {
			display: inline-block;
			width: 50px;
			height: 50px;
			overflow: hidden;
		}
			
			.cGalleryAlbumSlider li {
				border: 2px solid #222;
				background-size: cover;
				background-position: 50% 50%;
			}

				.cGalleryAlbumSlider li.cGalleryAlbumSlider_active {
					border-color: #5490c0;
				}

			.cGalleryAlbumSlider li a {
				display: block;
				height: 100%;
			}

			html[dir="ltr"] .cGalleryAlbumSlider li:last-child {
				margin-right: 0;
			}
			html[dir="rtl"] .cGalleryAlbumSlider li:last-child {
				margin-left: 0;
			}

			#elGalleryNav > ul > li {
				margin: 0;
			}

			#elGalleryNav a[data-action] {
				width: 17px;
				text-align: center;
				line-height: 50px;
				font-size: 28px;
				color: #fff;
				{prefix="transition" value="0.1s all linear"}
			}

				#elGalleryNav a[data-action][data-disabled] {
					cursor: default;
					opacity: 0.2;
				}

		.cGalleryAlbumSlider .ipsAreaBackground {
			background: rgba(0,0,0,0.2);
		}

.cGalleryMiniAlbum li {
	position: relative;
}

	.cGalleryMiniAlbum li a {
		position: absolute;
		top: 0;
		left: 0;
		bottom: 0;
		right: 0;
	}

#elGalleryImageStats [data-ipsRating] > .ipsRating {
	float: none;
}

#elGalleryImageNav a {
	position: absolute;
	color: #fff;
	font-size: 60px;
	top: 50%;
	margin-top: -30px;
	padding: 0 15px;
}

	html[dir="ltr"] #elGalleryImageNav_prev {
		left: 0px;
	}
	html[dir="rtl"] #elGalleryImageNav_prev {
		right: 0px;
	}

	html[dir="ltr"] #elGalleryImageNav_next {
		right: 0px;
	}
	html[dir="rtl"] #elGalleryImageNav_next {
		left: 0px;
	}

/* PATCHWORK */
.cGalleryPatchwork_item {
	display: block;
	float: left;
	background-size: cover;
	background-color: #333;
	position: relative;
	overflow: hidden;
	text-shadow: 1px 1px 0px rgba(0,0,0,0.8);
	text-align: left;
	transition: 0.1s transform ease-in-out;
}
html[dir="rtl"] .cGalleryPatchwork_item {
	float: right;
	text-align: right;
}
	
	.cGalleryPatchwork_item > a {
		position: absolute;
		display: block;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
	}

	.cGalleryPatchwork_item [data-role='moderation'] {
		position: absolute;
		top: 5px;
	}
	html[dir="ltr"] .cGalleryPatchwork_item [data-role='moderation'] {
		right: 5px;
	}
	html[dir="rtl"] .cGalleryPatchwork_item [data-role='moderation'] {
		left: 5px;
	}

	.cGalleryPatchwork_item [data-commentCount='0'] {
		opacity: 0.3;
	}

	.cGalleryPatchwork_item.ipsNoThumb {
		text-shadow: none;
	}

.cGalleryPatchwork_image {
	position: absolute;
	top: 0;
	width: 100%;
	height: 100%;
}
html[dir="ltr"] .cGalleryPatchwork_image {
	left: 0;
}
html[dir="ltr"] .cGalleryPatchwork_image {
	right: 0;
}

.cGalleryPatchwork_item .ipsPhotoPanel {
	position: absolute;
	background: rgba(0,0,0,0.8);
	width: 100%;
	top: 0;
	line-height: 1.2;
	height: 42px;
	color: #fff;
	{prefix="transition" value="opacity 0.1s linear"}
}
html[dir="ltr"] .cGalleryPatchwork_item .ipsPhotoPanel {
	left: 0;
	padding: 7px 7px 0 7px;
}
html[dir="rtl"] .cGalleryPatchwork_item .ipsPhotoPanel {
	right: 0;
	padding: 7px 7px 0 7px;
}

	.cGalleryPatchwork_item .ipsPhotoPanel span {
		line-height: inherit;
		display: block;
		width: 100%;
		white-space: nowrap;
		text-overflow: ellipsis;
	}

	.cGalleryPatchwork_item .ipsPhotoPanel span + span {
		opacity: 0.7;
	}

	.cGalleryPatchwork_item:hover {
		transform: scale(1.05);
		z-index: 2000;
	}

/* Image list patchwork */
.cGalleryPatchwork_list .cGalleryPatchwork_stats {
	position: absolute;
	bottom: 0;
	left: 0;
	right: 0;
	font-size: 13px;
	color: #fff;
	padding: 7px;
	background: -moz-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,0.6) 100%);
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(0,0,0,0)), color-stop(100%,rgba(0,0,0,0.6)));
	background: -webkit-linear-gradient(top, rgba(0,0,0,0) 0%,rgba(0,0,0,0.6) 100%);
	background: -o-linear-gradient(top, rgba(0,0,0,0) 0%,rgba(0,0,0,0.6) 100%);
	background: -ms-linear-gradient(top, rgba(0,0,0,0) 0%,rgba(0,0,0,0.6) 100%);
	background: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.6) 100%);
}

/* Featured/New patchwork */
ol.cGalleryPatchwork_index.ipsPad, ol.cGalleryPatchwork_list.ipsPad {
	padding-top: 11px;
	padding-bottom: 11px;
}

.cGalleryPatchwork_index .cGalleryPatchwork_item .cGalleryPatchwork_comments {
	position: absolute;
	bottom: 7px;
	color: #fff;
	font-size: 12px;
}
html[dir="ltr"] .cGalleryPatchwork_index .cGalleryPatchwork_item .cGalleryPatchwork_comments {
	right: 7px;
}
html[dir="rtl"] .cGalleryPatchwork_index .cGalleryPatchwork_item .cGalleryPatchwork_comments {
	left: 7px;
}

/* CATEGORIES */	
.cGalleryCats > .ipsGrid {
	margin-bottom: -15px;
}

.cGalleryCat > a {
	display: block;
	height: 150px;
	position: relative;
	color: #fff;
}
	
	.cGalleryCat > a:before {
		content: '';
		display: block;
		position: absolute;
		bottom: 0;
		left: 0;
		right: 0;
		height: 53px;
		background: rgba(0,0,0,0.8);
	}
	
	.cGalleryCat .ipsType_sectionHead,
	.cGalleryCat .cGalleryCat_info {
		position: absolute;
		left: 7px;
		right: 7px;
		text-shadow: 1px 1px 1px rgba(0,0,0,1);
	}

		.cGalleryCat .cGalleryCat_info > li:first-child {
			position: absolute;
			top: 0;
		}

	.cGalleryCat .ipsType_sectionHead {
		bottom: 23px;
		color: #fff;
		font-size: 15px;
	}

	.cGalleryCat .cGalleryCat_info {
		bottom: 7px;
		font-size: 11px;
	}

/* ALBUM LIST IN A CATEGORY */
.cGalleryAlbums > li:not( :last-child ) {
	margin-bottom: 7px;
}

.cGalleryAlbums_recent > ul {
	height: 204px;
	position: relative;
	overflow: hidden;
}
html[dir="ltr"] .cGalleryAlbums_recent > ul {
	padding-left: 208px;
}
html[dir="rtl"] .cGalleryAlbums_recent > ul {
	padding-right: 208px;
}

.cGalleryAlbums_recent > ul > li {
	width: 100px;
	height: 100px;
	float: left;
	position: relative;
	margin: 0 0 4px 4px;
}
html[dir="rtl"] .cGalleryAlbums_recent > ul > li {
	float: right;
	margin: 0 4px 4px 0;
}
	
	.cGalleryAlbums_recent > ul > li a {
		display: block;
		width: 100px;
		height: 100px;
	}

	.cGalleryAlbums_recent > ul > li span {
		padding-right: 7px;
		text-align: right;
		font-size: 11px;
		font-weight: bold;
		color: #fff;
		position: absolute;
		left: 0;
		right: 0;
		bottom: 0;
		line-height: 26px;
		text-shadow: 1px 1px 0px rgba(0,0,0,0.8);
		background-image: -moz-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,0.6) 100%);
		background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(0,0,0,0)), color-stop(100%,rgba(0,0,0,0.6)));
		background-image: -webkit-linear-gradient(top, rgba(0,0,0,0) 0%,rgba(0,0,0,0.6) 100%);
		background-image: -o-linear-gradient(top, rgba(0,0,0,0) 0%,rgba(0,0,0,0.6) 100%);
		background-image: -ms-linear-gradient(top, rgba(0,0,0,0) 0%,rgba(0,0,0,0.6) 100%);
		background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.6) 100%);
	}
	html[dir="rtl"] .cGalleryAlbums_recent > ul > li span {
		text-align: left;
	}

	.cGalleryAlbums_recent > ul > li img {
		display: none;
	}

	.cGalleryAlbums_recent > ul > li:first-child {
		width: 204px;
		height: 204px;
		overflow: hidden;
		position: absolute;
	}
	html[dir="ltr"] .cGalleryAlbums_recent > ul > li:first-child {
		left: 0;
	}
	html[dir="rtl"] .cGalleryAlbums_recent > ul > li:first-child {
		right: 0;
	}

		.cGalleryAlbums_recent > ul > li:first-child a {
			width: 204px;
			height: 204px;
		}

html[dir="ltr"] .cGalleryEvents .ipsDataList .ipsDataItem,
html[dir="ltr"] .cGalleryEvents .ipsDataList .ipsDataItem_icon {
	padding-left: 0 !important;
}
html[dir="rtl"] .cGalleryEvents .ipsDataList .ipsDataItem,
html[dir="rtl"] .cGalleryEvents .ipsDataList .ipsDataItem_icon {
	padding-right: 0 !important;
}

.cGalleryImageList > li {
	padding: 7px;
	border: 1px solid rgba(0,0,0,0.05);
}

	.cGalleryImageList > li > div {
		width: 100%;
		margin-bottom: 5px;
	}

		/* For non-js, we need a fixed height because the JS won't be handling it */
		.ipsJS_none .cGalleryImageList > li > div {
			height: 180px;
		}

		.cGalleryImageList > li > div + ul {
			height: 26px;
			line-height: 24px;
		}

.cGalleryImageItem.cGalleryImageItem_selected {
	background-color: {theme="selected"};
}

.cGalleryImageItem_image {
	display: block;
	position: relative;
	max-width: 100%;
	height: 100%;
}

.cGalleryLargeList > li {
	margin-bottom: 15px;
	border: 1px solid rgba(0,0,0,0.05);
}

	.cGalleryLargeList > li img {
		display: block;
		margin: 0 auto 10px auto;
	}

/* IMAGE VIEW PAGE */
.cGalleryViewImage {
	/* Needed for FF & IE */
	display: inline-block;
	/*table-layout: fixed;
	width: 100%;
	min-height: 100%;*/
	/* -- */
	position: relative;
	margin-bottom: 5px;
}
	
	.cGalleryViewImage_controls {
		position: absolute;
		top: 15px;
		opacity: 0;
		{prefix="transition" value="0.3s all linear"}
	}
	html[dir="ltr"] .cGalleryViewImage_controls {
		right: 15px;
	}
	html[dir="rtl"] .cGalleryViewImage_controls {
		left: 15px;
	}

		#elGalleryImage:hover .cGalleryViewImage_controls {
			opacity: 1;
		}

.cGalleryViewImage_options {
	margin-bottom: 5px;
}
	
.cGalleryExif .fa-camera {
	font-size: 42px;
	line-height: 58px;
}

.cGalleryExif_data {
	margin: 5px 0;
}

	.cGalleryExif_data li {
		border: 2px solid #5d5d5d;
		border-radius: 5px;
		line-height: 20px;
		height: 24px;
		font-size: 12px;
		font-weight: bold;
		margin: 4px 2px;
	}
	html[dir="ltr"] .cGalleryExif_data li {
		padding-right: 6px;
	}
	html[dir="rtl"] .cGalleryExif_data li {
		padding-left: 6px;
	}

		.cGalleryExif_data li span {
			background: #5d5d5d;
			color: #fff;
			width: 30px;
			font-size: 15px;
			display: inline-block;
			text-align: center;
		}
		html[dir="ltr"] .cGalleryExif_data li span {
			float: left;
			padding: 0 8px 0 6px;
			margin-right: 6px;
		}
		html[dir="rtl"] .cGalleryExif_data li span {
			float: right;
			padding: 0 6px 0 8px;
			margin-left: 6px;
		}

	.cGalleryExif .cGalleryExif_f {
		font-family: 'Palatino', 'Times New Roman';
		font-style: italic;
		font-weight: bold;
	}

	.cGalleryExif .cGalleryExif_iso {
		font-size: 11px;
		padding: 0;
	}

/* IMAGE SIZES */
#elGalleryImage_sized {
	margin: 15px 0;
	background: #333333;
	padding: 15px;
	text-align: center;
}

/* NOTES */
.cGalleryViewImage_addNote {
	cursor: crosshair;
}

.cGalleryViewImage:hover .cGalleryNote {
	opacity: 1;
}

.cGalleryNote {
	position: absolute;
	opacity: 0;
}

.cGalleryNote_border {
	border: 1px solid #000;
	height: 100%;
	background: rgba(255,255,255,0.0001);
}

	.cGalleryNote_border:after {
		position: absolute;
		left: 1px;
		right: 1px;
		top: 1px;
		bottom: 1px;
		content: '';
		display: block;
		border: 1px solid #ccc;
	}

	.cGalleryNote_editing .cGalleryNote_border,
	.cGalleryNote_editing .cGalleryNote_border:after {
		border-style: dashed;
		opacity: 1;
	}

.cGalleryNote_editing {
	opacity: 1 !important;
}

	.cGalleryNote_editing .cGalleryNote_note {
		opacity: 1 !important;
		display: block !important;
		max-width: 220px;
		width: 220px;
		padding: 4px;
		pointer-events: auto;
		z-index: 1000;
	}

		.cGalleryNote_editing .cGalleryNote_note ul {
			text-align: left;
			margin-top: 5px;
		}
		html[dir="rtl"] .cGalleryNote_editing .cGalleryNote_note ul {
			text-align: right;
		}

		.cGalleryNote_editing .cGalleryNote_note a {
			color: #fff;
		}

		.cGalleryNote_editing .cGalleryNote_note textarea {
			font-size: 11px;
			color: #000;
		}

.cGalleryNote_note {
	max-width: 200px;
	padding: 4px 10px;
	position: absolute;
	top: 100%;
	margin-top: 5px;
	background: #2a2a2a;
	color: #fff;
	font-size: 12px;
	border-radius: 2px;
	pointer-events: none;
}
html[dir="ltr"] .cGalleryNote_note {
	left: 0px;
}
html[dir="rtl"] .cGalleryNote_note {
	right: 0px;
}

.cGalleryNote_delete { 
	position: absolute;
	top: -10px;
	width: 24px;
	height: 24px;
	line-height: 19px;
	border-radius: 12px;
	background: #000;
	border: 1px solid #fff;
	color: #fff;
	font-size: 17px;
}
html[dir="ltr"] .cGalleryNote_delete {
	right: -10px;
}
html[dir="rtl"] .cGalleryNote_delete {
	left: -10px;
}

/* jQuery resizable styles */
.ui-resizable-handle { position: absolute; font-size: 0.1px; display: block; }
.ui-resizable-disabled .ui-resizable-handle, .ui-resizable-autohide .ui-resizable-handle { display: none; }
.ui-resizable-n { cursor: n-resize;	height: 7px; width: 100%; top: -5px; left: 0; }
.ui-resizable-s { cursor: s-resize;	height: 7px; width: 100%; bottom: -5px;	left: 0; }
.ui-resizable-e { cursor: e-resize; width: 7px;	right: -5px; top: 0; height: 100%; }
.ui-resizable-w { cursor: w-resize;	width: 7px;	left: -5px;	top: 0;	height: 100%; }
.ui-resizable-se { cursor: se-resize; width: 12px; height: 12px; right: 1px; bottom: 1px; }
.ui-resizable-sw { cursor: sw-resize; width: 9px; height: 9px; left: -5px; bottom: -5px; }
.ui-resizable-nw { cursor: nw-resize; width: 9px; height: 9px; left: -5px; top: -5px; }
.ui-resizable-ne { cursor: ne-resize; width: 9px; height: 9px; right: -5px;	top: -5px; }
.ui-icon-gripsmall-diagonal-se {
	background: url( "{resource="resizable.png" app="core" location="global"}" );
}
.ui-draggable { cursor: move;}

/* General style which creates the square thumb container */
.cGalleryTrimmedImage {
	background-color: #333;
	background-size: cover;
	background-position: 50%;
	background-repeat: no-repeat;
	overflow: hidden;
}

	.cGalleryTrimmedImage img {
		display: none;
	}

.cGalleryThumb {
	max-width: 170px;
	max-height: 170px;
}

/* This is to make the video responsive in size
	See: http://3strandsmarketing.com/video-fluid-2.php */
.cGallery_videoContainer {
	position: relative;
	height: 100%;
}

	.cGallery_videoContainer .video-js {
		position: absolute;
		top: 0;
		width: 100%;
		height: 100%;
	}
	html[dir="ltr"] .cGallery_videoContainer .video-js {
		left: 0;
	}
	html[dir="rtl"] .cGallery_videoContainer .video-js {
		right: 0;
	}

ul.cGallerySearchAlbumThumbs.ipsList_inline,
ul.cGalleryManagedAlbumThumbs.ipsList_inline {
	position: absolute;
	bottom: 10px;
	overflow: hidden;
	width: 95%; /* Needs to account for margins added */
}
	ul.cGallerySearchAlbumThumbs.cGallerySearchExpanded.ipsList_inline,
	ul.cGalleryManagedAlbumThumbs.cGallerySearchExpanded.ipsList_inline {
		position: inherit;
	}
	
html[dir="ltr"] ul.cGallerySearchAlbumThumbs.ipsList_inline {
	margin-left: 85px;
}
html[dir="rtl"] ul.cGallerySearchAlbumThumbs.ipsList_inline {
	margin-right: 85px;
}

	html[dir="ltr"] ul.cGallerySearchAlbumThumbs.cGallerySearchExpanded.ipsList_inline {
		margin-left: 30px;
	}

	html[dir="rtl"] ul.cGallerySearchAlbumThumbs.cGallerySearchExpanded.ipsList_inline {
		margin-right: 30px;
	}

	html[dir="ltr"] ul.cGallerySearchAlbumThumbs.ipsList_inline > li,
	html[dir="ltr"] ul.cGalleryManagedAlbumThumbs.ipsList_inline > li {
		margin-right: 4px;
	}
	html[dir="rtl"] ul.cGallerySearchAlbumThumbs.ipsList_inline > li,
	html[dir="rtl"] ul.cGalleryManagedAlbumThumbs.ipsList_inline > li {
		margin-left: 4px;
	}
	 
		ul.cGallerySearchAlbumThumbs li span,
		ul.cGalleryManagedAlbumThumbs li span
		{
			max-width: 25px;
			max-height: 25px;
		}

]]></css>
 <css css_location="front" css_app="gallery" css_attributes="" css_path="." css_name="profile.css"><![CDATA[/* Styles used to display albums in profiles */

.cProfileAlbum {
	position: relative;
	z-index: 1;
}
	
	/*.cProfileAlbum:before, .cProfileAlbum:after {
		display: inline-block;
		content: '';
		width: 90%;
		height: 90%;
		position: absolute;
		background: #bbbbbb;
		z-index: -1;
		top: 0;
		left: 5%;
	}

		.cProfileAlbum:before {
			background: #dbdbdb;
			{prefix="transform" value="rotate(-3deg)"}
		}

		.cProfileAlbum:after {
			background: #ababab;
			{prefix="transform" value="rotate(4deg)"}
		}*/

	.cProfileAlbum > div {
		width: 100%;
		height: 100%;
		margin: 0 auto;
		border: 1px solid rgba(0,0,0,0.05);
	}

	.cProfileAlbum_image {
		display: block;
		position: relative;
		max-width: 100%;
		height: 100%;
		background-color: #333;
		background-size: cover;
		background-position: 50%;
		background-repeat: no-repeat;
		overflow: hidden;
	}

	.cProfileAlbum_image img {
		display: none;
	}

.cProfileAlbum .ipsType_sectionHead {
	font-size: 14px;
	text-align: left;
	display: block;
	padding: 7px;
	overflow: hidden;
	text-overflow: ellipsis;
	top: 0px;
	background: rgba(0,0,0,0.5);
	color: #fff;
}
]]></css>
 <css css_location="front" css_app="gallery" css_attributes="" css_path="." css_name="submit_responsive.css"><![CDATA[/* PHONES */
@media screen and (max-width: 767px) {
	/* Steps bar */
	.cGallerySteps {
		margin-top: 10px;
	}
		.cGallerySteps > li:not( .cGallerySteps_active ),
		.cGallerySteps > li span:before, .cGallerySteps > li span:after, .cGallerySteps > li a:before, .cGallerySteps > li a:after {
			display: none;
		}

		.cGallerySteps > li:before {
			display: inline-block;
			width: 32px;
			height: 32px;
			line-height: 32px;
			border-radius: 32px;
			vertical-align: middle;
			font-size: 18px;
			margin-right: 5px;
			margin-bottom: 0;
		}

	.cGalleryDialog_header {
		height: 65px;
	}

	.ipsDialog_content .cGalleryDialog_content {
		top: 65px;
	}

	/* Step 1: Choose album */
	.cGallerySubmit_albumChoice {
		margin-top: 0;
	}

		.cGallerySubmit_albumChoice > .ipsGrid_span6:first-child {
			margin-bottom: 30px;
		}

		#elGallerySubmit_albumChooser {
			min-height: none;
		}

	/* Step 2: Upload images */
	.cGallerySubmit_uploadImages .cGallerySubmit_bottomBar {
		height: 60px;
	}

	/* Info panel */
	.cGallerySubmit_strip, .cGallerySubmit_infoForm, .cGallerySubmit_bottomBar, .cGallerySubmit_infoPanel {
		position: absolute;
	}

	html[dir] .cGallerySubmit_strip {
		top: 0;
		left: 0;
		right: 0;
		width: auto;
		height: 100px;
		white-space: nowrap;
		overflow-y: hidden;
	}

		.cGallerySubmit_strip ul {
			white-space: nowrap;
			overflow: visible;
		}

		.cGallerySubmit_strip li {
			white-space: nowrap;
			margin-bottom: 0;
			margin-right: 15px;
			display: inline-block;
		}

		.cGallerySubmit_strip .cGalleryTrimmedImage {
			width: 70px;
			height: 70px;
			border-width: 3px;
		}

			.cGallerySubmit_strip .cGalleryTrimmedImage a {
				width: 70px;
				height: 70px;
			}

		.cGallerySubmit_strip .cGallerySubmit_current:after {
			display: none;	
		}
	html[dir] .cGallerySubmit_infoForm {
		position: absolute;
		top: 100px;
		bottom: 0;
		left: 0;
		right: 0;
		padding-left: 20px;
		padding-right: 20px;
	}

	/* Bottom bar of the image info step */
	.cGallerySubmit_bottomBar {
		height: 115px;
	}

	#elGallerySubmit_bottomBar > ul {
		display: block;
	}

		/* Reset all items so they're blocks */
		#elGallerySubmit_bottomBar > ul > li {
			display: block;
			margin: 0;
		}

		/* Make buttons a bit smaller */
		#elGallerySubmit_bottomBar > ul > li .ipsButton {
			width: 100%;
			line-height: 32px;
			font-size: 12px;
		}

		/* Copyright/credit buttons - half-width so they share a line */
		#elGallerySubmit_bottomBar > ul > li:first-child,
		#elGallerySubmit_bottomBar > ul > li:first-child + li {
			width: 48%;
		}

		#elGallerySubmit_bottomBar > ul > li:first-child {
			float: left; /* Copyright - move left */
		}
		#elGallerySubmit_bottomBar > ul > li:first-child + li {
			float: right; /* Credit - move right */
		}

		/* Notify option - add padding */
		#elGallerySubmit_bottomBar > ul > li:first-child + li + li {
			clear: both;
			padding: 7px 0;
		}

			/* Notify option - make toggle a bit smaller (and the text) */
			#elGallerySubmit_bottomBar > ul > li:first-child + li + li .ipsToggle {
				zoom: 0.8;
			}
			#elGallerySubmit_bottomBar > ul > li:first-child + li + li label {
				font-size: 12px;
			}

		/* Main submit button */
		#elGallerySubmit_bottomBar > ul > li:last-child {
			float: none;
		}

	.ipsApp button.cGallerySubmit_button {
		position: static;
	}

		.ipsApp button.cGallerySubmit_button.cGallerySubmit_prevButton {
			float: left;
		}
		.ipsApp button.cGallerySubmit_button.cGallerySubmit_nextButton {
			float: right;
		}
}]]></css>
 <css css_location="front" css_app="gallery" css_attributes="" css_path="." css_name="submit.css"><![CDATA[.cGalleryDialog_header {
	height: 100px;
}

/* Step bar */
.cGallerySteps {
	display: table;
	max-width: 1000px;
	margin: 0 auto;
}
	
	.cGallerySteps > li {
		display: table-cell;
		width: 1%;
		text-align: center;
		position: relative;
		margin-top: 35px;
	}

	.cGallerySteps > li:before {
		content: attr( data-step );
		font-size: 22px;
		font-weight: 300;
		display: block;
		width: 42px;
		height: 42px;
		line-height: 42px;
		border-radius: 42px;
		text-align: center;
		color: #fff;
		background: #b4b4b4;
		margin: 0 auto 5px auto;
		z-index: 2000;
		position: relative;
	}

		.cGallerySteps > li span,
		.cGallerySteps > li a {
			font-size: 14px;
			color: #b4b4b4;
		}

		.cGallerySteps > li span:before,
		.cGallerySteps > li span:after,
		.cGallerySteps > li a:before,
		.cGallerySteps > li a:after {
			content: '';
			display: block;
			height: 6px;
			background: #b4b4b4;
			position: absolute;
			top: 19px;
			width: 50%;
		}

		html[dir="ltr"] .cGallerySteps > li span:before,
		html[dir="ltr"] .cGallerySteps > li a:before,
		html[dir="rtl"] .cGallerySteps > li span:after,
		html[dir="rtl"] .cGallerySteps > li a:after {
			left: 0;
		}

			.cGallerySteps > li:first-child span:before,
			.cGallerySteps > li:first-child a:before,
			.cGallerySteps > li:last-child span:after,
			.cGallerySteps > li:last-child a:after {
				display: none;
			}

		html[dir="rtl"] .cGallerySteps > li span:before,
		html[dir="rtl"] .cGallerySteps > li a:before,
		html[dir="ltr"] .cGallerySteps > li span:after,
		html[dir="ltr"] .cGallerySteps > li a:after {
			right: 0;
		}

		/* Done steps */
		.cGallerySteps > li.cGallerySteps_done:before {
			background: {theme="step_background"};
			font-family: 'FontAwesome';
			content: '\f00c';
		}

			.cGallerySteps > li.cGallerySteps_done span:after,
			.cGallerySteps > li.cGallerySteps_done + li span:before,
			.cGallerySteps > li.cGallerySteps_done a:after,
			.cGallerySteps > li.cGallerySteps_done + li a:before,
			.cGallerySteps > li.cGallerySteps_active:before {
				background: {theme="step_background"};
			}

			.cGallerySteps > li.cGallerySteps_active span,
			.cGallerySteps > li.cGallerySteps_active a {
				font-weight: bold;
			}

		.cGallerySteps > li.cGallerySteps_done span,
		.cGallerySteps > li.cGallerySteps_active span,
		.cGallerySteps > li.cGallerySteps_done a,
		.cGallerySteps > li.cGallerySteps_active a {
			color: #222;
		}

/* Step 1: Choose album */
.cGallerySubmit_albumChoice {
	max-width: 1100px;
	margin: 20px auto 0;
}

	.cGallerySubmit_albumChoice .ipsSelectTree {
		margin: 0 auto;
	}

#elGallerySubmit_albumChooser {
	min-height: 200px;
	max-height: 200px;
	overflow: auto;
}
	
	html[dir="ltr"] #elGallerySubmit_albumChooser {
		padding-right: 15px;
	}
	html[dir="rtl"] #elGallerySubmit_albumChooser {
		padding-left: 15px;
	}

	#elGallerySubmit_albumChooser > li > div {
		position: relative;
		border: 1px solid rgba(0,0,0,0.1);
		border-radius: 3px;
		margin-bottom: 7px;
	}

		#elGallerySubmit_albumChooser > li > div ul.ipsType_medium {
			line-height: 1;
		}

	#elGallerySubmit_albumChooser > li > div:hover {
		background: #e4eff7;
		cursor: pointer;
	}

	#elGallerySubmit_albumChooser > li > input[type="radio"]:checked + div {
		background: #5490c0;
		color: #fff;
	}

		#elGallerySubmit_albumChooser > li > input[type="radio"]:checked + div:before {
			content: '\f00c';
			font-family: "FontAwesome";
			font-size: 36px;
			position: absolute;
			top: 17px;
			opacity: 0.6;
			color: #fff;
		}

			html[dir="ltr"] #elGallerySubmit_albumChooser > li > input[type="radio"]:checked + div:before {
				right: 17px;
			}
			html[dir="rtl"] #elGallerySubmit_albumChooser > li > input[type="radio"]:checked + div:before {
				left: 17px;
			}

		#elGallerySubmit_albumChooser > li > input[type="radio"]:checked + div .ipsType_light {
			color: #fff;
			opacity: 0.7;
		}

.cGallerySubmit_albumImage {
	width: 40px;
	height: 40px;
	background-color: rgba(0,0,0,0.3);
}

	html[dir="ltr"] .cGallerySubmit_albumImage {
		float: left;
	}
	html[dir="rtl"] .cGallerySubmit_albumImage {
		float: right;
	}

html[dir="ltr"] .cGallerySubmit_albumInfo {
	margin-left: 47px;
}
html[dir="rtl"] .cGallerySubmit_albumInfo {
	margin-right: 47px;
}

.cGallerySubmit_chooseCategory {
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	right: 0;
	overflow: auto;
}

/* Step 2: Upload files */
.cGallerySubmit_uploadImages {
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	right: 0;
}
.cGallerySubmit_uploadForm {
	position: absolute;
	top: 0;
	bottom: 75px;
	left: 0;
	right: 0;
	overflow: auto;
}

.cGallerySubmit_uploadImages > form {
	height: 100%;
}
.cGallerySubmit_uploadImages .ipsAttachment_dropZone {
	border-width: 6px;
	border-style: dashed;
	{prefix="transition" value="none"}
}

.cGallerySubmit_uploadImages .ipsAttachment_dropZone:not( .ipsDragging ) {
	background: transparent;
	border-color: #e0e0e0;
}

/* Positioning required to make the dialog full screen */
.cGalleryDialog_content {
	position: relative;
	height: 600px;
}

	/* But if we're in a dialog, change the styles to make everything faaaancy */
	.ipsDialog_content .cGalleryDialog_content {
		position: absolute;
		top: 100px;
		bottom: 0;
		left: 0;
		right: 0;
		height: auto;
	}
	
	.ipsDialog_content .cGalleryDialog_content.cGalleryDialog_content_moderated {
		top: 150px;
	}
	
.cGallerySubmit_uploadImages > form > .ipsGrid {
	position: absolute;
	top: 30px;
	left: 30px;
	bottom: 70px;
	right: 30px;
}

/* Step 3: Image info */

.cGallerySubmit_strip, .cGallerySubmit_infoForm, .cGallerySubmit_bottomBar, .cGallerySubmit_infoPanel {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
}

.cGallerySubmit_strip {
	width: 250px;
	overflow: auto;
	background: #212223;
}
	
	html[dir="ltr"] .cGallerySubmit_strip {
		right: auto;
	}
	html[dir="rtl"] .cGallerySubmit_strip {
		left: auto;
	}

.cGallerySubmit_infoForm {
	overflow: auto;
	padding-left: 60px;
	padding-right: 60px;
}

	html[dir="ltr"] .cGallerySubmit_infoForm {
		left: 250px;
	}
	html[dir="rtl"] .cGallerySubmit_infoForm {
		right: 250px;
	}
	
	.cGallerySubmit_infoForm > section {
		max-width: 1000px;
		margin: 0 auto;
	}

.cGallerySubmit_bottomBar {
	top: auto;
	border-top: 1px solid rgba(0,0,0,0.075);
	height: 75px;
}

.cGallerySubmit_infoPanel {
	bottom: 75px;
}

.cGallerySubmit_strip {
	text-align: center;
}

	.cGallerySubmit_strip li {
		display: inline-block;
		margin-bottom: 30px;
		position: relative;
	}

		.cGallerySubmit_strip li:not( .cGallerySubmit_current ) :hover {
			border-color: rgba(0,0,0,0.4);
		}

	.cGallerySubmit_strip .cGalleryTrimmedImage {
		width: 150px;
		height: 150px;
		margin: 0 auto;
		border: 5px solid transparent;
		background-color: #333;
		background-size: cover;
		background-position: 50%;
		background-repeat: no-repeat;
		overflow: hidden;
	}

		.cGallerySubmit_strip .cGalleryTrimmedImage a {
			width: 150px;
			height: 150px;
			display: block;
		}

		.cGallerySubmit_strip .cGalleryTrimmedImage img {
			display: none;
		}

	.cGallerySubmit_strip .cGallerySubmit_current .cGalleryTrimmedImage {
		border-color: #5490c0;
	}

		.cGallerySubmit_strip .cGallerySubmit_current:after {
			content: '';
			display: block;
			width: 0;
			height: 0;
			border-width: 20px;
			border-style: solid;
			position: absolute;
			top: 50%;
			margin-top: -20px;
		}

			html[dir="ltr"] .cGallerySubmit_strip .cGallerySubmit_current:after {
				border-color: transparent transparent transparent #5490c0;
				left: 100%;
			}
			html[dir="rtl"] .cGallerySubmit_strip .cGallerySubmit_current:after {
				border-color: transparent #5490c0 transparent transparent;
				right: 100%;
			}

.cGallerySubmit_done:not( .cGallerySubmit_current ) > div {
	opacity: 0.6;
}

.cGallerySubmit_done:before {
	display: block;
	content: "\f00c";
	font-family: "FontAwesome";
	border: 1px solid rgba(255,255,255,0.6);
	text-align: center;
	line-height: 30px;
	width: 30px;
	height: 30px;
	border-radius: 30px;
	color: #fff;
	position: absolute;
	top: -5px;
	box-shadow: 0px 1px 0px rgba(0,0,0,0.6);
	background: #5a895c;
	z-index: 200;
}
html[dir="ltr"] .cGallerySubmit_done:before {
	right: -5px;
}
html[dir="rtl"] .cGallerySubmit_done:before {
	left: -5px;
}

.ipsApp button.cGallerySubmit_button {
	font-size: 66px;
	background: transparent;
	color: #555;
	opacity: 0.4;
	text-align: center;
	position: absolute;
	top: 50%;
	margin-top: -20px;
	border: 0;
	height: 150px; /* Make the clickable area bigger for ease */
	width: 60px;
	outline: 0;
}
	
	html[dir="ltr"] .ipsApp button.cGallerySubmit_nextButton,
	html[dir="rtl"] .ipsApp button.cGallerySubmit_prevButton {
		right: 15px;
		text-align: right;
	}
	html[dir="rtl"] .ipsApp button.cGallerySubmit_nextButton,
	html[dir="ltr"] .ipsApp button.cGallerySubmit_prevButton {
		left: 15px;
		text-align: left;
	}

	.ipsApp button.cGallerySubmit_button:hover {
		opacity: 1;
	}]]></css>
 <css css_location="front" css_app="gallery" css_attributes="" css_path="." css_name="widgets.css"><![CDATA[.cGalleryWidget {
	margin-bottom: 5px;
	position: relative;
}

html[dir="ltr"] .ipsWidget .cGalleryWidget .cGalleryWidgetInfo {
	padding-left: 2px;
}

	.ipsWidget.ipsWidget_horizontal .cGalleryWidget .cGalleryWidgetInfo	{
		max-width: 175px;
	}

	.cGalleryWidget > div:first-child {
		margin-bottom: 5px;
		background: #fff;
	}

	.ipsWidget.ipsWidget_vertical .cGalleryWidget .ipsImage {
		max-height: 175px;
	}

	.ipsWidget.ipsWidget_horizontal .cGalleryWidget .ipsImage {
		max-height: 145px;
		margin-bottom: 5px;
	}

	.cGalleryWidget .ipsNoThumb {
		display: block;
	}

	.cGalleryWidget_verticalThumb {
		height: 100px;
	}

.cGalleryWidgetList > li {
	border-bottom: 1px solid #ebebeb;
	padding-bottom: 10px;
	margin-bottom: 10px;
}

	.cGalleryWidgetList > li:last-child {
		padding-bottom: 0;
		margin-bottom: 0;
		border: 0;
	}

.cGalleryWidget_comments {
	position: absolute;
	top: 150px;
	color: #fff;
}
html[dir="ltr"] .cGalleryWidget_comments {
	right: 10px;
}
html[dir="rtl"] .cGalleryWidget_comments {
	left: 10px;
}

	.cGalleryWidget_comments.ipsFaded {
		opacity: 0.7;
	}

	.cGalleryWidgetList .cGalleryWidget_comments {
		top: 75px;
	}]]></css>
</theme>
